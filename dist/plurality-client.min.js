'use strict';function la(){return function(){}}function tb(S){return function(b){this[S]=b}}
define("vendor/underscore",[],function(){(function(){function S(a,b,e,c){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof d&&(a=a.Df);b instanceof d&&(b=b.Df);var f=q.call(a);if(f!=q.call(b))return!1;switch(f){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==
b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var g=e.length;g--;)if(e[g]==a)return c[g]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(d.ie(g)&&g instanceof g&&d.ie(h)&&h instanceof h))return!1;e.push(a);c.push(b);g=0;h=!0;if("[object Array]"==f){if(g=a.length,h=g==b.length)for(;g--&&(h=S(a[g],b[g],e,c)););}else{for(var k in a)if(d.Hd(a,k)&&(g++,!(h=d.Hd(b,k)&&S(a[k],b[k],e,c))))break;if(h){for(k in b)if(d.Hd(b,k)&&!g--)break;h=!g}}e.pop();c.pop();return h}function b(){}
function a(b,e,c){if(e&&d.every(b,d.isArray))return r.apply(c,b);M(b,function(b){d.isArray(b)||d.pn(b)?e?l.apply(c,b):a(b,e,c):c.push(b)});return c}function e(a){return function(b,e,f){var g={},h=null==e?d.Ic:c(e);M(b,function(e,c){var d=h.call(f,e,c,b);a(g,d,e)});return g}}function c(a){return d.ie(a)?a:function(b){return b[a]}}function d(a){if(a instanceof d)return a;if(!(this instanceof d))return new d(a);this.Df=a}var f=this,g=f.xg,h={},k=Array.prototype,n=Object.prototype,l=k.push,p=k.slice,
r=k.concat,q=n.toString,v=n.hasOwnProperty,u=k.forEach,s=k.map,x=k.reduce,z=k.reduceRight,t=k.filter,w=k.every,y=k.some,H=k.indexOf,N=k.lastIndexOf,n=Array.isArray,Q=Object.keys,C=Function.prototype.bind;"undefined"!==typeof exports?("undefined"!==typeof module&&module.ir&&(exports=module.ir=d),exports.xg=d):f.xg=d;d.VERSION="1.5.2";var M=d.er=d.forEach=function(a,b,e){if(null!=a)if(u&&a.forEach===u)a.forEach(b,e);else if(a.length===+a.length)for(var c=0,f=a.length;c<f&&b.call(e,a[c],c,a)!==h;c++);
else for(var g=d.keys(a),c=0,f=g.length;c<f&&b.call(e,a[g[c]],g[c],a)!==h;c++);};d.map=d.Yu=function(a,b,e){var c=[];if(null==a)return c;if(s&&a.map===s)return a.map(b,e);M(a,function(a,d,f){c.push(b.call(e,a,d,f))});return c};d.reduce=d.Pv=d.cw=function(a,b,e,c){var f=2<arguments.length;null==a&&(a=[]);if(x&&a.reduce===x)return c&&(b=d.bind(b,c)),f?a.reduce(b,e):a.reduce(b);M(a,function(a,d,g){f?e=b.call(c,e,a,d,g):(e=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");
return e};d.reduceRight=d.Qv=function(a,b,e,c){var f=2<arguments.length;null==a&&(a=[]);if(z&&a.reduceRight===z)return c&&(b=d.bind(b,c)),f?a.reduceRight(b,e):a.reduceRight(b);var g=a.length;if(g!==+g)var h=d.keys(a),g=h.length;M(a,function(d,k,n){k=h?h[--g]:--g;f?e=b.call(c,e,a[k],k,n):(e=a[k],f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return e};d.find=d.pv=function(a,b,e){var c;I(a,function(a,d,f){if(b.call(e,a,d,f))return c=a,!0});return c};d.filter=d.select=
function(a,b,e){var c=[];if(null==a)return c;if(t&&a.filter===t)return a.filter(b,e);M(a,function(a,d,f){b.call(e,a,d,f)&&c.push(a)});return c};d.Nx=function(a,b,e){return d.filter(a,function(a,c,d){return!b.call(e,a,c,d)},e)};d.every=d.all=function(a,b,e){b||(b=d.Ic);var c=!0;if(null==a)return c;if(w&&a.every===w)return a.every(b,e);M(a,function(a,d,f){if(!(c=c&&b.call(e,a,d,f)))return h});return!!c};var I=d.some=d.Ou=function(a,b,e){b||(b=d.Ic);var c=!1;if(null==a)return c;if(y&&a.some===y)return a.some(b,
e);M(a,function(a,d,f){if(c||(c=b.call(e,a,d,f)))return h});return!!c};d.contains=d.Zv=function(a,b){return null==a?!1:H&&a.indexOf===H?-1!=a.indexOf(b):I(a,function(a){return a===b})};d.ew=function(a,b){var e=p.call(arguments,2),c=d.ie(b);return d.map(a,function(a){return(c?b:a[b]).apply(a,e)})};d.Ik=function(a,b){return d.map(a,function(a){return a[b]})};d.Yt=function(a,b){return d.yk(b)?void 0:d.find(a,function(a){for(var e in b)if(b[e]!==a[e])return!1;return!0})};d.Fv=function(a,b){return d.Yt(a,
b)};d.max=function(a,b,e){if(!b&&d.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&d.yk(a))return-Infinity;var c={Lg:-Infinity,value:-Infinity};M(a,function(a,d,f){d=b?b.call(e,a,d,f):a;d>c.Lg&&(c={value:a,Lg:d})});return c.value};d.min=function(a,b,e){if(!b&&d.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&d.yk(a))return Infinity;var c={Lg:Infinity,value:Infinity};M(a,function(a,d,f){d=b?b.call(e,a,d,f):a;d<c.Lg&&(c={value:a,Lg:d})});return c.value};
d.st=function(a){var b,e=0,c=[];M(a,function(a){b=d.random(e++);c[e-1]=c[b];c[b]=a});return c};d.Tx=function(a,b,e){return 2>arguments.length||e?a[d.random(a.length-1)]:d.st(a).slice(0,Math.max(0,b))};d.ky=function(a,b,e){var f=c(b);return d.Ik(d.map(a,function(a,b,c){return{value:a,index:b,Jm:f.call(e,a,b,c)}}).sort(function(a,b){var e=a.Jm,c=b.Jm;if(e!==c){if(e>c||void 0===e)return 1;if(e<c||void 0===c)return-1}return a.index-b.index}),"value")};d.Tv=e(function(a,b,e){(d.Hd(a,b)?a[b]:a[b]=[]).push(e)});
d.$v=e(function(a,b,e){a[b]=e});d.gv=e(function(a,b){d.Hd(a,b)?a[b]++:a[b]=1});d.xt=function(a,b){var e;e=null==e?d.Ic:c(e);for(var f=e.call(void 0,b),g=0,h=a.length;g<h;){var k=g+h>>>1;e.call(void 0,a[k])<f?g=k+1:h=k}return g};d.re=function(a){return a?d.isArray(a)?p.call(a):a.length===+a.length?d.map(a,d.Ic):d.Tt(a):[]};d.size=function(a){return null==a?0:a.length===+a.length?a.length:d.keys(a).length};d.Gv=d.head=d.xy=function(a,b,e){return null==a?void 0:null==b||e?a[0]:p.call(a,0,b)};d.bw=function(a,
b,e){return p.call(a,0,a.length-(null==b||e?1:b))};d.nw=function(a,b,e){return null==a?void 0:null==b||e?a[a.length-1]:p.call(a,Math.max(a.length-b,0))};d.Rx=d.wy=d.vv=function(a,b,e){return p.call(a,null==b||e?1:b)};d.compact=function(a){return d.filter(a,d.Ic)};d.nr=function(b){return a(b,!0,[])};d.Qy=function(a){return d.br(a,p.call(arguments,1))};d.Jo=d.unique=function(a,b,e,c){d.ie(b)&&(c=e,e=b,b=!1);e=e?d.map(a,e,c):a;var f=[],g=[];M(e,function(e,c){(b?c&&g[g.length-1]===e:d.contains(g,e))||
(g.push(e),f.push(a[c]))});return f};d.hl=function(){return d.Jo(d.nr(arguments))};d.dw=function(a){var b=p.call(arguments,1);return d.filter(d.Jo(a),function(a){return d.every(b,function(b){return 0<=d.indexOf(b,a)})})};d.br=function(a){var b=r.apply(k,p.call(arguments,1));return d.filter(a,function(a){return!d.contains(b,a)})};d.Sy=function(){for(var a=d.max(d.Ik(arguments,"length").concat(0)),b=Array(a),e=0;e<a;e++)b[e]=d.Ik(arguments,""+e);return b};d.object=function(a,b){if(null==a)return{};
for(var e={},c=0,d=a.length;c<d;c++)b?e[a[c]]=b[c]:e[a[c][0]]=a[c][1];return e};d.indexOf=function(a,b,e){if(null==a)return-1;var c=0,f=a.length;if(e)if("number"==typeof e)c=0>e?Math.max(0,f+e):e;else return c=d.xt(a,b),a[c]===b?c:-1;if(H&&a.indexOf===H)return a.indexOf(b,e);for(;c<f;c++)if(a[c]===b)return c;return-1};d.lastIndexOf=function(a,b,e){if(null==a)return-1;var c=null!=e;if(N&&a.lastIndexOf===N)return c?a.lastIndexOf(b,e):a.lastIndexOf(b);for(e=c?e:a.length;e--;)if(a[e]===b)return e;return-1};
d.Lx=function(a,b,e){1>=arguments.length&&(b=a||0,a=0);e=arguments[2]||1;for(var c=Math.max(Math.ceil((b-a)/e),0),d=0,f=Array(c);d<c;)f[d++]=a,a+=e;return f};d.bind=function(a,e){var c,f;if(C&&a.bind===C)return C.apply(a,p.call(arguments,1));if(!d.ie(a))throw new TypeError;c=p.call(arguments,2);return f=function(){if(!(this instanceof f))return a.apply(e,c.concat(p.call(arguments)));b.prototype=a.prototype;var d=new b;b.prototype=null;var g=a.apply(d,c.concat(p.call(arguments)));return Object(g)===
g?g:d}};d.tx=function(a){var b=p.call(arguments,1);return function(){return a.apply(this,b.concat(p.call(arguments)))}};d.Ru=function(a){var b=p.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");M(b,function(b){a[b]=d.bind(a[b],a)});return a};d.ex=function(a,b){var e={};b||(b=d.Ic);return function(){var c=b.apply(this,arguments);return d.Hd(e,c)?e[c]:e[c]=a.apply(this,arguments)}};d.$q=function(a,b){var e=p.call(arguments,2);return setTimeout(function(){return a.apply(null,
e)},b)};d.defer=function(a){return d.$q.apply(d,[a,1].concat(p.call(arguments,1)))};d.Dy=function(a,b,e){function c(){k=!1===e.Vr?0:new Date;h=null;g=a.apply(d,f)}var d,f,g,h=null,k=0;e||(e={});return function(){var n=new Date;k||!1!==e.Vr||(k=n);var l=b-(n-k);d=this;f=arguments;0>=l?(clearTimeout(h),h=null,k=n,g=a.apply(d,f)):h||!1===e.Hy||(h=setTimeout(c,l));return g}};d.lv=function(a,b,e){var c,d,f,g,h;return function(){function k(){var n=new Date-g;n<b?c=setTimeout(k,b-n):(c=null,e||(h=a.apply(f,
d)))}f=this;d=arguments;g=new Date;var n=e&&!c;c||(c=setTimeout(k,b));n&&(h=a.apply(f,d));return h}};d.Ei=function(a){var b=!1,e;return function(){if(b)return e;b=!0;e=a.apply(this,arguments);a=null;return e}};d.zh=function(a,b){return function(){var e=[a];l.apply(e,arguments);return b.apply(this,e)}};d.di=function(){var a=arguments;return function(){for(var b=arguments,e=a.length-1;0<=e;e--)b=[a[e].apply(this,b)];return b[0]}};d.Lu=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};
d.keys=Q||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],e;for(e in a)d.Hd(a,e)&&b.push(e);return b};d.Tt=function(a){for(var b=d.keys(a),e=b.length,c=Array(e),f=0;f<e;f++)c[f]=a[b[f]];return c};d.sx=function(a){for(var b=d.keys(a),e=b.length,c=Array(e),f=0;f<e;f++)c[f]=[b[f],a[b[f]]];return c};d.Qr=function(a){for(var b={},e=d.keys(a),c=0,f=e.length;c<f;c++)b[a[e[c]]]=e[c];return b};d.sr=d.fx=function(a){var b=[],e;for(e in a)d.ie(a[e])&&b.push(e);return b.sort()};d.extend=
function(a){M(p.call(arguments,1),function(b){if(b)for(var e in b)a[e]=b[e]});return a};d.vx=function(a){var b={},e=r.apply(k,p.call(arguments,1));M(e,function(e){e in a&&(b[e]=a[e])});return b};d.rx=function(a){var b={},e=r.apply(k,p.call(arguments,1)),c;for(c in a)d.contains(e,c)||(b[c]=a[c]);return b};d.Pg=function(a){M(p.call(arguments,1),function(b){if(b)for(var e in b)void 0===a[e]&&(a[e]=b[e])});return a};d.b=function(a){return d.Sr(a)?d.isArray(a)?a.slice():d.extend({},a):a};d.zy=function(a,
b){b(a);return a};d.isEqual=function(a,b){return S(a,b,[],[])};d.yk=function(a){if(null==a)return!0;if(d.isArray(a)||d.lw(a))return 0===a.length;for(var b in a)if(d.Hd(a,b))return!1;return!0};d.gw=function(a){return!(!a||1!==a.nodeType)};d.isArray=n||function(a){return"[object Array]"==q.call(a)};d.Sr=function(a){return a===Object(a)};M("Arguments Function String Number Date RegExp".split(" "),function(a){d["is"+a]=function(b){return q.call(b)=="[object "+a+"]"}});d.pn(arguments)||(d.pn=function(a){return!(!a||
!d.Hd(a,"callee"))});"function"!==typeof/./&&(d.ie=function(a){return"function"===typeof a});d.hw=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};d.iw=function(a){return d.kw(a)&&a!=+a};d.fw=function(a){return!0===a||!1===a||"[object Boolean]"==q.call(a)};d.jw=function(a){return null===a};d.mw=function(a){return void 0===a};d.Hd=function(a,b){return v.call(a,b)};d.vs=function(){f.xg=g;return this};d.Ic=function(a){return a};d.Ey=function(a,b,e){for(var c=Array(Math.max(0,a)),d=0;d<a;d++)c[d]=
b.call(e,d);return c};d.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};D.unescape=d.Qr(D.escape);var K={escape:RegExp("["+d.keys(D.escape).join("")+"]","g"),unescape:RegExp("("+d.keys(D.unescape).join("|")+")","g")};d.er(["escape","unescape"],function(a){d[a]=function(b){return null==b?"":(""+b).replace(K[a],function(b){return D[a][b]})}});d.result=function(a,b){if(null!=a){var e=a[b];
return d.ie(e)?e.call(a):e}};d.ns=function(a){M(d.sr(a),function(b){var e=d[b]=a[b];d.prototype[b]=function(){var a=[this.Df];l.apply(a,arguments);a=e.apply(d,a);return this.Ij?d(a).Ig():a}})};var F=0;d.Ky=function(a){var b=++F+"";return a?a+b:b};d.Ft={evaluate:/<%([\s\S]+?)%>/g,wb:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,J={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},E=/\\|'|\r|\n|\t|\u2028|\u2029/g;d.Cy=function(a,b,e){function c(a){return f.call(this,
a,d)}var f;e=d.Pg({},e,d.Ft);var g=0,h="__p+='";a.replace(RegExp([(e.escape||A).source,(e.wb||A).source,(e.evaluate||A).source].join("|")+"|$","g"),function(b,e,c,d,f){h+=a.slice(g,f).replace(E,function(a){return"\\"+J[a]});e&&(h+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'");c&&(h+="'+\n((__t=("+c+"))==null?'':__t)+\n'");d&&(h+="';\n"+d+"\n__p+='");g=f+b.length;return b});h+="';\n";e.Mo||(h="with(obj||{}){\n"+h+"}\n");h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+
h+"return __p;\n";try{f=new Function(e.Mo||"obj","_",h)}catch(k){throw k.source=h,k;}if(b)return f(b,d);c.source="function("+(e.Mo||"obj")+"){\n"+h+"}";return c};d.Ig=function(a){return d(a).Ig()};d.ns(d);M("pop push reverse shift sort splice unshift".split(" "),function(a){var b=k[a];d.prototype[a]=function(){var e=this.Df;b.apply(e,arguments);"shift"!=a&&"splice"!=a||0!==e.length||delete e[0];return this.Ij?d(e).Ig():e}});M(["concat","join","slice"],function(a){var b=k[a];d.prototype[a]=function(){var a=
b.apply(this.Df,arguments);return this.Ij?d(a).Ig():a}});d.extend(d.prototype,{Ig:function(){this.Ij=!0;return this},value:function(){return this.Df}})}).call(this)});
define("util",["./vendor/underscore","exports"],function(S,b){function a(a,b){function e(){}e.prototype=b.prototype;a.Et=b.prototype;a.prototype=new e;a.prototype.constructor=a}function e(b,e,c){function n(a){var b=Array.prototype.slice.call(arguments,0);this.uid=f++;this.constructor.Et.constructor.apply(this,b);e.apply(this,b)}a(n,b);for(var l in c)c.hasOwnProperty(l)&&(n.prototype[l]=c[l]);n.Hf=d++;return n}var c=S.xg,d=0,f=0;b.aw=a;b.gk=e;b.fk=function(a,b){var c=b.Jc||la();delete b.Jc;return e(a,
function(a){c.apply(this,arguments)},b)};b.bf=function(a,b){for(var e=0;e<a.length;e++){var d=a[e];b[d]?this[d]=c.bind(b[d],b):console.log("missing bind",b,d)}};b.Vu=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};b.qn=function(){return!global.zk};b.rn=function(){return global.zk};b.Am=function(a){return function(){return a.apply(this.arguments)&&a.apply(this,arguments)}};b.Un=function(a){return function(){return a.apply(this.arguments)||a.apply(this,arguments)}};b.$n=function(a){return function(){return this.bc.get(a)}};
b.co=function(a){return function(){var b=this.bc[a];return"function"===typeof b?b.call(this.bc):this.bc[a]}}});
define("actor",["./util","exports"],function(S,b){function a(b,d){this.bc=b;d=d||{};this.ko=d.ko||(global.zk?a.xf.Zi:a.xf.Tl);this.eo=d.eo||(global.zk?a.xf.Tl:a.xf.Zi);this.typeName=d.typeName||"unknownType_"+this.constructor.Hf;this.ui=!1;e.call(this,["get","set","sync","getRawState"],this.bc)}var e=S.bf;a.prototype.Jq=function(){this.ui=!0};a.prototype.Iq=function(){this.ui=!1};a.prototype.uo=function(){return this.ko===a.xf.Zi&&this.eo!==a.xf.NONE};a.prototype.Ia=function(a){"stateChange"===a&&
this.uo()&&this.Jq()};a.xf={NONE:1,Zi:2,au:3,Tl:4};a.Gm={};b["default"]=a});
define("behavior_manager",["exports"],function(S){function b(a){this.bc=a;this.Zh=[];this.$b={};this.Sj={}}b.prototype.vr=function(){this.Hm();var a=[],b;for(b in this.$b)if(this.$b.hasOwnProperty(b)){var c=this.$b[b];c.Sg&&a.push(c)}return a};b.prototype.Hm=function(){for(var a in this.$b)if(this.$b.hasOwnProperty(a)){var b=this.$b[a],c=this.Sj[a],c="function"===typeof c?c.call(b):c;b.Sg&&!c?b.disable():!b.Sg&&c&&b.enable()}};b.prototype.Bs=function(a){for(var b=this.vr(),c=0;c<b.length;c++)b[c].receivedMessage.apply(b[c],
a)};b.prototype.lq=function(a){this.Zh=this.Zh.concat(a)};b.prototype.it=function(a,b){this.$b[a.uid]=a;this.Sj[a.uid]="undefined"!==typeof b?b:!0};b.prototype.ht=function(){for(var a=0;a<this.Zh.length;a++){var b=this.Zh[a];this.it(new b[0](this.bc,b[1]),b[2])}this.Hm()};b.prototype.Mf=function(){for(var a in this.$b)this.$b.hasOwnProperty(a)&&this.$b[a].Mf();this.$b={};this.Sj={}};b.prototype.Ia=function(a,b){this.Bs([a].concat(b||[]))};S["default"]=b});
define("vendor/EventEmitter",["exports"],function(S){function b(){}function a(a,b){for(var e=a.length;e--;)if(a[e].Xf===b)return e;return-1}function e(a){return function(){return this[a].apply(this,arguments)}}var c=b.prototype,d=this,f=d.cp;c.en=function(a){var b=this.tm(),e,c;if(a instanceof RegExp)for(c in e={},b)b.hasOwnProperty(c)&&a.test(c)&&(e[c]=b[c]);else e=b[a]||(b[a]=[]);return e};c.Hv=function(a){var b=[],e;for(e=0;e<a.length;e+=1)b.push(a[e].Xf);return b};c.rk=function(a){var b=this.en(a),
e;b instanceof Array&&(e={},e[a]=b);return e||b};c.addListener=function(b,e){var c=this.rk(b),d="object"===typeof e,f;for(f in c)c.hasOwnProperty(f)&&-1===a(c[f],e)&&c[f].push(d?e:{Xf:e,Ei:!1});return this};c.Hb=e("addListener");c.Ju=function(a,b){return this.addListener(a,{Xf:b,Ei:!0})};c.Ei=e("addOnceListener");c.Zq=function(a){this.en(a)};c.ov=function(a){for(var b=0;b<a.length;b+=1)this.Zq(a[b]);return this};c.removeListener=function(b,e){var c=this.rk(b),d,f;for(f in c)c.hasOwnProperty(f)&&(d=
a(c[f],e),-1!==d&&c[f].splice(d,1));return this};c.As=e("removeListener");c.pq=function(a,b){return this.Dn(!1,a,b)};c.Xs=function(a,b){return this.Dn(!0,a,b)};c.Dn=function(a,b,e){var c,d,f=a?this.removeListener:this.addListener;a=a?this.Xs:this.pq;if("object"!==typeof b||b instanceof RegExp)for(c=e.length;c--;)f.call(this,b,e[c]);else for(c in b)b.hasOwnProperty(c)&&(d=b[c])&&("function"===typeof d?f.call(this,c,d):a.call(this,c,d));return this};c.Px=function(a){var b=typeof a,e=this.tm(),c;if("string"===
b)delete e[a];else if(a instanceof RegExp)for(c in e)e.hasOwnProperty(c)&&a.test(c)&&delete e[c];else delete this.sm;return this};c.Ox=e("removeEvent");c.Qm=function(a,b){var e=this.rk(a),c,d,f,r;for(f in e)if(e.hasOwnProperty(f))for(d=e[f].length;d--;)c=e[f][d],!0===c.Ei&&this.removeListener(a,c.Xf),r=c.Xf.apply(this,b||[]),r===this.bq()&&this.removeListener(a,c.Xf);return this};c.Ia=e("emitEvent");c.li=function(a){var b=Array.prototype.slice.call(arguments,1);this.Qm(a,b)};c.Xx=function(a){this.cq=
a;return this};c.bq=function(){return this.hasOwnProperty("_onceReturnValue")?this.cq:!0};c.tm=function(){return this.sm||(this.sm={})};b.vs=function(){d.cp=f;return b};S["default"]=b});
define("event_manager",["./vendor/EventEmitter","exports"],function(S,b){function a(){this.Pf=new e}var e=S["default"];a.prototype.Hb=function(){return this.Pf.addListener.apply(this.Pf,arguments)};a.prototype.As=function(){return this.Pf.removeListener.apply(this.Pf,arguments)};a.prototype.Ia=function(){return this.Pf.Qm.apply(this.Pf,arguments)};b["default"]=a});
define("state_manager",["./util","./vendor/underscore","exports"],function(S,b,a){function e(a){this.bc=a;this.wh={};c.call(this,["trigger"],this.bc)}var c=S.bf,d=b.xg;e.prototype.get=function(a){return this.wh[a]};e.prototype.set=function(a,b){d.isEqual(this.get(a),b)||(this.wh[a]=b,this.Ia("stateChange",[{key:a,value:b}]))};e.prototype.kg=function(a){for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b])};a["default"]=e});
define("entity","./behavior_manager ./event_manager ./state_manager ./actor ./util exports".split(" "),function(S,b,a,e,c,d){function f(){this.$h=new g(this);p.call(this,["addBehavior","addBehaviors"],this.$h);this.ee=new h(this);p.call(this,["on","off"],this.ee);this.el=new k(this);p.call(this,["get","set","sync","getRawState"],this.el);var a=this;this.Hb("didAddToWorld",function(b){a.yh=b;a.$h.ht()})}var g=S["default"],h=b["default"],k=a["default"],n=e["default"],l=c.gk,p=c.bf;f.prototype.Ia=function(){this.ee.Ia.apply(this.ee,
arguments);this.$h.Ia.apply(this.$h,arguments);this.Yb&&this.Yb.Ia.apply(this.Yb,arguments)};f.prototype.remove=function(){this.yh&&this.yh.remove(this)};f.prototype.dk=function(){this.yh&&this.yh.dk.apply(this.yh,arguments)};f.prototype.kn=function(){return"type"+this.constructor.Hf+"_instance"+this.get("id")};f.prototype.Mf=la();f.Mm=function(a){var b=a.Jc||la();delete a.Jc;var e=a.$b||[];delete a.$b;var c=a.lk||{};delete a.lk;var d=a.Yb||{};delete a.Yb;a=l(f,function(a){a=a||{};this.lq(e);a.id=
a.id||this.uid;this.kg(a);this.Yb=new n(this,d);var f=this,g;for(g in c)c.hasOwnProperty(g)&&this.Hb(g,function(){f[c[g]].apply(f,arguments)});this.Ia("willInitialize");b.apply(this,arguments);this.Ia("didInitialize")},a);d&&d.typeName&&(n.Gm[d.typeName]=a);return a};d["default"]=f});
define("world",["./entity","./event_manager","./state_manager","./util","exports"],function(S,b,a,e,c){var d=b["default"],f=a["default"];b=e.fk;var g=e.bf;S=b(S["default"],{Jc:function(a){this.entities={};this.ee=new d(this);g.call(this,["on","off"],this.ee);this.el=new f(this);g.call(this,["get","set","sync"],this.el);this.kg(a)},qi:function(a,b){return"string"===typeof a?this.entities[a+"_"+b]:this.entities["type"+a.Hf+"_instance"+b]},add:function(a){this.entities[a.kn()]=a;a.Ia("didAddToWorld",
[this]);this.Ia("addToWorld",[a])},dk:function(a,b){this.add(new a(b))},remove:function(a){delete this.entities[a.kn()];a.Ia("didRemoveFromWorld");this.Ia("removeFromWorld",[a])},vy:function(a,b){this.qi(a,b.id).kg(b)},Ht:function(a){this.Ia("tick",[a])},Ia:function(a,b){this.ee.Ia.apply(this.ee,arguments);this.qr(a,b&&b[0],b&&b[1])},qr:function(a,b,e){if(!(-1<["addToWorld","removeFromWorld"].indexOf(a))){this.ee.Ia("worldEvent",[{hr:a,Rr:e||!1,data:b}]);for(var c in this.entities)this.entities.hasOwnProperty(c)&&
this.entities[c].Ia(a,[b])}},wx:function(a,b){var e=this;a.Hb(b,function(){e.Ia(b,arguments)})}});c["default"]=S});
define("world_renderer",["./util","exports"],function(S,b){var a=S.fk,a=a(la(),{Jc:function(a){this.la=a;this.Rk=[];this.eg={};this.Ob={};var b=this;this.la.Hb("addToWorld",function(a){var e=a.constructor.Hf;if(b.eg[e])for(var g=0;g<b.eg[e].length;g++){var h=b.eg[e][g],h=new h[0](a,h[1]);b.Ob[e]=b.Ob[e]||{};var k=a.get("id");b.Ob[e][k]=b.Ob[e][k]||{};b.Ob[e][k][h.uid]=h}});this.la.Hb("removeFromWorld",function(a){var e=a.constructor.Hf;if(b.Ob[e]&&(a=a.get("id"),b.Ob[e][a])){for(var g in b.Ob[e][a])b.Ob[e][a].hasOwnProperty(g)&&
b.Ob[e][a][g].Mf();delete b.Ob[e][a]}})},Tn:function(a){this.Rk.push(new a(this.la))},Cs:function(a,b,d){a=a.Hf;this.eg[a]=this.eg[a]||[];this.eg[a].push([b,d])},Im:function(){for(var a=[],b=0;b<this.Rk.length;b++)a.push(this.Rk[b]);for(var d in this.Ob)if(this.Ob.hasOwnProperty(d)){var b=this.Ob[d],f;for(f in b)if(b.hasOwnProperty(f)){var g=b[f],h;for(h in g)g.hasOwnProperty(h)&&a.push(g[h])}}return a},w:function(a){for(var b=this.Im(),d=0;d<b.length;d++)b[d].w(a)},Uk:function(){for(var a=this.Im(),
b=0;b<a.length;b++)a[b].Uk()}});b["default"]=a});
define("network/network_client",["exports"],function(S){function b(a,b,c){this.la=a;this.yo=b;this.Pt=c;var d=this;this.yo.Hb("actor:operations",function(a){d.Es(a)})}b.prototype.Es=function(a){for(var b=0;b<a.length;b++)this.Ds(a[b])};b.prototype.Ds=function(a){if("event"===a.Fi)console.log("Received Network Event",a.type,a.ne),this.la.Ia(a.type,[a.ne]);else{var b=this.Pt[a.type];b?"create"===a.Fi?(console.log("Creating entity",a.type,a.ne),b=new b(a.ne),this.la.add(b)):"update"===a.Fi?(b=this.la.qi(b,
a.ne.id))?b.kg(a.ne):console.log("Unmatched entity to update",a):"remove"===a.Fi&&((b=this.la.qi(b,a.ne.id))?this.la.remove(b):console.log("Unmatched entity to remove",a)):console.log("Unhandled network operation",a)}};S["default"]=b});
define("network/network_server",["exports"],function(S){function b(a){this.la=a;this.If={};this.Ii=[];var b=this;this.la.Hb("addToWorld",function(a){b.Xh("create",a.Yb.typeName,a.wh)});this.la.Hb("removeFromWorld",function(a){b.Xh("remove",a.Yb.typeName,{id:a.get("id")})});this.la.Hb("worldEvent",function(a){a.Rr&&b.Xh("event",a.hr,a.data)})}b.prototype.nq=function(a){this.If[a.id]=a};b.prototype.Vs=function(a){delete this.If[a.id]};b.prototype.ao=function(a){var b=[],c;for(c in this.la.entities)if(this.la.entities.hasOwnProperty(c)){var d=
this.la.entities[c];d.Yb.uo()&&b.push(this.An("create",d.Yb.typeName,d.wh))}0<b.length&&this.If[a].li("actor:operations",b)};b.prototype.kg=function(){for(var a in this.la.entities)if(this.la.entities.hasOwnProperty(a)){var b=this.la.entities[a];b.Yb.ui&&this.Xh("update",b.Yb.typeName,b.wh)}if(0<this.Ii.length)for(a in this.Mq(this.Ii),this.Ii.length=0,this.la.entities)this.la.entities.hasOwnProperty(a)&&(b=this.la.entities[a],b.Yb.ui&&b.Yb.Iq())};b.prototype.Mq=function(a){for(var b in this.If)this.If.hasOwnProperty(b)&&
this.If[b].li("actor:operations",a)};b.prototype.An=function(a,b,c){return{Fi:a,type:b,ne:c}};b.prototype.Xh=function(a,b,c){this.Ii.push(this.An.apply(this,arguments))};S["default"]=b});
define("vendor/three",["exports"],function(S){var b={Ll:"65"};self.console=self.console||{info:la(),log:la(),debug:la(),warn:la(),error:la()};b.extend=function(a,b){if(Object.keys)for(var c=Object.keys(b),d=0,f=c.length;d<f;d++){var g=c[d];Object.defineProperty(a,g,Object.getOwnPropertyDescriptor(b,g))}else for(g in c={}.hasOwnProperty,b)c.call(b,g)&&(a[g]=b[g]);return a};(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!self.requestAnimationFrame;++c)self.requestAnimationFrame=
self[b[c]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b[c]+"CancelAnimationFrame"]||self[b[c]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var e=Date.now(),c=Math.max(0,16-(e-a)),h=self.setTimeout(function(){b(e+c)},c);a=e+c;return h});void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})})();b.ku=0;b.iu=1;b.dj=2;b.ju=3;b.pu=0;
b.ou=1;b.cu=0;b.Hl=1;b.Il=2;b.fj=0;b.nf=1;b.we=2;b.tu=0;b.og=1;b.Vc=2;b.sg=0;b.pf=1;b.De=2;b.El=0;b.Ih=1;b.ll=2;b.Yl=3;b.mp=4;b.sl=5;b.kl=100;b.Dp=101;b.wp=102;b.Np=200;b.pp=201;b.Cp=202;b.sp=203;b.Xl=204;b.Gl=205;b.$o=206;b.qp=207;b.ap=208;b.rp=209;b.Bp=210;b.Hh=0;b.su=1;b.bu=2;b.am=la();b.gu=la();b.Xo=la();b.zp=la();b.Cu=la();b.vd=1E3;b.lg=1001;b.rj=1002;b.wf=1003;b.Dl=1004;b.Cl=1005;b.ye=1006;b.hp=1007;b.oj=1008;b.zj=1009;b.To=1010;b.yp=1011;b.Lp=1012;b.ep=1013;b.Hp=1014;b.ej=1015;b.Ip=1016;b.Jp=
1017;b.Kp=1018;b.Qo=1019;b.tj=1020;b.Td=1021;b.kp=1022;b.jp=1023;b.Ol=2001;b.up=2002;b.Ml=2003;b.Nl=2004;b.p=function(a){void 0!==a&&this.set(a);return this};b.p.prototype={constructor:b.p,s:1,r:1,g:1,set:function(a){a instanceof b.p?this.copy(a):"number"===typeof a?this.ob(a):"string"===typeof a&&this.gt(a);return this},ob:function(a){a=Math.floor(a);this.s=(a>>16&255)/255;this.r=(a>>8&255)/255;this.g=(a&255)/255;return this},kd:function(a,b,c){this.s=a;this.r=b;this.g=c;return this},gt:function(a){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a))return a=
/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.s=Math.min(255,parseInt(a[1],10))/255,this.r=Math.min(255,parseInt(a[2],10))/255,this.g=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.s=Math.min(100,parseInt(a[1],10))/100,this.r=Math.min(100,parseInt(a[2],10))/100,this.g=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.ob(parseInt(a[1],
16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.ob(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.ob(b.Vo[a]),this},copy:function(a){this.s=a.s;this.r=a.r;this.g=a.g;return this},Kf:function(a){this.s=a.s*a.s;this.r=a.r*a.r;this.g=a.g*a.g;return this},cn:function(){return 255*this.s<<16^255*this.r<<8^255*this.g<<0},Gd:function(){return"rgb("+(255*this.s|0)+","+(255*this.r|0)+","+(255*this.g|
0)+")"},add:function(a){this.s+=a.s;this.r+=a.r;this.g+=a.g;return this},Kj:function(a,b){this.s=a.s+b.s;this.r=a.r+b.r;this.g=a.g+b.g;return this},Gc:function(a){this.s+=a;this.r+=a;this.g+=a;return this},multiply:function(a){this.s*=a.s;this.r*=a.r;this.g*=a.g;return this},q:function(a){this.s*=a;this.r*=a;this.g*=a;return this},je:function(a,b){this.s+=(a.s-this.s)*b;this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;return this},oa:function(a){return a.s===this.s&&a.r===this.r&&a.g===this.g},aa:function(a){this.s=
a[0];this.r=a[1];this.g=a[2];return this},re:function(){return[this.s,this.r,this.g]},b:function(){return(new b.p).kd(this.s,this.r,this.g)}};b.Vo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,
darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,
fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,
lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,
navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,
slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};b.rc=function(a,b,c,d){this.m=a||0;this.n=b||0;this.o=c||0;this.L=void 0!==d?d:1};b.rc.prototype={constructor:b.rc,m:0,n:0,o:0,L:0,Cg:void 0,Xb:function(){void 0!==this.Cg&&this.Cg.et(this,void 0,!1)},get x(){return this.m},
set x(a){this.m=a;this.Xb()},get y(){return this.n},set y(a){this.n=a;this.Xb()},get z(){return this.o},set z(a){this.o=a;this.Xb()},get f(){return this.L},set f(a){this.L=a;this.Xb()},set:function(a,b,c,d){this.m=a;this.n=b;this.o=c;this.L=d;this.Xb();return this},copy:function(a){this.m=a.m;this.n=a.n;this.o=a.o;this.L=a.L;this.Xb();return this},po:function(a,e){if(!1===a instanceof b.nc)throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");
var c=Math.cos(a.m/2),d=Math.cos(a.n/2),f=Math.cos(a.o/2),g=Math.sin(a.m/2),h=Math.sin(a.n/2),k=Math.sin(a.o/2);"XYZ"===a.$e?(this.m=g*d*f+c*h*k,this.n=c*h*f-g*d*k,this.o=c*d*k+g*h*f,this.L=c*d*f-g*h*k):"YXZ"===a.$e?(this.m=g*d*f+c*h*k,this.n=c*h*f-g*d*k,this.o=c*d*k-g*h*f,this.L=c*d*f+g*h*k):"ZXY"===a.$e?(this.m=g*d*f-c*h*k,this.n=c*h*f+g*d*k,this.o=c*d*k+g*h*f,this.L=c*d*f-g*h*k):"ZYX"===a.$e?(this.m=g*d*f-c*h*k,this.n=c*h*f+g*d*k,this.o=c*d*k-g*h*f,this.L=c*d*f+g*h*k):"YZX"===a.$e?(this.m=g*d*
f+c*h*k,this.n=c*h*f+g*d*k,this.o=c*d*k-g*h*f,this.L=c*d*f-g*h*k):"XZY"===a.$e&&(this.m=g*d*f-c*h*k,this.n=c*h*f-g*d*k,this.o=c*d*k+g*h*f,this.L=c*d*f+g*h*k);!1!==e&&this.Xb();return this},oo:function(a,b){var c=b/2,d=Math.sin(c);this.m=a.x*d;this.n=a.y*d;this.o=a.z*d;this.L=Math.cos(c);this.Xb();return this},Li:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],f=b[1],g=b[5],h=b[9],k=b[2],n=b[6],b=b[10],l=c+g+b;0<l?(c=0.5/Math.sqrt(l+1),this.L=0.25/c,this.m=(n-h)*c,this.n=(d-k)*c,this.o=(f-a)*
c):c>g&&c>b?(c=2*Math.sqrt(1+c-g-b),this.L=(n-h)/c,this.m=0.25*c,this.n=(a+f)/c,this.o=(d+k)/c):g>b?(c=2*Math.sqrt(1+g-c-b),this.L=(d-k)/c,this.m=(a+f)/c,this.n=0.25*c,this.o=(h+n)/c):(c=2*Math.sqrt(1+b-c-g),this.L=(f-a)/c,this.m=(d+k)/c,this.n=(h+n)/c,this.o=0.25*c);this.Xb();return this},vi:function(){return this.m*this.m+this.n*this.n+this.o*this.o+this.L*this.L},length:function(){return Math.sqrt(this.m*this.m+this.n*this.n+this.o*this.o+this.L*this.L)},normalize:function(){var a=this.length();
0===a?(this.o=this.n=this.m=0,this.L=1):(a=1/a,this.m*=a,this.n*=a,this.o*=a,this.L*=a);return this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.Mn(a,b)):this.Mn(this,a)},Mn:function(a,b){var c=a.m,d=a.n,f=a.o,g=a.L,h=b.m,k=b.n,n=b.o,l=b.L;this.m=c*l+g*h+d*n-f*k;this.n=d*l+g*k+f*h-c*n;this.o=f*l+g*n+c*k-d*h;this.L=g*l-c*h-d*k-f*n;this.Xb();return this},cl:function(a,b){var c=
this.m,d=this.n,f=this.o,g=this.L,h=g*a.L+c*a.m+d*a.n+f*a.o;0>h?(this.L=-a.L,this.m=-a.m,this.n=-a.n,this.o=-a.o,h=-h):this.copy(a);if(1<=h)return this.L=g,this.m=c,this.n=d,this.o=f,this;var k=Math.acos(h),n=Math.sqrt(1-h*h);if(0.0010>Math.abs(n))return this.L=0.5*(g+this.L),this.m=0.5*(c+this.m),this.n=0.5*(d+this.n),this.o=0.5*(f+this.o),this;h=Math.sin((1-b)*k)/n;k=Math.sin(b*k)/n;this.L=g*h+this.L*k;this.m=c*h+this.m*k;this.n=d*h+this.n*k;this.o=f*h+this.o*k;this.Xb();return this},oa:function(a){return a.m===
this.m&&a.n===this.n&&a.o===this.o&&a.L===this.L},aa:function(a){this.m=a[0];this.n=a[1];this.o=a[2];this.L=a[3];this.Xb();return this},re:function(){return[this.m,this.n,this.o,this.L]},b:function(){return new b.rc(this.m,this.n,this.o,this.L)}};b.rc.cl=function(a,b,c,d){return c.copy(a).cl(b,d)};b.h=function(a,b){this.x=a||0;this.y=b||0};b.h.prototype={constructor:b.h,set:function(a,b){this.x=a;this.y=b;return this},Ni:function(a){this.y=a;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},
add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.Hc(a,b);this.x+=a.x;this.y+=a.y;return this},Hc:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},Gc:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.ea(a,b);this.x-=a.x;this.y-=a.y;return this},
ea:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},q:function(a){this.x*=a;this.y*=a;return this},de:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},be:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},We:function(){return this.q(-1)},za:function(a){return this.x*
a.x+this.y*a.y},vi:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.de(this.length())},Ed:function(a){return Math.sqrt(this.ce(a))},ce:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},Mi:function(a){var b=this.length();0!==b&&a!==b&&this.q(a/b);return this},je:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},oa:function(a){return a.x===this.x&&a.y===this.y},aa:function(a){this.x=
a[0];this.y=a[1];return this},re:function(){return[this.x,this.y]},b:function(){return new b.h(this.x,this.y)}};b.a=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};b.a.prototype={constructor:b.a,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},Ni:function(a){this.y=a;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.Hc(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},Gc:function(a){this.x+=a;this.y+=a;this.z+=a;return this},Hc:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.ea(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},ea:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==
b)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.ss(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},q:function(a){this.x*=a;this.y*=a;this.z*=a;return this},ss:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},xc:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},O:function(a){var b=this.x,
c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},Ke:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var f=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*f;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*f;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*f;return this},Oj:function(a){var b=this.x,c=this.y,d=this.z,f=a.x,g=a.y,h=a.z;a=a.f;var k=a*b+g*d-h*c,n=a*c+h*b-f*d,l=a*d+f*c-g*b,b=-f*b-g*c-h*
d;this.x=k*a+b*-f+n*-h-l*-g;this.y=n*a+b*-g+l*-f-k*-h;this.z=l*a+b*-h+k*-g-n*-f;return this},Kt:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;this.normalize();return this},de:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=
a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},be:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},We:function(){return this.q(-1)},za:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},vi:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},vn:function(){return Math.abs(this.x)+
Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.de(this.length())},Mi:function(a){var b=this.length();0!==b&&a!==b&&this.q(a/b);return this},je:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},Qe:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.Cb(a,b);var c=this.x,d=this.y,f=this.z;this.x=d*a.z-f*a.y;this.y=f*a.x-c*a.z;this.z=c*
a.y-d*a.x;return this},Cb:function(a,b){var c=a.x,d=a.y,f=a.z,g=b.x,h=b.y,k=b.z;this.x=d*k-f*h;this.y=f*g-c*k;this.z=c*h-d*g;return this},Ed:function(a){return Math.sqrt(this.ce(a))},ce:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},Ua:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},oa:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},aa:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},re:function(){return[this.x,
this.y,this.z]},b:function(){return new b.a(this.x,this.y,this.z)}};b.extend(b.a.prototype,{Dm:function(){var a=new b.rc;return function(e){!1===e instanceof b.nc&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");this.Oj(a.po(e));return this}}(),Pu:function(){var a=new b.rc;return function(b,c){this.Oj(a.oo(b,c));return this}}(),Zn:function(){var a=new b.a;return function(b){a.copy(b).normalize();b=this.za(a);return this.copy(a).q(b)}}(),
Dx:function(){var a=new b.a;return function(b){a.copy(this).Zn(b);return this.sub(a)}}(),Mx:function(){var a=new b.a;return function(b){a.copy(this).Zn(b).q(2);return this.ea(a,this)}}()});b.vc=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.f=void 0!==d?d:1};b.vc.prototype={constructor:b.vc,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.f=d;return this},Ni:function(a){this.y=a;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.f=void 0!==a.f?a.f:1;return this},
add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.Hc(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.f+=a.f;return this},Gc:function(a){this.x+=a;this.y+=a;this.z+=a;this.f+=a;return this},Hc:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.f=a.f+b.f;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.ea(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.f-=a.f;return this},ea:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.f=a.f-b.f;return this},q:function(a){this.x*=a;this.y*=a;this.z*=a;this.f*=a;return this},O:function(a){var b=this.x,c=this.y,d=this.z,f=this.f;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*f;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*f;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*f;this.f=a[3]*b+a[7]*c+a[11]*d+a[15]*f;return this},de:function(a){0!==a?(a=1/a,this.x*=a,this.y*=
a,this.z*=a,this.f*=a):(this.z=this.y=this.x=0,this.f=1);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.f>a.f&&(this.f=a.f);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);this.f<a.f&&(this.f=a.f);return this},be:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.f<a.f?this.f=
a.f:this.f>b.f&&(this.f=b.f);return this},We:function(){return this.q(-1)},za:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.f*a.f},vi:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f)},vn:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.f)},normalize:function(){return this.de(this.length())},Mi:function(a){var b=this.length();0!==b&&a!==
b&&this.q(a/b);return this},je:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.f+=(a.f-this.f)*b;return this},oa:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.f===this.f},aa:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.f=a[3];return this},re:function(){return[this.x,this.y,this.z,this.f]},b:function(){return new b.vc(this.x,this.y,this.z,this.f)}};b.nc=function(a,e,c,d){this.m=a||0;this.n=e||0;this.o=c||0;this.sb=d||b.nc.tl};b.nc.Au=
"XYZ YZX ZXY XZY YXZ ZYX".split(" ");b.nc.tl="XYZ";b.nc.prototype={constructor:b.nc,m:0,n:0,o:0,sb:b.nc.tl,Nb:void 0,Yc:function(){void 0!==this.Nb&&this.Nb.po(this,!1)},get x(){return this.m},set x(a){this.m=a;this.Yc()},get y(){return this.n},set y(a){this.n=a;this.Yc()},get z(){return this.o},set z(a){this.o=a;this.Yc()},get $e(){return this.sb},set $e(a){this.sb=a;this.Yc()},set:function(a,b,c,d){this.m=a;this.n=b;this.o=c;this.sb=d||this.sb;this.Yc();return this},copy:function(a){this.m=a.m;
this.n=a.n;this.o=a.o;this.sb=a.sb;this.Yc();return this},Li:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,f=d[0],g=d[4],h=d[8],k=d[1],n=d[5],l=d[9],p=d[2],r=d[6],d=d[10];b=b||this.sb;"XYZ"===b?(this.n=Math.asin(c(h)),0.99999>Math.abs(h)?(this.m=Math.atan2(-l,d),this.o=Math.atan2(-g,f)):(this.m=Math.atan2(r,n),this.o=0)):"YXZ"===b?(this.m=Math.asin(-c(l)),0.99999>Math.abs(l)?(this.n=Math.atan2(h,d),this.o=Math.atan2(k,n)):(this.n=Math.atan2(-p,f),this.o=0)):"ZXY"===
b?(this.m=Math.asin(c(r)),0.99999>Math.abs(r)?(this.n=Math.atan2(-p,d),this.o=Math.atan2(-g,n)):(this.n=0,this.o=Math.atan2(k,f))):"ZYX"===b?(this.n=Math.asin(-c(p)),0.99999>Math.abs(p)?(this.m=Math.atan2(r,d),this.o=Math.atan2(k,f)):(this.m=0,this.o=Math.atan2(-g,n))):"YZX"===b?(this.o=Math.asin(c(k)),0.99999>Math.abs(k)?(this.m=Math.atan2(-l,n),this.n=Math.atan2(-p,f)):(this.m=0,this.n=Math.atan2(h,d))):"XZY"===b?(this.o=Math.asin(-c(g)),0.99999>Math.abs(g)?(this.m=Math.atan2(r,n),this.n=Math.atan2(h,
f)):(this.m=Math.atan2(-l,d),this.n=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+b);this.sb=b;this.Yc();return this},et:function(a,b,c){function d(a){return Math.min(Math.max(a,-1),1)}var f=a.x*a.x,g=a.y*a.y,h=a.z*a.z,k=a.f*a.f;b=b||this.sb;"XYZ"===b?(this.m=Math.atan2(2*(a.x*a.f-a.y*a.z),k-f-g+h),this.n=Math.asin(d(2*(a.x*a.z+a.y*a.f))),this.o=Math.atan2(2*(a.z*a.f-a.x*a.y),k+f-g-h)):"YXZ"===b?(this.m=Math.asin(d(2*(a.x*a.f-a.y*a.z))),this.n=Math.atan2(2*(a.x*
a.z+a.y*a.f),k-f-g+h),this.o=Math.atan2(2*(a.x*a.y+a.z*a.f),k-f+g-h)):"ZXY"===b?(this.m=Math.asin(d(2*(a.x*a.f+a.y*a.z))),this.n=Math.atan2(2*(a.y*a.f-a.z*a.x),k-f-g+h),this.o=Math.atan2(2*(a.z*a.f-a.x*a.y),k-f+g-h)):"ZYX"===b?(this.m=Math.atan2(2*(a.x*a.f+a.z*a.y),k-f-g+h),this.n=Math.asin(d(2*(a.y*a.f-a.x*a.z))),this.o=Math.atan2(2*(a.x*a.y+a.z*a.f),k+f-g-h)):"YZX"===b?(this.m=Math.atan2(2*(a.x*a.f-a.z*a.y),k-f+g-h),this.n=Math.atan2(2*(a.y*a.f-a.x*a.z),k+f-g-h),this.o=Math.asin(d(2*(a.x*a.y+a.z*
a.f)))):"XZY"===b?(this.m=Math.atan2(2*(a.x*a.f+a.y*a.z),k-f+g-h),this.n=Math.atan2(2*(a.x*a.z+a.y*a.f),k+f-g-h),this.o=Math.asin(d(2*(a.z*a.f-a.x*a.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+b);this.sb=b;!1!==c&&this.Yc();return this},aa:function(a){this.m=a[0];this.n=a[1];this.o=a[2];void 0!==a[3]&&(this.sb=a[3]);this.Yc();return this},re:function(){return[this.m,this.n,this.o,this.sb]},oa:function(a){return a.m===this.m&&a.n===this.n&&a.o===this.o&&a.sb===
this.sb},b:function(){return new b.nc(this.m,this.n,this.o,this.sb)}};b.mj=function(a,e){this.start=void 0!==a?a:new b.a;this.end=void 0!==e?e:new b.a};b.mj.prototype={constructor:b.mj,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},ua:function(a){return(a||new b.a).Hc(this.start,this.end).q(0.5)},ar:function(a){return(a||new b.a).ea(this.end,this.start)},cb:function(){return this.start.Ed(this.end)},Em:function(a,
e){return this.ar(e||new b.a).q(a).add(this.start)},O:function(a){this.start.O(a);this.end.O(a);return this},oa:function(a){return a.start.oa(this.start)&&a.end.oa(this.end)},b:function(){return(new b.mj).copy(this)}};b.of=function(a,e){this.min=void 0!==a?a:new b.h(Infinity,Infinity);this.max=void 0!==e?e:new b.h(-Infinity,-Infinity)};b.of.prototype={constructor:b.of,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},Ld:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);
for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.Id();return this},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},Id:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},ua:function(a){return(a||new b.h).Hc(this.min,this.max).q(0.5)},size:function(a){return(a||
new b.h).ea(this.max,this.min)},Rm:function(a){this.min.min(a);this.max.max(a);return this},Qf:function(a){this.min.Gc(-a);this.max.Gc(a);return this},Jf:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},getParameter:function(a,e){return(e||new b.h).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},Wf:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},Of:function(){var a=
new b.h;return function(b){return a.copy(b).be(this.min,this.max).sub(b).length()}}(),nn:function(a){this.min.max(a.min);this.max.min(a.max);return this},hl:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},oa:function(a){return a.min.oa(this.min)&&a.max.oa(this.max)},b:function(){return(new b.of).copy(this)}};b.lc=function(a,e){this.min=void 0!==a?a:new b.a(Infinity,Infinity,Infinity);this.max=void 0!==e?e:new b.a(-Infinity,
-Infinity,-Infinity)};b.lc.prototype={constructor:b.lc,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},xm:function(a){a.x<this.min.x?this.min.x=a.x:a.x>this.max.x&&(this.max.x=a.x);a.y<this.min.y?this.min.y=a.y:a.y>this.max.y&&(this.max.y=a.y);a.z<this.min.z?this.min.z=a.z:a.z>this.max.z&&(this.max.z=a.z)},Ld:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var b=1,c=a.length;b<c;b++)this.xm(a[b])}else this.Id();return this},dt:function(){var a=new b.a;
return function(b){var c=this;b.Fa(!0);this.Id();b.Ui(function(b){if(void 0!==b.j&&void 0!==b.j.e)for(var e=b.j.e,g=0,h=e.length;g<h;g++)a.copy(e[g]),a.O(b.l),c.Rm(a)});return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},Id:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},ua:function(a){return(a||new b.a).Hc(this.min,
this.max).q(0.5)},size:function(a){return(a||new b.a).ea(this.max,this.min)},Rm:function(a){this.min.min(a);this.max.max(a);return this},Qf:function(a){this.min.Gc(-a);this.max.Gc(a);return this},Jf:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},getParameter:function(a,e){return(e||new b.a).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},Wf:function(a){return a.max.x<
this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},Of:function(){var a=new b.a;return function(b){return a.copy(b).be(this.min,this.max).sub(b).length()}}(),nn:function(a){this.min.max(a.min);this.max.min(a.max);return this},hl:function(a){this.min.min(a.min);this.max.max(a.max);return this},O:function(){var a=[new b.a,new b.a,new b.a,new b.a,new b.a,new b.a,new b.a,new b.a];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).O(b);
a[1].set(this.min.x,this.min.y,this.max.z).O(b);a[2].set(this.min.x,this.max.y,this.min.z).O(b);a[3].set(this.min.x,this.max.y,this.max.z).O(b);a[4].set(this.max.x,this.min.y,this.min.z).O(b);a[5].set(this.max.x,this.min.y,this.max.z).O(b);a[6].set(this.max.x,this.max.y,this.min.z).O(b);a[7].set(this.max.x,this.max.y,this.max.z).O(b);this.Id();this.Ld(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},oa:function(a){return a.min.oa(this.min)&&a.max.oa(this.max)},
b:function(){return(new b.lc).copy(this)}};b.pc=function(a,b,c,d,f,g,h,k,n){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,d||0,void 0!==f?f:1,g||0,h||0,k||0,void 0!==n?n:1)};b.pc.prototype={constructor:b.pc,set:function(a,b,c,d,f,g,h,k,n){var l=this.elements;l[0]=a;l[3]=b;l[6]=c;l[1]=d;l[4]=f;l[7]=g;l[2]=h;l[5]=k;l[8]=n;return this},Ic:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},
Fk:function(){var a=new b.a;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.xc(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),q:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},Om:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],f=a[3],g=a[4],h=a[5],k=a[6],n=a[7],a=a[8];return b*g*a-b*h*n-c*f*a+c*h*k+d*f*n-d*g*k},Fd:function(a,b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];
d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.Ic();return this}this.q(1/c);return this},Go:function(){var a,b=this.elements;a=b[1];b[1]=b[3];
b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},dd:function(a){this.Fd(a).Go();return this},aa:function(a){this.elements.set(a);return this},re:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]},b:function(){var a=this.elements;return new b.pc(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};b.$=function(a,b,c,d,f,g,h,k,n,l,p,r,q,v,u,s){var x=this.elements=new Float32Array(16);x[0]=void 0!==a?a:1;x[4]=b||0;x[8]=c||0;x[12]=d||0;x[1]=f||0;x[5]=void 0!==
g?g:1;x[9]=h||0;x[13]=k||0;x[2]=n||0;x[6]=l||0;x[10]=void 0!==p?p:1;x[14]=r||0;x[3]=q||0;x[7]=v||0;x[11]=u||0;x[15]=void 0!==s?s:1};b.$.prototype={constructor:b.$,set:function(a,b,c,d,f,g,h,k,n,l,p,r,q,v,u,s){var x=this.elements;x[0]=a;x[4]=b;x[8]=c;x[12]=d;x[1]=f;x[5]=g;x[9]=h;x[13]=k;x[2]=n;x[6]=l;x[10]=p;x[14]=r;x[3]=q;x[7]=v;x[11]=u;x[15]=s;return this},Ic:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},es:function(a){var b=
this.elements,c=a.x,d=a.y,f=a.z,g=a.f,h=c+c,k=d+d,n=f+f;a=c*h;var l=c*k,c=c*n,p=d*k,d=d*n,f=f*n,h=g*h,k=g*k,g=g*n;b[0]=1-(p+f);b[4]=l-g;b[8]=c+k;b[1]=l+g;b[5]=1-(a+f);b[9]=d-h;b[2]=c-k;b[6]=d+h;b[10]=1-(a+p);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},Fb:function(){var a=new b.a,e=new b.a,c=new b.a;return function(b,f,g){var h=this.elements;c.ea(b,f).normalize();0===c.length()&&(c.z=1);a.Cb(g,c).normalize();0===a.length()&&(c.x+=1E-4,a.Cb(g,c).normalize());e.Cb(c,a);h[0]=a.x;
h[4]=e.x;h[8]=c.x;h[1]=a.y;h[5]=e.y;h[9]=c.y;h[2]=a.z;h[6]=e.z;h[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.La(a,b)):this.La(this,a)},La:function(a,b){var c=a.elements,d=b.elements,f=this.elements,g=c[0],h=c[4],k=c[8],n=c[12],l=c[1],p=c[5],r=c[9],q=c[13],v=c[2],u=c[6],s=c[10],x=c[14],z=c[3],t=c[7],w=c[11],c=c[15],y=d[0],H=d[4],N=d[8],Q=d[12],C=d[1],M=
d[5],I=d[9],D=d[13],K=d[2],F=d[6],A=d[10],J=d[14],E=d[3],W=d[7],G=d[11],d=d[15];f[0]=g*y+h*C+k*K+n*E;f[4]=g*H+h*M+k*F+n*W;f[8]=g*N+h*I+k*A+n*G;f[12]=g*Q+h*D+k*J+n*d;f[1]=l*y+p*C+r*K+q*E;f[5]=l*H+p*M+r*F+q*W;f[9]=l*N+p*I+r*A+q*G;f[13]=l*Q+p*D+r*J+q*d;f[2]=v*y+u*C+s*K+x*E;f[6]=v*H+u*M+s*F+x*W;f[10]=v*N+u*I+s*A+x*G;f[14]=v*Q+u*D+s*J+x*d;f[3]=z*y+t*C+w*K+c*E;f[7]=z*H+t*M+w*F+c*W;f[11]=z*N+t*I+w*A+c*G;f[15]=z*Q+t*D+w*J+c*d;return this},q:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;
b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},Fk:function(){var a=new b.a;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.Ke(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),Om:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],f=a[12],g=a[1],h=a[5],k=a[9],n=a[13],l=a[2],p=a[6],r=a[10],q=a[14];return a[3]*(+f*k*p-d*n*p-f*h*r+c*n*r+d*h*q-c*k*q)+a[7]*(+b*k*q-b*n*r+f*g*r-d*g*q+d*n*l-f*k*l)+a[11]*
(+b*n*p-b*h*q-f*g*p+c*g*q+f*h*l-c*n*l)+a[15]*(-d*h*l-b*k*p+b*h*r+d*g*p-c*g*r+c*k*l)},Go:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},or:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},
Wm:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},ft:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},Fd:function(a,b){var c=this.elements,d=a.elements,f=d[0],g=d[4],h=d[8],k=d[12],n=d[1],l=d[5],p=d[9],r=d[13],q=d[2],v=d[6],u=d[10],s=d[14],x=d[3],z=d[7],t=d[11],d=d[15];c[0]=p*
s*z-r*u*z+r*v*t-l*s*t-p*v*d+l*u*d;c[4]=k*u*z-h*s*z-k*v*t+g*s*t+h*v*d-g*u*d;c[8]=h*r*z-k*p*z+k*l*t-g*r*t-h*l*d+g*p*d;c[12]=k*p*v-h*r*v-k*l*u+g*r*u+h*l*s-g*p*s;c[1]=r*u*x-p*s*x-r*q*t+n*s*t+p*q*d-n*u*d;c[5]=h*s*x-k*u*x+k*q*t-f*s*t-h*q*d+f*u*d;c[9]=k*p*x-h*r*x-k*n*t+f*r*t+h*n*d-f*p*d;c[13]=h*r*q-k*p*q+k*n*u-f*r*u-h*n*s+f*p*s;c[2]=l*s*x-r*v*x+r*q*z-n*s*z-l*q*d+n*v*d;c[6]=k*v*x-g*s*x-k*q*z+f*s*z+g*q*d-f*v*d;c[10]=g*r*x-k*l*x+k*n*z-f*r*z-g*n*d+f*l*d;c[14]=k*l*q-g*r*q-k*n*v+f*r*v+g*n*s-f*l*s;c[3]=p*v*x-l*
u*x-p*q*z+n*u*z+l*q*t-n*v*t;c[7]=g*u*x-h*v*x+h*q*z-f*u*z-g*q*t+f*v*t;c[11]=h*l*x-g*p*x-h*n*z+f*p*z+g*n*t-f*l*t;c[15]=g*p*q-h*l*q+h*n*v-f*p*v-g*n*u+f*l*u;c=f*c[0]+n*c[4]+q*c[8]+x*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.Ic();return this}this.q(1/c);return this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},scale:function(a){var b=
this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},zr:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},Ck:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},Cn:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},Bn:function(a,b){var c=
Math.cos(b),d=Math.sin(b),f=1-c,g=a.x,h=a.y,k=a.z,n=f*g,l=f*h;this.set(n*g+c,n*h-d*k,n*k+d*h,0,n*h+d*k,l*h+c,l*k-d*g,0,n*k-d*h,l*k+d*g,f*k*k+c,0,0,0,0,1);return this},di:function(a,b,c){this.es(b);this.scale(c);this.ft(a);return this},gi:function(){var a=new b.a,e=new b.$;return function(b,d,f){var g=this.elements,h=a.set(g[0],g[1],g[2]).length(),k=a.set(g[4],g[5],g[6]).length(),n=a.set(g[8],g[9],g[10]).length();0>this.Om()&&(h=-h);b.x=g[12];b.y=g[13];b.z=g[14];e.elements.set(this.elements);b=1/h;
var g=1/k,l=1/n;e.elements[0]*=b;e.elements[1]*=b;e.elements[2]*=b;e.elements[4]*=g;e.elements[5]*=g;e.elements[6]*=g;e.elements[8]*=l;e.elements[9]*=l;e.elements[10]*=l;d.Li(e);f.x=h;f.y=k;f.z=n;return this}}(),zn:function(a,b,c,d,f,g){var h=this.elements;h[0]=2*f/(b-a);h[4]=0;h[8]=(b+a)/(b-a);h[12]=0;h[1]=0;h[5]=2*f/(d-c);h[9]=(d+c)/(d-c);h[13]=0;h[2]=0;h[6]=0;h[10]=-(g+f)/(g-f);h[14]=-2*g*f/(g-f);h[3]=0;h[7]=0;h[11]=-1;h[15]=0;return this},ds:function(a,e,c,d){a=c*Math.tan(b.Jb.Nm(0.5*a));var f=
-a;return this.zn(f*e,a*e,f,a,c,d)},cs:function(a,b,c,d,f,g){var h=this.elements,k=b-a,n=c-d,l=g-f;h[0]=2/k;h[4]=0;h[8]=0;h[12]=-((b+a)/k);h[1]=0;h[5]=2/n;h[9]=0;h[13]=-((c+d)/n);h[2]=0;h[6]=0;h[10]=-2/l;h[14]=-((g+f)/l);h[3]=0;h[7]=0;h[11]=0;h[15]=1;return this},aa:function(a){this.elements.set(a);return this},re:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},b:function(){var a=this.elements;return new b.$(a[0],a[4],a[8],
a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};b.Mh=function(a,e){this.origin=void 0!==a?a:new b.a;this.direction=void 0!==e?e:new b.a};b.Mh.prototype={constructor:b.Mh,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},Em:function(a,e){return(e||new b.a).copy(this.direction).q(a).add(this.origin)},Of:function(){var a=new b.a;return function(b){var c=a.ea(b,this.origin).za(this.direction);
if(0>c)return this.origin.Ed(b);a.copy(this.direction).q(c).add(this.origin);return a.Ed(b)}}(),Wf:function(){var a=new b.a;return function(b){return null!==this.Pr(b,a)}}(),Pr:function(a,b){var c,d,f,g,h;d=1/this.direction.x;g=1/this.direction.y;h=1/this.direction.z;var k=this.origin;0<=d?(c=(a.min.x-k.x)*d,d*=a.max.x-k.x):(c=(a.max.x-k.x)*d,d*=a.min.x-k.x);0<=g?(f=(a.min.y-k.y)*g,g*=a.max.y-k.y):(f=(a.max.y-k.y)*g,g*=a.min.y-k.y);if(c>g||f>d)return null;if(f>c||c!==c)c=f;if(g<d||d!==d)d=g;0<=h?
(f=(a.min.z-k.z)*h,h*=a.max.z-k.z):(f=(a.max.z-k.z)*h,h*=a.min.z-k.z);if(c>h||f>d)return null;if(f>c||c!==c)c=f;if(h<d||d!==d)d=h;return 0>d?null:this.Em(0<=c?c:d,b)},O:function(a){this.direction.add(this.origin).O(a);this.origin.O(a);this.direction.sub(this.origin);this.direction.normalize();return this},oa:function(a){return a.origin.oa(this.origin)&&a.direction.oa(this.direction)},b:function(){return(new b.Mh).copy(this)}};b.tc=function(a,e){this.ua=void 0!==a?a:new b.a;this.K=void 0!==e?e:0};
b.tc.prototype={constructor:b.tc,set:function(a,b){this.ua.copy(a);this.K=b;return this},Ld:function(){var a=new b.lc;return function(b,c){var d=this.ua;void 0!==c?d.copy(c):a.Ld(b).ua(d);for(var f=0,g=0,h=b.length;g<h;g++)f=Math.max(f,d.ce(b[g]));this.K=Math.sqrt(f);return this}}(),copy:function(a){this.ua.copy(a.ua);this.K=a.K;return this},empty:function(){return 0>=this.K},Jf:function(a){return a.ce(this.ua)<=this.K*this.K},Of:function(a){return a.Ed(this.ua)-this.K},on:function(a){var b=this.K+
a.K;return a.ua.ce(this.ua)<=b*b},pi:function(a){a=a||new b.lc;a.set(this.ua,this.ua);a.Qf(this.K);return a},O:function(a){this.ua.O(a);this.K*=a.zr();return this},translate:function(a){this.ua.add(a);return this},oa:function(a){return a.ua.oa(this.ua)&&a.K===this.K},b:function(){return(new b.tc).copy(this)}};b.xe=function(a,e,c,d,f,g){this.ag=[void 0!==a?a:new b.td,void 0!==e?e:new b.td,void 0!==c?c:new b.td,void 0!==d?d:new b.td,void 0!==f?f:new b.td,void 0!==g?g:new b.td]};b.xe.prototype={constructor:b.xe,
set:function(a,b,c,d,f,g){var h=this.ag;h[0].copy(a);h[1].copy(b);h[2].copy(c);h[3].copy(d);h[4].copy(f);h[5].copy(g);return this},copy:function(a){for(var b=this.ag,c=0;6>c;c++)b[c].copy(a.ag[c]);return this},Ki:function(a){var b=this.ag,c=a.elements;a=c[0];var d=c[1],f=c[2],g=c[3],h=c[4],k=c[5],n=c[6],l=c[7],p=c[8],r=c[9],q=c[10],v=c[11],u=c[12],s=c[13],x=c[14],c=c[15];b[0].gg(g-a,l-h,v-p,c-u).normalize();b[1].gg(g+a,l+h,v+p,c+u).normalize();b[2].gg(g+d,l+k,v+r,c+s).normalize();b[3].gg(g-d,l-k,
v-r,c-s).normalize();b[4].gg(g-f,l-n,v-q,c-x).normalize();b[5].gg(g+f,l+n,v+q,c+x).normalize();return this},ti:function(){var a=new b.tc;return function(b){var c=b.j;null===c.ib&&c.Kg();a.copy(c.ib);a.O(b.l);return this.on(a)}}(),on:function(a){var b=this.ag,c=a.ua;a=-a.K;for(var d=0;6>d;d++)if(b[d].Of(c)<a)return!1;return!0},Jf:function(a){for(var b=this.ag,c=0;6>c;c++)if(0>b[c].Of(a))return!1;return!0},b:function(){return(new b.xe).copy(this)}};b.td=function(a,e){this.F=void 0!==a?a:new b.a(1,0,
0);this.Bb=void 0!==e?e:0};b.td.prototype={constructor:b.td,set:function(a,b){this.F.copy(a);this.Bb=b;return this},gg:function(a,b,c,d){this.F.set(a,b,c);this.Bb=d;return this},ct:function(a,b){this.F.copy(a);this.Bb=-b.za(this.F);return this},copy:function(a){this.F.copy(a.F);this.Bb=a.Bb;return this},normalize:function(){var a=1/this.F.length();this.F.q(a);this.Bb*=a;return this},We:function(){this.Bb*=-1;this.F.We();return this},Of:function(a){return this.F.za(a)+this.Bb},Uq:function(a){return(a||
new b.a).copy(this.F).q(-this.Bb)},O:function(){var a=new b.a,e=new b.a,c=new b.pc;return function(b,f){var g=f||c.dd(b),g=a.copy(this.F).xc(g),h=this.Uq(e);h.O(b);this.ct(g,h);return this}}(),translate:function(a){this.Bb-=a.za(this.F);return this},oa:function(a){return a.F.oa(this.F)&&a.Bb==this.Bb},b:function(){return(new b.td).copy(this)}};b.Jb={uu:2*Math.PI,Vg:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,d;return function(){for(var f=
0;36>f;f++)8==f||13==f||18==f||23==f?b[f]="-":14==f?b[f]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),d=c&15,c>>=4,b[f]=a[19==f?d&3|8:d]);return b.join("")}}(),be:function(a,b,c){return a<b?b:a>c?c:a},Xu:function(a,b){return a<b?b:a},Ow:function(a,b,c,d,f){return d+(a-b)*(f-d)/(c-b)},vt:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},iy:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},Nk:function(){return(65280*Math.random()+
255*Math.random())/65535},Jx:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},Hx:function(a,b){return a+Math.random()*(b-a)},Ix:function(a){return a*(0.5-Math.random())},cy:function(a){return 0>a?-1:0<a?1:0},Nm:function(){var a=Math.PI/180;return function(b){return b*a}}(),Gx:function(){var a=180/Math.PI;return function(b){return b*a}}()};b.Du=function(a){function e(a,b,c,e,d,f,g){a=0.5*(c-a);e=0.5*(e-b);return(2*(b-c)+a+e)*g+(-3*(b-c)-2*a-e)*f+a*d+b}this.ca=a;var c=[],d={x:0,y:0,z:0},f,
g,h,k,n,l,p,r,q;this.Ja=function(a){f=(this.ca.length-1)*a;g=Math.floor(f);h=f-g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>this.ca.length-2?this.ca.length-1:g+1;c[3]=g>this.ca.length-3?this.ca.length-1:g+2;l=this.ca[c[0]];p=this.ca[c[1]];r=this.ca[c[2]];q=this.ca[c[3]];k=h*h;n=h*k;d.x=e(l.x,p.x,r.x,q.x,h,k,n);d.y=e(l.y,p.y,r.y,q.y,h,k,n);d.z=e(l.z,p.z,r.z,q.z,h,k,n);return d};this.Wg=function(a){var c,e,d,f=c=c=0,g=new b.a,h=new b.a,k=[],n=0;k[0]=0;a||(a=100);e=this.ca.length*a;g.copy(this.ca[0]);for(a=1;a<
e;a++)c=a/e,d=this.Ja(c),h.copy(d),n+=h.Ed(g),g.copy(d),c*=this.ca.length-1,c=Math.floor(c),c!=f&&(k[c]=n,f=c);k[k.length]=n;return{Wu:k,total:n}}};b.Xc=function(a,e,c){this.I=void 0!==a?a:new b.a;this.g=void 0!==e?e:new b.a;this.J=void 0!==c?c:new b.a};b.Xc.F=function(){var a=new b.a;return function(e,c,d,f){f=f||new b.a;f.ea(d,c);a.ea(e,c);f.Qe(a);e=f.vi();return 0<e?f.q(1/Math.sqrt(e)):f.set(0,0,0)}}();b.Xc.Rj=function(){var a=new b.a,e=new b.a,c=new b.a;return function(d,f,g,h,k){a.ea(h,f);e.ea(g,
f);c.ea(d,f);d=a.za(a);f=a.za(e);g=a.za(c);var n=e.za(e);h=e.za(c);var l=d*n-f*f;k=k||new b.a;if(0==l)return k.set(-2,-1,-1);l=1/l;n=(n*g-f*h)*l;d=(d*h-f*g)*l;return k.set(1-n-d,d,n)}}();b.Xc.Jf=function(){var a=new b.a;return function(e,c,d,f){e=b.Xc.Rj(e,c,d,f,a);return 0<=e.x&&0<=e.y&&1>=e.x+e.y}}();b.Xc.prototype={constructor:b.Xc,set:function(a,b,c){this.I.copy(a);this.g.copy(b);this.J.copy(c);return this},copy:function(a){this.I.copy(a.I);this.g.copy(a.g);this.J.copy(a.J);return this},Ef:function(){var a=
new b.a,e=new b.a;return function(){a.ea(this.J,this.g);e.ea(this.I,this.g);return 0.5*a.Qe(e).length()}}(),F:function(a){return b.Xc.F(this.I,this.g,this.J,a)},Rj:function(a,e){return b.Xc.Rj(a,this.I,this.g,this.J,e)},Jf:function(a){return b.Xc.Jf(a,this.I,this.g,this.J)},oa:function(a){return a.I.oa(this.I)&&a.g.oa(this.g)&&a.J.oa(this.J)},b:function(){return(new b.Xc).copy(this)}};b.Hu=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};b.Gu=function(a,
e){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new b.h(a,e)};b.rl=function(a){this.zq=void 0!==a?a:!0;this.elapsedTime=this.Hk=this.startTime=0;this.Ji=!1};b.rl.prototype={constructor:b.rl,start:function(){this.Hk=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.Ji=!0},stop:function(){this.xr();this.Ji=!1},xr:function(){this.wr();return this.elapsedTime},wr:function(){var a=0;this.zq&&!this.Ji&&this.start();
if(this.Ji){var b=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),a=0.0010*(b-this.Hk);this.Hk=b;this.elapsedTime+=a}return a}};b.oc=la();b.oc.prototype={constructor:b.oc,apply:function(a){a.addEventListener=b.oc.prototype.addEventListener;a.si=b.oc.prototype.si;a.removeEventListener=b.oc.prototype.removeEventListener;a.dispatchEvent=b.oc.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this.Vd&&(this.Vd={});var c=this.Vd;void 0===c[a]&&(c[a]=
[]);-1===c[a].indexOf(b)&&c[a].push(b)},si:function(a,b){if(void 0===this.Vd)return!1;var c=this.Vd;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this.Vd){var c=this.Vd[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(){var a=[];return function(b){if(void 0!==this.Vd){var c=this.Vd[b.type];if(void 0!==c){b.target=this;for(var d=c.length,f=0;f<d;f++)a[f]=c[f];for(f=0;f<d;f++)a[f].call(this,b)}}}}()};(function(a){a.Pl=
function(b,c,d,f){this.Us=new a.Mh(b,c);this.ta=d||0;this.wa=f||Infinity};new a.$;a.Pl.prototype.precision=1E-4;a.Pl.prototype.set=function(a,b){this.Us.set(a,b)}})(b);b.C=function(){this.id=b.np++;this.Cc=b.Jb.Vg();this.name="";this.parent=void 0;this.children=[];this.od=new b.a(0,1,0);this.position=new b.a;this.Wd=new b.nc;this.Nb=new b.rc;this.scale=new b.a(1,1,1);this.Wd.Nb=this.Ca;this.Nb.Cg=this.rotation;this.dg=null;this.lo=!0;this.ra=new b.$;this.l=new b.$;this.visible=this.eb=this.sa=!0;
this.cg=this.tb=!1;this.Re=!0;this.pd={}};b.C.prototype={constructor:b.C,get rotation(){return this.Wd},set rotation(a){this.Wd=a;this.Wd.Nb=this.Nb;this.Nb.Cg=this.Wd;this.Wd.Yc()},get Ca(){return this.Nb},set Ca(a){this.Nb=a;this.Nb.Cg=this.Wd;this.Wd.Nb=this.Nb;this.Nb.Xb()},Bd:function(a){this.ra.La(a,this.ra);this.ra.gi(this.position,this.Ca,this.scale)},Lt:function(){var a=new b.a;return function(b,c){a.copy(b);a.Oj(this.Ca);this.position.add(a.q(c));return this}}(),translate:function(a,b){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");
return this.Lt(b,a)},Fb:function(){var a=new b.$;return function(b){a.Fb(b,this.position,this.od);this.Ca.Li(a)}}(),add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof b.C){void 0!==a.parent&&a.parent.remove(a);a.parent=this;a.dispatchEvent({type:"added"});this.children.push(a);for(var e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof b.wd&&e.em(a)}},remove:function(a){var e=this.children.indexOf(a);if(-1!==
e){a.parent=void 0;a.dispatchEvent({type:"removed"});this.children.splice(e,1);for(e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof b.wd&&e.Bj(a)}},Ui:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].Ui(a)},Bc:function(){this.ra.di(this.position,this.Ca,this.scale);this.eb=!0},Fa:function(a){!0===this.sa&&this.Bc();if(!0===this.eb||!0===a)void 0===this.parent?this.l.copy(this.ra):this.l.La(this.parent.l,this.ra),this.eb=!1,a=!0;for(var b=0,c=this.children.length;b<
c;b++)this.children[b].Fa(a)},b:function(a,e){void 0===a&&(a=new b.C);void 0===e&&(e=!0);a.name=this.name;a.od.copy(this.od);a.position.copy(this.position);a.Ca.copy(this.Ca);a.scale.copy(this.scale);a.dg=this.dg;a.lo=this.lo;a.ra.copy(this.ra);a.l.copy(this.l);a.sa=this.sa;a.eb=this.eb;a.visible=this.visible;a.tb=this.tb;a.cg=this.cg;a.Re=this.Re;a.pd=JSON.parse(JSON.stringify(this.pd));if(!0===e)for(var c=0;c<this.children.length;c++)a.add(this.children[c].b());return a}};b.oc.prototype.apply(b.C.prototype);
b.np=0;b.sj=function(){function a(e){if(!1!==e.visible){e instanceof b.Da?I.yc.push(e):e instanceof b.U||e instanceof b.fa?!1!==e.Re&&!0!==ma.ti(e)||I.Ba.push(c(e)):e instanceof b.xd&&I.Si.push(c(e));for(var d=0,f=e.children.length;d<f;d++)a(e.children[d])}}function e(a){var b=a.bg,c=a.k;b.copy(a.position).O(aa);c.copy(b).O(X);b=1/c.f;c.x*=b;c.y*=b;c.z*=b;a.visible=-1<=c.x&&1>=c.x&&-1<=c.y&&1>=c.y&&-1<=c.z&&1>=c.z}function c(a){if(k===l){var c=new b.vp;n.push(c);l++;k++;h=c}else h=n[k++];h.id=a.id;
h.object=a;null!==a.dg?h.z=a.dg:(A.Ua(a.l),A.Ke(X),h.z=A.z);return h}function d(){if(r===v){var a=new b.Be;q.push(a);v++;r++;return a}return q[r++]}function f(a,b){return a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function g(a,b){var c=0,e=1,d=a.z+a.f,f=b.z+b.f,g=-a.z+a.f,h=-b.z+b.f;if(0<=d&&0<=f&&0<=g&&0<=h)return!0;if(0>d&&0>f||0>g&&0>h)return!1;0>d?c=Math.max(c,d/(d-f)):0>f&&(e=Math.min(e,d/(d-f)));0>g?c=Math.max(c,g/(g-h)):0>h&&(e=Math.min(e,g/(g-h)));if(e<c)return!1;a.je(b,c);b.je(a,1-e);return!0}
var h,k,n=[],l=0,p,r,q=[],v=0,u,s,x=[],z=0,t,w,y=[],H=0,N,Q,C=[],M=0,I={Ba:[],Si:[],yc:[],elements:[]},D=new b.a,K=new b.a,F=new b.a,A=new b.a,J=new b.vc,E=new b.lc(new b.a(-1,-1,-1),new b.a(1,1,1)),W=new b.lc,G=Array(3),Ua=new b.$,X=new b.$,aa,P=new b.$,Y=new b.pc,R=new b.pc,pa=new b.a,ma=new b.xe,va=new b.vc,U=new b.vc;this.Ko=function(){var a=new b.$;return function(b,c){a.Fd(c.xa);X.La(c.l,a);return b.Ke(X)}}();this.Os=function(c,h,n,l){var v=!1,A,ca,T,ea,S,ga,na,La,Ma;Q=w=s=0;I.elements.length=
0;!0===c.Gf&&c.Fa();void 0===h.parent&&h.Fa();Ua.copy(h.Ta.Fd(h.l));X.La(h.xa,Ua);R.dd(Ua);ma.Ki(X);k=0;I.Ba.length=0;I.Si.length=0;I.yc.length=0;a(c);!0===n&&I.Ba.sort(f);n=0;for(var qa=I.Ba.length;n<qa;n++)if(c=I.Ba[n].object,aa=c.l,r=0,c instanceof b.U){A=c.j;ca=A.e;T=A.i;S=A.v;Y.dd(aa);La=c.D instanceof b.qc;Ma=!0===La?c.D:null;for(var ta=0,Da=ca.length;ta<Da;ta++)p=d(),p.position.copy(ca[ta]),e(p);ta=0;for(Da=T.length;ta<Da;ta++){ca=T[ta];var Na=!0===La?Ma.Z[ca.fc]:c.D;if(void 0!==Na){var Fa=
Na.zc;ea=q[ca.I];ga=q[ca.g];na=q[ca.J];if(!0===Na.A){var v=A.A,Ka=c.Kc,Va=ea.position,Pa=ga.position,Ba=na.position;D.set(0,0,0);K.set(0,0,0);F.set(0,0,0);for(var xa=0,Ea=v.length;xa<Ea;xa++){var Ia=Ka[xa];if(0!==Ia){var za=v[xa].e;D.x+=(za[ca.I].x-Va.x)*Ia;D.y+=(za[ca.I].y-Va.y)*Ia;D.z+=(za[ca.I].z-Va.z)*Ia;K.x+=(za[ca.g].x-Pa.x)*Ia;K.y+=(za[ca.g].y-Pa.y)*Ia;K.z+=(za[ca.g].z-Pa.z)*Ia;F.x+=(za[ca.J].x-Ba.x)*Ia;F.y+=(za[ca.J].y-Ba.y)*Ia;F.z+=(za[ca.J].z-Ba.z)*Ia}}ea.position.add(D);ga.position.add(K);
na.position.add(F);e(ea);e(ga);e(na)}G[0]=ea.k;G[1]=ga.k;G[2]=na.k;if(!0===ea.visible||!0===ga.visible||!0===na.visible||E.Wf(W.Ld(G)))if(v=0>(na.k.x-ea.k.x)*(ga.k.y-ea.k.y)-(na.k.y-ea.k.y)*(ga.k.x-ea.k.x),Fa===b.we||v===(Fa===b.fj)){s===z?(Ka=new b.Ql,x.push(Ka),z++,s++,u=Ka):u=x[s++];u.id=c.id;u.ha.copy(ea);u.ka.copy(ga);u.Dc.copy(na);u.fh.copy(ca.F);!1!==v||Fa!==b.nf&&Fa!==b.we||u.fh.We();u.fh.xc(Y).normalize();u.On.copy(u.fh).xc(R);u.bk.copy(ca.jb).O(aa);ea=ca.V;ga=0;for(na=Math.min(ea.length,
3);ga<na;ga++)Ka=u.Yi[ga],Ka.copy(ea[ga]),!1!==v||Fa!==b.nf&&Fa!==b.we||Ka.We(),Ka.xc(Y).normalize(),u.kf[ga].copy(Ka).xc(R);u.Oo=ea.length;ga=0;for(Fa=Math.min(S.length,3);ga<Fa;ga++)if(ea=S[ga][ta],void 0!==ea)for(na=0,v=ea.length;na<v;na++)u.jf[ga][na]=ea[na];u.color=ca.color;u.D=Na;pa.copy(u.bk).Ke(X);u.z=pa.z;I.elements.push(u)}}}}else if(c instanceof b.fa)for(P.La(X,aa),ca=c.j.e,ea=d(),ea.k.copy(ca[0]).O(P),A=c.type===b.Tc?2:1,ta=1,Da=ca.length;ta<Da;ta++)ea=d(),ea.k.copy(ca[ta]).O(P),0<(ta+
1)%A||(ga=q[r-2],va.copy(ea.k),U.copy(ga.k),!0===g(va,U)&&(va.q(1/va.f),U.q(1/U.f),w===H?(T=new b.Rl,y.push(T),H++,w++,t=T):t=y[w++],t.id=c.id,t.ha.k.copy(va),t.ka.k.copy(U),t.z=Math.max(va.z,U.z),t.D=c.D,c.D.u===b.De&&(t.u[0].copy(c.j.va[ta]),t.u[1].copy(c.j.va[ta-1])),I.elements.push(t)));n=0;for(qa=I.Si.length;n<qa;n++)c=I.Si[n].object,aa=c.l,J.set(aa.elements[12],aa.elements[13],aa.elements[14],1),J.O(X),A=1/J.f,J.z*=A,-1<=J.z&&1>=J.z&&(Q===M?(T=new b.Sl,C.push(T),M++,Q++,N=T):N=C[Q++],N.id=c.id,
N.x=J.x*A,N.y=J.y*A,N.z=J.z,N.object=c,N.rotation=c.rotation,N.scale.x=c.scale.x*Math.abs(N.x-(J.x+h.xa.elements[0])/(J.f+h.xa.elements[12])),N.scale.y=c.scale.y*Math.abs(N.y-(J.y+h.xa.elements[5])/(J.f+h.xa.elements[13])),N.D=c.D,I.elements.push(N));!0===l&&I.elements.sort(f);return I}};b.N=function(a,e,c,d,f,g){this.I=a;this.g=e;this.J=c;this.F=d instanceof b.a?d:new b.a;this.V=d instanceof Array?d:[];this.color=f instanceof b.p?f:new b.p;this.u=f instanceof Array?f:[];this.se=[];this.fc=void 0!==
g?g:0;this.jb=new b.a};b.N.prototype={constructor:b.N,b:function(){var a=new b.N(this.I,this.g,this.J);a.F.copy(this.F);a.color.copy(this.color);a.jb.copy(this.jb);a.fc=this.fc;var e,c;e=0;for(c=this.V.length;e<c;e++)a.V[e]=this.V[e].b();e=0;for(c=this.u.length;e<c;e++)a.u[e]=this.u[e].b();e=0;for(c=this.se.length;e<c;e++)a.se[e]=this.se[e].b();return a}};b.nu=function(a,e,c,d,f,g,h){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new b.N(a,e,c,f,g,h)};
b.B=function(){this.id=b.yl++;this.Cc=b.Jb.Vg();this.name="";this.e=[];this.va=[];this.i=[];this.v=[[]];this.A=[];this.le=[];this.pa=[];this.qe=[];this.pe=[];this.Wr=[];this.ib=this.Qb=null;this.Uf=!1;this.ji=!0;this.Fm=this.yi=this.ac=this.xh=this.Yf=this.Xi=this.ki=this.$a=!1};b.B.prototype={constructor:b.B,Bd:function(a){for(var e=(new b.pc).dd(a),c=0,d=this.e.length;c<d;c++)this.e[c].O(a);c=0;for(d=this.i.length;c<d;c++){var f=this.i[c];f.F.xc(e).normalize();for(var g=0,h=f.V.length;g<h;g++)f.V[g].xc(e).normalize();
f.jb.O(a)}this.Qb instanceof b.lc&&this.Jg();this.ib instanceof b.tc&&this.Kg()},ub:function(){var a,b,c;a=0;for(b=this.i.length;a<b;a++)c=this.i[a],c.jb.set(0,0,0),c.jb.add(this.e[c.I]),c.jb.add(this.e[c.g]),c.jb.add(this.e[c.J]),c.jb.de(3)},vb:function(){for(var a=new b.a,e=new b.a,c=0,d=this.i.length;c<d;c++){var f=this.i[c],g=this.e[f.I],h=this.e[f.g];a.ea(this.e[f.J],h);e.ea(g,h);a.Qe(e);a.normalize();f.F.copy(a)}},Pe:function(a){var e,c,d;d=Array(this.e.length);e=0;for(c=this.e.length;e<c;e++)d[e]=
new b.a;if(a){var f,g,h,k=new b.a,n=new b.a;a=0;for(e=this.i.length;a<e;a++)c=this.i[a],f=this.e[c.I],g=this.e[c.g],h=this.e[c.J],k.ea(h,g),n.ea(f,g),k.Qe(n),d[c.I].add(k),d[c.g].add(k),d[c.J].add(k)}else for(a=0,e=this.i.length;a<e;a++)c=this.i[a],d[c.I].add(c.F),d[c.g].add(c.F),d[c.J].add(c.F);e=0;for(c=this.e.length;e<c;e++)d[e].normalize();a=0;for(e=this.i.length;a<e;a++)c=this.i[a],c.V[0]=d[c.I].b(),c.V[1]=d[c.g].b(),c.V[2]=d[c.J].b()},Tq:function(){var a,e,c,d,f;c=0;for(d=this.i.length;c<d;c++)for(f=
this.i[c],f.Aj?f.Aj.copy(f.F):f.Aj=f.F.b(),f.yg||(f.yg=[]),a=0,e=f.V.length;a<e;a++)f.yg[a]?f.yg[a].copy(f.V[a]):f.yg[a]=f.V[a].b();var g=new b.B;g.i=this.i;a=0;for(e=this.A.length;a<e;a++){if(!this.pa[a]){this.pa[a]={};this.pa[a].nk=[];this.pa[a].V=[];f=this.pa[a].nk;var h=this.pa[a].V,k,n;c=0;for(d=this.i.length;c<d;c++)k=new b.a,n={I:new b.a,g:new b.a,J:new b.a},f.push(k),h.push(n)}h=this.pa[a];g.e=this.A[a].e;g.vb();g.Pe();c=0;for(d=this.i.length;c<d;c++)f=this.i[c],k=h.nk[c],n=h.V[c],k.copy(f.F),
n.I.copy(f.V[0]),n.g.copy(f.V[1]),n.J.copy(f.V[2])}c=0;for(d=this.i.length;c<d;c++)f=this.i[c],f.F=f.Aj,f.V=f.yg},ei:function(){var a,e,c,d,f,g,h,k,n,l,p,r,q,v,u,s,x,z=[],t=[];c=new b.a;var w=new b.a,y=new b.a,H=new b.a,N=new b.a;a=0;for(e=this.e.length;a<e;a++)z[a]=new b.a,t[a]=new b.a;a=0;for(e=this.i.length;a<e;a++)f=this.i[a],g=this.v[0][a],d=f.I,x=f.g,f=f.J,h=this.e[d],k=this.e[x],n=this.e[f],l=g[0],p=g[1],r=g[2],g=k.x-h.x,q=n.x-h.x,v=k.y-h.y,u=n.y-h.y,k=k.z-h.z,h=n.z-h.z,n=p.x-l.x,s=r.x-l.x,
p=p.y-l.y,l=r.y-l.y,r=1/(n*l-s*p),c.set((l*g-p*q)*r,(l*v-p*u)*r,(l*k-p*h)*r),w.set((n*q-s*g)*r,(n*u-s*v)*r,(n*h-s*k)*r),z[d].add(c),z[x].add(c),z[f].add(c),t[d].add(w),t[x].add(w),t[f].add(w);w=["a","b","c","d"];a=0;for(e=this.i.length;a<e;a++)for(f=this.i[a],c=0;c<Math.min(f.V.length,3);c++)N.copy(f.V[c]),d=f[w[c]],x=z[d],y.copy(x),y.sub(N.q(N.za(x))).normalize(),H.Cb(f.V[c],x),d=H.za(t[d]),d=0>d?-1:1,f.se[c]=new b.vc(y.x,y.y,y.z,d);this.Uf=!0},Jg:function(){null===this.Qb&&(this.Qb=new b.lc);this.Qb.Ld(this.e)},
Kg:function(){null===this.ib&&(this.ib=new b.tc);this.ib.Ld(this.e)},Ci:function(){var a={},b=[],c=[],d,f=Math.pow(10,4),g,h;g=0;for(h=this.e.length;g<h;g++)d=this.e[g],d=Math.round(d.x*f)+"_"+Math.round(d.y*f)+"_"+Math.round(d.z*f),void 0===a[d]?(a[d]=g,b.push(this.e[g]),c[g]=b.length-1):c[g]=c[a[d]];a=[];g=0;for(h=this.i.length;g<h;g++)for(f=this.i[g],f.I=c[f.I],f.g=c[f.g],f.J=c[f.J],f=[f.I,f.g,f.J],d=0;3>d;d++)if(f[d]==f[(d+1)%3]){a.push(g);break}for(g=a.length-1;0<=g;g--)for(f=a[g],this.i.splice(f,
1),c=0,h=this.v.length;c<h;c++)this.v[c].splice(f,1);g=this.e.length-b.length;this.e=b;return g},b:function(){for(var a=new b.B,e=this.e,c=0,d=e.length;c<d;c++)a.e.push(e[c].b());e=this.i;c=0;for(d=e.length;c<d;c++)a.i.push(e[c].b());e=this.v[0];c=0;for(d=e.length;c<d;c++){for(var f=e[c],g=[],h=0,k=f.length;h<k;h++)g.push(new b.h(f[h].x,f[h].y));a.v[0].push(g)}return a}};b.oc.prototype.apply(b.B.prototype);b.yl=0;b.qb=function(){this.id=b.yl++;this.Cc=b.Jb.Vg();this.name="";this.attributes={};this.ji=
!0;this.Kd=[];this.ib=this.Qb=null;this.Uf=!1;this.A=[]};b.qb.prototype={constructor:b.qb,Wh:function(a,b,c,d){this.attributes[a]={fd:d,c:new b(c*d)}},Bd:function(a){var e,c;this.attributes.position&&(e=this.attributes.position.c);this.attributes.normal&&(c=this.attributes.normal.c);void 0!==e&&(a.Fk(e),this.$a=!0);void 0!==c&&((new b.pc).dd(a).Fk(c),this.Pn(),this.Yf=!0)},Jg:function(){null===this.Qb&&(this.Qb=new b.lc);var a=this.attributes.position.c;if(a){var e=this.Qb,c,d,f;3<=a.length&&(e.min.x=
e.max.x=a[0],e.min.y=e.max.y=a[1],e.min.z=e.max.z=a[2]);for(var g=3,h=a.length;g<h;g+=3)c=a[g],d=a[g+1],f=a[g+2],c<e.min.x?e.min.x=c:c>e.max.x&&(e.max.x=c),d<e.min.y?e.min.y=d:d>e.max.y&&(e.max.y=d),f<e.min.z?e.min.z=f:f>e.max.z&&(e.max.z=f)}if(void 0===a||0===a.length)this.Qb.min.set(0,0,0),this.Qb.max.set(0,0,0)},Kg:function(){var a=new b.lc,e=new b.a;return function(){null===this.ib&&(this.ib=new b.tc);var c=this.attributes.position.c;if(c){a.Id();for(var d=this.ib.ua,f=0,g=c.length;f<g;f+=3)e.set(c[f],
c[f+1],c[f+2]),a.xm(e);a.ua(d);for(var h=0,f=0,g=c.length;f<g;f+=3)e.set(c[f],c[f+1],c[f+2]),h=Math.max(h,d.ce(e));this.ib.K=Math.sqrt(h)}}}(),Pe:function(){if(this.attributes.position){var a,e,c,d;a=this.attributes.position.c.length;if(void 0===this.attributes.normal)this.attributes.normal={fd:3,c:new Float32Array(a)};else for(a=0,e=this.attributes.normal.c.length;a<e;a++)this.attributes.normal.c[a]=0;var f=this.attributes.position.c,g=this.attributes.normal.c,h,k,n,l,p,r,q=new b.a,v=new b.a,u=new b.a,
s=new b.a,x=new b.a;if(this.attributes.index){var z=this.attributes.index.c,t=this.Kd;c=0;for(d=t.length;c<d;++c){e=t[c].start;h=t[c].count;var w=t[c].index;a=e;for(e+=h;a<e;a+=3)h=w+z[a],k=w+z[a+1],n=w+z[a+2],l=f[3*h],p=f[3*h+1],r=f[3*h+2],q.set(l,p,r),l=f[3*k],p=f[3*k+1],r=f[3*k+2],v.set(l,p,r),l=f[3*n],p=f[3*n+1],r=f[3*n+2],u.set(l,p,r),s.ea(u,v),x.ea(q,v),s.Qe(x),g[3*h]+=s.x,g[3*h+1]+=s.y,g[3*h+2]+=s.z,g[3*k]+=s.x,g[3*k+1]+=s.y,g[3*k+2]+=s.z,g[3*n]+=s.x,g[3*n+1]+=s.y,g[3*n+2]+=s.z}}else for(a=
0,e=f.length;a<e;a+=9)l=f[a],p=f[a+1],r=f[a+2],q.set(l,p,r),l=f[a+3],p=f[a+4],r=f[a+5],v.set(l,p,r),l=f[a+6],p=f[a+7],r=f[a+8],u.set(l,p,r),s.ea(u,v),x.ea(q,v),s.Qe(x),g[a]=s.x,g[a+1]=s.y,g[a+2]=s.z,g[a+3]=s.x,g[a+4]=s.y,g[a+5]=s.z,g[a+6]=s.x,g[a+7]=s.y,g[a+8]=s.z;this.Pn();this.Yf=!0}},Pn:function(){for(var a=this.attributes.normal.c,b,c,d,f=0,g=a.length;f<g;f+=3)b=a[f],c=a[f+1],d=a[f+2],b=1/Math.sqrt(b*b+c*c+d*d),a[f]*=b,a[f+1]*=b,a[f+2]*=b},ei:function(){function a(a,b,c){r=d[3*a];q=d[3*a+1];v=
d[3*a+2];u=d[3*b];s=d[3*b+1];x=d[3*b+2];z=d[3*c];t=d[3*c+1];w=d[3*c+2];y=g[2*a];H=g[2*a+1];N=g[2*b];Q=g[2*b+1];C=g[2*c];M=g[2*c+1];I=u-r;D=z-r;K=s-q;F=t-q;A=x-v;J=w-v;E=N-y;W=C-y;G=Q-H;Ua=M-H;X=1/(E*Ua-W*G);aa.set((Ua*I-G*D)*X,(Ua*K-G*F)*X,(Ua*A-G*J)*X);P.set((E*D-W*I)*X,(E*F-W*K)*X,(E*J-W*A)*X);n[a].add(aa);n[b].add(aa);n[c].add(aa);l[a].add(P);l[b].add(P);l[c].add(P)}function e(a){Aa.x=f[3*a];Aa.y=f[3*a+1];Aa.z=f[3*a+2];wa.copy(Aa);ca=n[a];B.copy(ca);B.sub(Aa.q(Aa.za(ca))).normalize();ba.Cb(wa,
ca);T=ba.za(l[a]);da=0>T?-1:1;k[4*a]=B.x;k[4*a+1]=B.y;k[4*a+2]=B.z;k[4*a+3]=da}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.c,d=this.attributes.position.c,f=this.attributes.normal.c,g=this.attributes.uv.c,h=d.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent=
{fd:4,c:new Float32Array(4*h)});for(var k=this.attributes.tangent.c,n=[],l=[],p=0;p<h;p++)n[p]=new b.a,l[p]=new b.a;var r,q,v,u,s,x,z,t,w,y,H,N,Q,C,M,I,D,K,F,A,J,E,W,G,Ua,X,aa=new b.a,P=new b.a,Y,R,pa,ma,S,U=this.Kd,p=0;for(R=U.length;p<R;++p){Y=U[p].start;pa=U[p].count;var V=U[p].index,h=Y;for(Y+=pa;h<Y;h+=3)pa=V+c[h],ma=V+c[h+1],S=V+c[h+2],a(pa,ma,S)}var B=new b.a,ba=new b.a,Aa=new b.a,wa=new b.a,da,ca,T,p=0;for(R=U.length;p<R;++p)for(Y=U[p].start,pa=U[p].count,V=U[p].index,h=Y,Y+=pa;h<Y;h+=3)pa=
V+c[h],ma=V+c[h+1],S=V+c[h+2],e(pa),e(ma),e(S);this.xh=this.Uf=!0}},b:function(){var a=new b.qb,e=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],c;for(c in this.attributes){for(var d=this.attributes[c],f=d.c,g={fd:d.fd,gd:d.gd,c:null},d=0,h=e.length;d<h;d++){var k=e[d];if(f instanceof k){g.c=new k(f);break}}a.attributes[c]=g}d=0;for(h=this.Kd.length;d<h;d++)e=this.Kd[d],a.Kd.push({start:e.start,index:e.index,count:e.count});return a}};
b.oc.prototype.apply(b.qb.prototype);b.fb=function(){b.C.call(this);this.Ta=new b.$;this.xa=new b.$};b.fb.prototype=Object.create(b.C.prototype);b.fb.prototype.Fb=function(){var a=new b.$;return function(b){a.Fb(this.position,b,this.od);this.Ca.Li(a)}}();b.fb.prototype.b=function(a){void 0===a&&(a=new b.fb);b.C.prototype.b.call(this,a);a.Ta.copy(this.Ta);a.xa.copy(this.xa);return a};b.Rd=function(a,e,c,d,f,g){b.fb.call(this);this.left=a;this.right=e;this.top=c;this.bottom=d;this.ta=void 0!==f?f:0.1;
this.wa=void 0!==g?g:2E3;this.hf()};b.Rd.prototype=Object.create(b.fb.prototype);b.Rd.prototype.hf=function(){this.xa.cs(this.left,this.right,this.top,this.bottom,this.ta,this.wa)};b.Rd.prototype.b=function(){var a=new b.Rd;b.fb.prototype.b.call(this,a);a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.ta=this.ta;a.wa=this.wa;return a};b.Lb=function(a,e,c,d){b.fb.call(this);this.bd=void 0!==a?a:50;this.Ff=void 0!==e?e:1;this.ta=void 0!==c?c:0.1;this.wa=void 0!==d?d:2E3;this.hf()};
b.Lb.prototype=Object.create(b.fb.prototype);b.Lb.prototype.hf=function(){if(this.pk){var a=this.pk/this.Xm,e=Math.tan(b.Jb.Nm(0.5*this.bd))*this.ta,c=-e,d=a*c,a=Math.abs(a*e-d),c=Math.abs(e-c);this.xa.zn(d+this.x*a/this.pk,d+(this.x+this.width)*a/this.pk,e-(this.y+this.height)*c/this.Xm,e-this.y*c/this.Xm,this.ta,this.wa)}else this.xa.ds(this.bd,this.Ff,this.ta,this.wa)};b.Lb.prototype.b=function(){var a=new b.Lb;b.fb.prototype.b.call(this,a);a.bd=this.bd;a.Ff=this.Ff;a.ta=this.ta;a.wa=this.wa;return a};
b.Da=function(a){b.C.call(this);this.color=new b.p(a)};b.Da.prototype=Object.create(b.C.prototype);b.Da.prototype.b=function(a){void 0===a&&(a=new b.Da);b.C.prototype.b.call(this,a);a.color.copy(this.color);return a};b.te=function(a){b.Da.call(this,a)};b.te.prototype=Object.create(b.Da.prototype);b.te.prototype.b=function(){var a=new b.te;b.Da.prototype.b.call(this,a);return a};b.ml=function(a,e){b.Da.call(this,a);this.F=new b.a(0,-1,0);this.right=new b.a(1,0,0);this.na=void 0!==e?e:1;this.height=
this.width=1};b.ml.prototype=Object.create(b.Da.prototype);b.zb=function(a,e){b.Da.call(this,a);this.position.set(0,1,0);this.target=new b.C;this.na=void 0!==e?e:1;this.me=this.tb=!1;this.qh=50;this.ph=5E3;this.Zk=-500;this.al=this.$k=500;this.Yk=-500;this.oe=!1;this.oh=0;this.ef=0.5;this.rh=this.th=512;this.bl=!1;this.ot=new b.a(0,0,-1E3);this.mt=2;this.qo=[0,0,0];this.pt=[512,512,512];this.nt=[512,512,512];this.so=[-1,0.99,0.998];this.ro=[0.99,0.998,1];this.df=[];this.jg=this.Md=this.Qi=this.ig=
null};b.zb.prototype=Object.create(b.Da.prototype);b.zb.prototype.b=function(){var a=new b.zb;b.Da.prototype.b.call(this,a);a.target=this.target.b();a.na=this.na;a.tb=this.tb;a.me=this.me;return a};b.rf=function(a,e,c){b.Da.call(this,a);this.position.set(0,100,0);this.Zg=new b.p(e);this.na=void 0!==c?c:1};b.rf.prototype=Object.create(b.Da.prototype);b.rf.prototype.b=function(){var a=new b.rf;b.Da.prototype.b.call(this,a);a.Zg.copy(this.Zg);a.na=this.na;return a};b.ud=function(a,e,c){b.Da.call(this,
a);this.na=void 0!==e?e:1;this.cb=void 0!==c?c:0};b.ud.prototype=Object.create(b.Da.prototype);b.ud.prototype.b=function(){var a=new b.ud;b.Da.prototype.b.call(this,a);a.na=this.na;a.cb=this.cb;return a};b.Wc=function(a,e,c,d,f){b.Da.call(this,a);this.position.set(0,1,0);this.target=new b.C;this.na=void 0!==e?e:1;this.cb=void 0!==c?c:0;this.Je=void 0!==d?d:Math.PI/3;this.mi=void 0!==f?f:10;this.me=this.tb=!1;this.qh=50;this.ph=5E3;this.lt=50;this.oe=!1;this.oh=0;this.ef=0.5;this.rh=this.th=512;this.jg=
this.Md=this.Qi=this.ig=null};b.Wc.prototype=Object.create(b.Da.prototype);b.Wc.prototype.b=function(){var a=new b.Wc;b.Da.prototype.b.call(this,a);a.target=this.target.b();a.na=this.na;a.cb=this.cb;a.Je=this.Je;a.mi=this.mi;a.tb=this.tb;a.me=this.me;return a};b.ze=function(a){a&&b.ze.prototype.rq()};b.ze.prototype={constructor:b.ze,crossOrigin:void 0,rq:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign=
"left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},Um:function(a){a=a.split("/");a.pop();return(1>a.length?".":a.join("/"))+"/"},Mr:function(a,e){for(var c=[],d=0;d<a.length;++d)c[d]=b.ze.prototype.Wq(a[d],e);return c},ts:function(a){for(var e=0,c=a.length;e<c;e++)if(a[e]instanceof b.Wa)return!0;return!1},Wq:function(a,e){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==
a}function d(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function f(a,b){var e=new Image;e.onload=function(){if(c(this.width)&&c(this.height))a.M=this;else{var b=d(this.width),e=d(this.height);a.M.width=b;a.M.height=e;a.M.getContext("2d").drawImage(this,0,0,b,e)}a.ga=!0};void 0!==k.crossOrigin&&(e.crossOrigin=k.crossOrigin);e.src=b}function g(a,c,d,g,h,k,n){var l=/\.dds$/i.test(d),p=e+"/"+d;if(l){var y=b.sd.xn(p);a[c]=y}else y=document.createElement("canvas"),a[c]=new b.rb(y);a[c].yt=
d;g&&(a[c].repeat.set(g[0],g[1]),1!==g[0]&&(a[c].jc=b.vd),1!==g[1]&&(a[c].kc=b.vd));h&&a[c].offset.set(h[0],h[1]);k&&(d={repeat:b.vd,mirror:b.rj},void 0!==d[k[0]]&&(a[c].jc=d[k[0]]),void 0!==d[k[1]]&&(a[c].kc=d[k[1]]));n&&(a[c].Pb=n);l||f(a[c],p)}function h(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var k=this,n="MeshLambertMaterial",l={color:15658734,opacity:1,map:null,Sa:null,nb:null,Rb:null,W:!1};if(a.Ga){var p=a.Ga.toLowerCase();"phong"===p?n="MeshPhongMaterial":"basic"===p&&(n="MeshBasicMaterial")}void 0!==
a.bb&&void 0!==b[a.bb]&&(l.bb=b[a.bb]);if(void 0!==a.Ha||1>a.opacity)l.Ha=a.Ha;void 0!==a.Cd&&(l.Cd=a.Cd);void 0!==a.Dd&&(l.Dd=a.Dd);void 0!==a.visible&&(l.visible=a.visible);void 0!==a.ok&&(l.zc=b.nf);void 0!==a.kk&&(l.zc=b.we);void 0!==a.W&&(l.W=a.W);void 0!==a.u&&("face"===a.u?l.u=b.pf:a.u&&(l.u=b.De));a.Rq?l.color=h(a.Rq):a.Yo&&(l.color=a.Yo);a.Sq&&(l.Ac=h(a.Sq));a.Qq&&(l.ya=h(a.Qq));a.Nt&&(l.opacity=a.Nt);a.zt&&(l.ld=a.zt);a.hs&&e&&g(l,"map",a.hs,a.Iw,a.Hw,a.Jw,a.Gw);a.is&&e&&g(l,"lightMap",
a.is,a.Mw,a.Lw,a.Nw,a.Kw);a.fs&&e&&g(l,"bumpMap",a.fs,a.Ew,a.Dw,a.Fw,a.Cw);a.En&&e&&g(l,"normalMap",a.En,a.Rw,a.Qw,a.Sw,a.Pw);a.js&&e&&g(l,"specularMap",a.js,a.Vw,a.Uw,a.Ww,a.Tw);a.gs&&(l.Gg=a.gs);a.En?(n=b.tg.normalmap,p=b.uc.b(n.Q),p.tNormal.value=l.nb,a.Fn&&p.uNormalScale.value.set(a.Fn,a.Fn),l.map&&(p.tDiffuse.value=l.map,p.enableDiffuse.value=!0),l.Ma&&(p.tSpecular.value=l.Ma,p.enableSpecular.value=!0),l.Sa&&(p.tAO.value=l.Sa,p.enableAO.value=!0),p.diffuse.value.ob(l.color),p.specular.value.ob(l.Ac),
p.ambient.value.ob(l.ya),p.shininess.value=l.ld,void 0!==l.opacity&&(p.opacity.value=l.opacity),n=new b.Wa({P:n.P,R:n.R,Q:p,yc:!0,H:!0}),l.Ha&&(n.Ha=!0)):n=new b[n](l);void 0!==a.Zo&&(n.name=a.Zo);return n}};b.Ge=function(a){this.ec=void 0!==a?a:b.ve};b.Ge.prototype={constructor:b.Ge,load:function(a,b,c,d){var f=this,g=new XMLHttpRequest;void 0!==b&&g.addEventListener("load",function(c){b(c.target.responseText);f.ec.sn(a)},!1);void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1);void 0!==
d&&g.addEventListener("error",function(a){d(a)},!1);void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin);g.open("GET",a,!0);g.send(null);f.ec.tn()},gc:tb("crossOrigin")};b.Eh=function(a){this.ec=void 0!==a?a:b.ve};b.Eh.prototype={constructor:b.Eh,load:function(a,b,c,d){var f=this,g=document.createElement("img");void 0!==b&&g.addEventListener("load",function(){f.ec.sn(a);b(this)},!1);void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1);void 0!==d&&g.addEventListener("error",function(a){d(a)},
!1);void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin);g.src=a;f.ec.tn();return g},gc:tb("crossOrigin")};b.sf=function(a){b.ze.call(this,a);this.withCredentials=!1};b.sf.prototype=Object.create(b.ze.prototype);b.sf.prototype.load=function(a,b,c){c=c&&"string"===typeof c?c:this.Um(a);this.Yr(this,a,b,c)};b.sf.prototype.Yr=function(a,b,c,d){var f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status)if(f.responseText){var g=JSON.parse(f.responseText),
g=a.parse(g,d);c(g.j,g.Z)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]")};f.open("GET",b,!0);f.withCredentials=this.withCredentials;f.send(null)};b.sf.prototype.parse=function(a,e){var c=new b.B,d=void 0!==a.scale?1/a.scale:1;(function(e){var d,h,k,n,l,p,r,q,v,u,s,x,z,t=a.i;p=a.e;var w=a.gh,y=a.va,H=0;if(void 0!==a.jf){for(d=0;d<a.jf.length;d++)a.jf[d].length&&H++;for(d=0;d<
H;d++)c.v[d]=[]}n=0;for(l=p.length;n<l;)d=new b.a,d.x=p[n++]*e,d.y=p[n++]*e,d.z=p[n++]*e,c.e.push(d);n=0;for(l=t.length;n<l;)if(e=t[n++],v=e&1,k=e&2,d=e&8,r=e&16,u=e&32,p=e&64,e&=128,v){v=new b.N;v.I=t[n];v.g=t[n+1];v.J=t[n+3];s=new b.N;s.I=t[n+1];s.g=t[n+2];s.J=t[n+3];n+=4;k&&(k=t[n++],v.fc=k,s.fc=k);k=c.i.length;if(d)for(d=0;d<H;d++)for(x=a.jf[d],c.v[d][k]=[],c.v[d][k+1]=[],h=0;4>h;h++)q=t[n++],z=x[2*q],q=x[2*q+1],z=new b.h(z,q),2!==h&&c.v[d][k].push(z),0!==h&&c.v[d][k+1].push(z);r&&(r=3*t[n++],
v.F.set(w[r++],w[r++],w[r]),s.F.copy(v.F));if(u)for(d=0;4>d;d++)r=3*t[n++],u=new b.a(w[r++],w[r++],w[r]),2!==d&&v.V.push(u),0!==d&&s.V.push(u);p&&(p=t[n++],p=y[p],v.color.ob(p),s.color.ob(p));if(e)for(d=0;4>d;d++)p=t[n++],p=y[p],2!==d&&v.u.push(new b.p(p)),0!==d&&s.u.push(new b.p(p));c.i.push(v);c.i.push(s)}else{v=new b.N;v.I=t[n++];v.g=t[n++];v.J=t[n++];k&&(k=t[n++],v.fc=k);k=c.i.length;if(d)for(d=0;d<H;d++)for(x=a.jf[d],c.v[d][k]=[],h=0;3>h;h++)q=t[n++],z=x[2*q],q=x[2*q+1],z=new b.h(z,q),c.v[d][k].push(z);
r&&(r=3*t[n++],v.F.set(w[r++],w[r++],w[r]));if(u)for(d=0;3>d;d++)r=3*t[n++],u=new b.a(w[r++],w[r++],w[r]),v.V.push(u);p&&(p=t[n++],v.color.ob(y[p]));if(e)for(d=0;3>d;d++)p=t[n++],v.u.push(new b.p(y[p]));c.i.push(v)}})(d);(function(){var e,d,h,k;if(a.qe)for(e=0,d=a.qe.length;e<d;e+=2)h=a.qe[e],k=a.qe[e+1],c.qe.push(new b.vc(h,k,0,0));if(a.pe)for(e=0,d=a.pe.length;e<d;e+=2)h=a.pe[e],k=a.pe[e+1],c.pe.push(new b.vc(h,k,0,0));c.Qa=a.Qa;c.tq=a.tq;c.uq=a.uq})();(function(e){if(void 0!==a.A){var d,h,k,n,
l,p;d=0;for(h=a.A.length;d<h;d++)for(c.A[d]={},c.A[d].name=a.A[d].name,c.A[d].e=[],l=c.A[d].e,p=a.A[d].e,k=0,n=p.length;k<n;k+=3){var r=new b.a;r.x=p[k]*e;r.y=p[k+1]*e;r.z=p[k+2]*e;l.push(r)}}if(void 0!==a.le)for(d=0,h=a.le.length;d<h;d++)for(c.le[d]={},c.le[d].name=a.le[d].name,c.le[d].va=[],n=c.le[d].va,l=a.le[d].va,e=0,k=l.length;e<k;e+=3)p=new b.p(16755200),p.kd(l[e],l[e+1],l[e+2]),n.push(p)})(d);c.ub();c.vb();c.Kg();if(void 0===a.Z)return{j:c};d=this.Mr(a.Z,e);this.ts(d)&&c.ei();return{j:c,Z:d}};
b.ip=function(){var a=this,b=0,c=0;this.Sn=this.Rn=void 0;this.tn=function(){c++};this.sn=function(d){b++;void 0!==a.Sn&&a.Sn(d,b,c);b===c&&void 0!==a.Rn&&a.Rn()}};b.ve=new b.ip;b.aj=function(a){this.ec=void 0!==a?a:b.ve};b.aj.prototype={constructor:b.aj,load:function(a,e){var c=this,d=new b.Ge;d.gc(this.crossOrigin);d.load(a,function(a){e(c.parse(JSON.parse(a)))})},gc:tb("crossOrigin"),parse:function(a){var e=new b.qb,c=a.attributes,d=a.Kd;a=a.ib;for(var f in c){var g=c[f];e.attributes[f]={fd:g.fd,
c:new self[g.type](g.c)}}void 0!==d&&(e.Kd=JSON.parse(JSON.stringify(d)));void 0!==a&&(e.ib=new b.tc((new b.a).aa(void 0!==a.ua?a.ua:[0,0,0]),a.K));return e}};b.zl=function(a){this.ec=void 0!==a?a:b.ve};b.zl.prototype={constructor:b.zl,load:function(a,e){var c=this,d=new b.Ge;d.gc(this.crossOrigin);d.load(a,function(a){e(c.parse(JSON.parse(a)))})},gc:tb("crossOrigin"),parse:la()};b.qj=function(a){this.ec=void 0!==a?a:b.ve};b.qj.prototype={constructor:b.qj,load:function(a,e){var c=this,d=new b.Ge;
d.gc(this.crossOrigin);d.load(a,function(a){e(c.parse(JSON.parse(a)))})},gc:tb("crossOrigin"),parse:function(a){var e=new b[a.type];void 0!==a.color&&e.color.ob(a.color);void 0!==a.ya&&e.ya.ob(a.ya);void 0!==a.kb&&e.kb.ob(a.kb);void 0!==a.Ac&&e.Ac.ob(a.Ac);void 0!==a.ld&&(e.ld=a.ld);void 0!==a.u&&(e.u=a.u);void 0!==a.bb&&(e.bb=a.bb);void 0!==a.zc&&(e.zc=a.zc);void 0!==a.opacity&&(e.opacity=a.opacity);void 0!==a.Ha&&(e.Ha=a.Ha);void 0!==a.W&&(e.W=a.W);if(void 0!==a.Z)for(var c=0,d=a.Z.length;c<d;c++)e.Z.push(this.parse(a.Z[c]));
return e}};b.Fl=function(a){this.ec=void 0!==a?a:b.ve};b.Fl.prototype={constructor:b.Fl,load:function(a,e){var c=this,d=new b.Ge(c.ec);d.gc(this.crossOrigin);d.load(a,function(a){e(c.parse(JSON.parse(a)))})},gc:tb("crossOrigin"),parse:function(a){var b=this.Hs(a.Ra),c=this.Is(a.Z);return this.Wn(a.object,b,c)},Hs:function(a){var e={};if(void 0!==a)for(var c=new b.sf,d=new b.aj,f=0,g=a.length;f<g;f++){var h,k=a[f];switch(k.type){case "PlaneGeometry":h=new b.Jh(k.width,k.height,k.Pc,k.dc);break;case "CircleGeometry":h=
new b.ql(k.K,k.jd);break;case "CubeGeometry":h=new b.Ch(k.width,k.height,k.depth,k.Pc,k.dc,k.ii);break;case "CylinderGeometry":h=new b.mg(k.Rs,k.Qs,k.height,k.qa,k.dc,k.Fs);break;case "SphereGeometry":h=new b.ug(k.K,k.Pc,k.dc,k.Ls,k.Ks,k.Eo,k.Do);break;case "IcosahedronGeometry":h=new b.hj(k.K,k.detail);break;case "TorusGeometry":h=new b.xj(k.K,k.Nd,k.qa,k.Va,k.arc);break;case "TorusKnotGeometry":h=new b.$l(k.K,k.Nd,k.qa,k.Va,k.Gi,k.Mk,k.vk);break;case "BufferGeometry":h=d.parse(k.data);break;case "Geometry":h=
c.parse(k.data).j}h.Cc=k.Cc;void 0!==k.name&&(h.name=k.name);e[k.Cc]=h}return e},Is:function(a){var e={};if(void 0!==a)for(var c=new b.qj,d=0,f=a.length;d<f;d++){var g=a[d],h=c.parse(g);h.Cc=g.Cc;void 0!==g.name&&(h.name=g.name);e[g.Cc]=h}return e},Wn:function(){var a=new b.$;return function(e,c,d){var f;switch(e.type){case "Scene":f=new b.wd;break;case "PerspectiveCamera":f=new b.Lb(e.bd,e.Ff,e.ta,e.wa);break;case "OrthographicCamera":f=new b.Rd(e.left,e.right,e.top,e.bottom,e.ta,e.wa);break;case "AmbientLight":f=
new b.te(e.color);break;case "DirectionalLight":f=new b.zb(e.color,e.na);break;case "PointLight":f=new b.ud(e.color,e.na,e.cb);break;case "SpotLight":f=new b.Wc(e.color,e.na,e.cb,e.Je,e.mi);break;case "HemisphereLight":f=new b.rf(e.color,e.Zg,e.na);break;case "Mesh":f=c[e.j];var g=d[e.D];void 0===f&&console.error("THREE.ObjectLoader: Undefined geometry "+e.j);void 0===g&&console.error("THREE.ObjectLoader: Undefined material "+e.D);f=new b.U(f,g);break;case "Sprite":g=d[e.D];void 0===g&&console.error("THREE.ObjectLoader: Undefined material "+
e.D);f=new b.xd(g);break;default:f=new b.C}f.Cc=e.Cc;void 0!==e.name&&(f.name=e.name);void 0!==e.ra?(a.aa(e.ra),a.gi(f.position,f.Ca,f.scale)):(void 0!==e.position&&f.position.aa(e.position),void 0!==e.rotation&&f.rotation.aa(e.rotation),void 0!==e.scale&&f.scale.aa(e.scale));void 0!==e.visible&&(f.visible=e.visible);void 0!==e.pd&&(f.pd=e.pd);if(void 0!==e.children)for(var h in e.children)f.add(this.Wn(e.children[h],c,d));return f}}()};b.Ul=function(){this.ge={};this.Vf={};this.oq("ascii",b.sf)};
b.Ul.prototype={constructor:b.Ul,load:function(a,e){var c=this,d=new b.Ge(c.ec);d.gc(this.crossOrigin);d.load(a,function(b){c.parse(JSON.parse(b),e,a)})},gc:tb("crossOrigin"),oq:function(a,b){this.ge[a]={loaderClass:b}},parse:function(a,e,c){function d(a){return function(){Q-=a;r()}}function f(a,b){return"relativeToHTML"==b?a:u+"/"+a}function g(){h(C.Nc,I.Ba)}function h(a,c){var e,d,g,k,n,p;for(p in c){var r=C.Ba[p],q=c[p];if(void 0===r){if(q.type&&q.type in v.Vf){if(void 0===q.bs){e={type:1,url:1,
material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};var t={},u;for(u in q)u in e||(t[u]=q[u]);x=C.Z[q.D];q.bs=!0;e=v.Vf[q.type].loaderObject;e.options?e.load(f(q.url,I.Vi),l(p,a,x,q)):e.load(f(q.url,I.Vi),l(p,a,x,q),t)}}else if(void 0!==q.j){if(s=C.Ra[q.j]){r=!1;x=C.Z[q.D];r=x instanceof b.Wa;d=q.position;g=q.rotation;k=q.scale;e=q.ra;n=q.Ca;q.D||(x=new b.qc(C.ni[q.j]));x instanceof b.qc&&0===x.Z.length&&(x=new b.qc(C.ni[q.j]));if(x instanceof
b.qc)for(t=0;t<x.Z.length;t++)r=r||x.Z[t]instanceof b.Wa;r&&s.ei();q.ut?r=new b.sc(s,x):q.kx?(r=new b.rg(s,x),void 0!==q.duration&&(r.duration=q.duration),void 0!==q.time&&(r.time=q.time),void 0!==q.Ve&&(r.Ve=q.Ve),x.pa&&s.Tq()):r=new b.U(s,x);r.name=p;e?(r.sa=!1,r.ra.set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])):(r.position.aa(d),n?r.Ca.aa(n):r.rotation.aa(g),r.scale.aa(k));r.visible=q.visible;r.tb=q.tb;r.cg=q.cg;a.add(r);C.Ba[p]=r}}else if("AmbientLight"===
q.type||"PointLight"===q.type||"DirectionalLight"===q.type||"SpotLight"===q.type||"HemisphereLight"===q.type||"AreaLight"===q.type){t=q.color;e=q.na;d=q.cb;g=q.position;k=q.rotation;switch(q.type){case "AmbientLight":H=new b.te(t);break;case "PointLight":H=new b.ud(t,e,d);H.position.aa(g);break;case "DirectionalLight":H=new b.zb(t,e);H.position.aa(q.direction);break;case "SpotLight":H=new b.Wc(t,e,d,1);H.Je=q.Je;H.position.aa(g);H.target.set(g[0],g[1]-d,g[2]);H.target.Dm(new b.nc(k[0],k[1],k[2],"XYZ"));
break;case "HemisphereLight":H=new b.zb(t,e);H.target.set(g[0],g[1]-d,g[2]);H.target.Dm(new b.nc(k[0],k[1],k[2],"XYZ"));break;case "AreaLight":H=new b.ml(t,e),H.position.aa(g),H.width=q.size,H.height=q.dy}a.add(H);H.name=p;C.yc[p]=H;C.Ba[p]=H}else"PerspectiveCamera"===q.type||"OrthographicCamera"===q.type?(d=q.position,g=q.rotation,n=q.Ca,"PerspectiveCamera"===q.type?z=new b.Lb(q.bd,q.Ff,q.ta,q.wa):"OrthographicCamera"===q.type&&(z=new b.Rd(q.left,q.right,q.top,q.bottom,q.ta,q.wa)),z.name=p,z.position.aa(d),
void 0!==n?z.Ca.aa(n):void 0!==g&&z.rotation.aa(g),a.add(z),C.ak[p]=z,C.Ba[p]=z):(d=q.position,g=q.rotation,k=q.scale,n=q.Ca,r=new b.C,r.name=p,r.position.aa(d),n?r.Ca.aa(n):r.rotation.aa(g),r.scale.aa(k),r.visible=void 0!==q.visible?q.visible:!1,a.add(r),C.Ba[p]=r,C.fr[p]=r);if(r){if(void 0!==q.pd)for(var w in q.pd)r.pd[w]=q.pd[w];if(void 0!==q.Tf)for(t=0;t<q.Tf.length;t++)e=q.Tf[t],void 0===C.Tf[e]&&(C.Tf[e]=[]),C.Tf[e].push(p)}}void 0!==r&&void 0!==q.children&&h(r,q.children)}}function k(a,b,c,
e,d){var f=d.rotation,h=d.Ca,k=d.scale;a.position.aa(d.position);h?a.Ca.aa(h):a.rotation.aa(f);a.scale.aa(k);e&&a.Ui(function(a){a.D=e});var n=void 0!==d.visible?d.visible:!0;a.Ui(function(a){a.visible=n});c.add(a);a.name=b;C.Ba[b]=a;g()}function n(a){return function(b,c){b.name=a;C.Ra[a]=b;C.ni[a]=c;g();N-=1;r()}}function l(a,b,c,e){return function(d){k(d.content?d.content:d.kv?d.Nc:d,a,b,c,e);N-=1;r()}}function p(a){return function(b,c){b.name=a;C.Ra[a]=b;C.ni[a]=c}}function r(){if(0===N&&0===Q){for(var a=
0;a<M.length;a++){var c=M[a],d=C.Ba[c.By];d?c.object.target=d:(c.object.target=new b.C,C.Nc.add(c.object.target));c.object.target.pd.Ay=c.object}e(C)}}function q(a,b){b(a);if(void 0!==a.children)for(var c in a.children)q(a.children[c],b)}var v=this,u=b.ze.prototype.Um(c),s,x,z,t,w,y,H,N,Q,C,M=[],I=a;for(y in this.ge)a=this.ge[y].loaderClass,this.ge[y].loaderObject=new a;for(y in this.Vf)a=this.Vf[y].loaderClass,this.Vf[y].loaderObject=new a;Q=N=0;C={Nc:new b.wd,Ra:{},ni:{},Z:{},Ib:{},Ba:{},ak:{},
yc:{},Tg:{},fr:{},Tf:{}};I.transform&&(y=I.transform.position,a=I.transform.rotation,c=I.transform.scale,y&&C.Nc.position.aa(y),a&&C.Nc.rotation.aa(a),c&&C.Nc.scale.aa(c),y||a||c)&&(C.Nc.Bc(),C.Nc.Fa());for(var D in I.Tg)y=I.Tg[D],"linear"===y.type?t=new b.pg(0,y.ta,y.wa):"exp2"===y.type&&(t=new b.qf(0,y.hi)),y=y.color,t.color.kd(y[0],y[1],y[2]),C.Tg[D]=t;for(var K in I.Ra)t=I.Ra[K],t.type in this.ge&&(N+=1);for(var F in I.Ba)q(I.Ba[F],function(a){a.type&&a.type in v.Vf&&(N+=1)});for(K in I.Ra)if(t=
I.Ra[K],"cube"===t.type)s=new b.Ch(t.width,t.height,t.depth,t.Pc,t.dc,t.ii),s.name=K,C.Ra[K]=s;else if("plane"===t.type)s=new b.Jh(t.width,t.height,t.Pc,t.dc),s.name=K,C.Ra[K]=s;else if("sphere"===t.type)s=new b.ug(t.K,t.Pc,t.dc),s.name=K,C.Ra[K]=s;else if("cylinder"===t.type)s=new b.mg(t.Fy,t.Su,t.height,t.Fx,t.Vv),s.name=K,C.Ra[K]=s;else if("torus"===t.type)s=new b.xj(t.K,t.Nd,t.Vx,t.Wx),s.name=K,C.Ra[K]=s;else if("icosahedron"===t.type)s=new b.hj(t.K,t.uy),s.name=K,C.Ra[K]=s;else if(t.type in this.ge){F=
{};for(w in t)"type"!==w&&"url"!==w&&(F[w]=t[w]);this.ge[t.type].loaderObject.load(f(t.url,I.Vi),n(K),F)}else"embedded"===t.type&&(F=I.embeds[t.id],F.ms=I.ms,F&&(F=this.ge.ascii.loaderObject.parse(F,""),p(K)(F.j,F.Z)));for(var A in I.Ib)if(K=I.Ib[A],K.url instanceof Array)for(Q+=K.url.length,w=0;w<K.url.length;w++);else Q+=1;for(A in I.Ib){K=I.Ib[A];void 0!==K.lb&&void 0!==b[K.lb]&&(K.lb=new b[K.lb]);if(K.url instanceof Array){F=K.url.length;t=[];for(w=0;w<F;w++)t[w]=f(K.url[w],I.Vi);w=(w=/\.dds$/i.test(t[0]))?
b.sd.Zr(t,K.lb,d(F)):b.sd.as(t,K.lb,d(F))}else w=/\.dds$/i.test(K.url),F=f(K.url,I.Vi),t=d(1),w=w?b.sd.xn(F,K.lb,t):b.sd.$r(F,K.lb,t),void 0!==b[K.mb]&&(w.mb=b[K.mb]),void 0!==b[K.Gb]&&(w.Gb=b[K.Gb]),K.Pb&&(w.Pb=K.Pb),K.repeat&&(w.repeat.set(K.repeat[0],K.repeat[1]),1!==K.repeat[0]&&(w.jc=b.vd),1!==K.repeat[1]&&(w.kc=b.vd)),K.offset&&w.offset.set(K.offset[0],K.offset[1]),K.zh&&(F={repeat:b.vd,mirror:b.rj},void 0!==F[K.zh[0]]&&(w.jc=F[K.zh[0]]),void 0!==F[K.zh[1]]&&(w.kc=F[K.zh[1]]));C.Ib[A]=w}var J,
E;for(J in I.Z){A=I.Z[J];for(E in A.G)"envMap"===E||"map"===E||"lightMap"===E||"bumpMap"===E?A.G[E]=C.Ib[A.G[E]]:"shading"===E?A.G[E]="flat"===A.G[E]?b.og:b.Vc:"side"===E?A.G[E]="double"==A.G[E]?b.we:"back"==A.G[E]?b.nf:b.fj:"blending"===E?A.G[E]=A.G[E]in b?b[A.G[E]]:b.Ih:"combine"===E?A.G[E]=A.G[E]in b?b[A.G[E]]:b.Hh:"vertexColors"===E?"face"==A.G[E]?A.G[E]=b.pf:A.G[E]&&(A.G[E]=b.De):"wrapRGB"===E&&(K=A.G[E],A.G[E]=new b.a(K[0],K[1],K[2]));void 0!==A.G.opacity&&1>A.G.opacity&&(A.G.Ha=!0);A.G.nb?
(K=b.tg.normalmap,w=b.uc.b(K.Q),F=A.G.color,t=A.G.Ac,D=A.G.ya,y=A.G.ld,w.tNormal.value=C.Ib[A.G.nb],A.G.Ye&&w.uNormalScale.value.set(A.G.Ye[0],A.G.Ye[1]),A.G.map&&(w.tDiffuse.value=A.G.map,w.enableDiffuse.value=!0),A.G.Aa&&(w.tCube.value=A.G.Aa,w.enableReflection.value=!0,w.reflectivity.value=A.G.Mc),A.G.Sa&&(w.tAO.value=A.G.Sa,w.enableAO.value=!0),A.G.Ma&&(w.tSpecular.value=C.Ib[A.G.Ma],w.enableSpecular.value=!0),A.G.cr&&(w.tDisplacement.value=C.Ib[A.G.cr],w.enableDisplacement.value=!0,w.uDisplacementBias.value=
A.G.sv,w.uDisplacementScale.value=A.G.tv),w.diffuse.value.ob(F),w.specular.value.ob(t),w.ambient.value.ob(D),w.shininess.value=y,A.G.opacity&&(w.opacity.value=A.G.opacity),x=new b.Wa({P:K.P,R:K.R,Q:w,yc:!0,H:!0})):x=new b[A.type](A.G);x.name=J;C.Z[J]=x}for(J in I.Z)if(A=I.Z[J],A.G.Z){E=[];for(w=0;w<A.G.Z.length;w++)E.push(C.Z[A.G.Z[w]]);C.Z[J].Z=E}g();C.ak&&I.Pg.$j&&(C.jv=C.ak[I.Pg.$j]);C.Tg&&I.Pg.H&&(C.Nc.H=C.Tg[I.Pg.H]);r()}};b.Zl=function(a){this.ec=void 0!==a?a:b.ve};b.Zl.prototype={constructor:b.Zl,
load:function(a,e){var c=new b.Eh(this.ec);c.gc(this.crossOrigin);c.load(a,function(a){a=new b.rb(a);a.ga=!0;void 0!==e&&e(a)})},gc:tb("crossOrigin")};b.S=function(){this.id=b.lp++;this.Cc=b.Jb.Vg();this.name="";this.zc=b.fj;this.opacity=1;this.Ha=!1;this.bb=b.Ih;this.Oe=b.Xl;this.Ne=b.Gl;this.blendEquation=b.kl;this.Dd=this.Cd=!0;this.polygonOffset=!1;this.Zf=this.Ie=this.mh=this.lh=0;this.ga=this.visible=!0};b.S.prototype={constructor:b.S,Oc:function(a){if(void 0!==a)for(var e in a){var c=a[e];
if(void 0===c)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else if(e in this){var d=this[e];d instanceof b.p?d.set(c):d instanceof b.a&&c instanceof b.a?d.copy(c):this[e]="overdraw"==e?Number(c):c}}},b:function(a){void 0===a&&(a=new b.S);a.name=this.name;a.zc=this.zc;a.opacity=this.opacity;a.Ha=this.Ha;a.bb=this.bb;a.Oe=this.Oe;a.Ne=this.Ne;a.blendEquation=this.blendEquation;a.Cd=this.Cd;a.Dd=this.Dd;a.polygonOffset=this.polygonOffset;a.lh=this.lh;a.mh=this.mh;a.Ie=this.Ie;a.Zf=
this.Zf;a.visible=this.visible;return a}};b.oc.prototype.apply(b.S.prototype);b.lp=0;b.ab=function(a){b.S.call(this);this.color=new b.p(16777215);this.Eb=1;this.Ai=this.zi="round";this.u=!1;this.H=!0;this.Oc(a)};b.ab.prototype=Object.create(b.S.prototype);b.ab.prototype.b=function(){var a=new b.ab;b.S.prototype.b.call(this,a);a.color.copy(this.color);a.Eb=this.Eb;a.zi=this.zi;a.Ai=this.Ai;a.u=this.u;a.H=this.H;return a};b.uf=function(a){b.S.call(this);this.color=new b.p(16777215);this.scale=this.Eb=
1;this.Lf=3;this.oi=1;this.u=!1;this.H=!0;this.Oc(a)};b.uf.prototype=Object.create(b.S.prototype);b.uf.prototype.b=function(){var a=new b.uf;b.S.prototype.b.call(this,a);a.color.copy(this.color);a.Eb=this.Eb;a.scale=this.scale;a.Lf=this.Lf;a.oi=this.oi;a.u=this.u;a.H=this.H;return a};b.Kb=function(a){b.S.call(this);this.color=new b.p(16777215);this.Aa=this.Ma=this.Sa=this.map=null;this.Zc=b.Hh;this.Mc=1;this.hd=0.98;this.H=!0;this.Ga=b.Vc;this.W=!1;this.Na=1;this.Rc=this.Qc="round";this.u=b.sg;this.A=
this.Ea=!1;this.Oc(a)};b.Kb.prototype=Object.create(b.S.prototype);b.Kb.prototype.b=function(){var a=new b.Kb;b.S.prototype.b.call(this,a);a.color.copy(this.color);a.map=this.map;a.Sa=this.Sa;a.Ma=this.Ma;a.Aa=this.Aa;a.Zc=this.Zc;a.Mc=this.Mc;a.hd=this.hd;a.H=this.H;a.Ga=this.Ga;a.W=this.W;a.Na=this.Na;a.Qc=this.Qc;a.Rc=this.Rc;a.u=this.u;a.Ea=this.Ea;a.A=this.A;return a};b.Uc=function(a){b.S.call(this);this.color=new b.p(16777215);this.ya=new b.p(16777215);this.kb=new b.p(0);this.Sc=!1;this.Pd=
new b.a(1,1,1);this.Aa=this.Ma=this.Sa=this.map=null;this.Zc=b.Hh;this.Mc=1;this.hd=0.98;this.H=!0;this.Ga=b.Vc;this.W=!1;this.Na=1;this.Rc=this.Qc="round";this.u=b.sg;this.pa=this.A=this.Ea=!1;this.Oc(a)};b.Uc.prototype=Object.create(b.S.prototype);b.Uc.prototype.b=function(){var a=new b.Uc;b.S.prototype.b.call(this,a);a.color.copy(this.color);a.ya.copy(this.ya);a.kb.copy(this.kb);a.Sc=this.Sc;a.Pd.copy(this.Pd);a.map=this.map;a.Sa=this.Sa;a.Ma=this.Ma;a.Aa=this.Aa;a.Zc=this.Zc;a.Mc=this.Mc;a.hd=
this.hd;a.H=this.H;a.Ga=this.Ga;a.W=this.W;a.Na=this.Na;a.Qc=this.Qc;a.Rc=this.Rc;a.u=this.u;a.Ea=this.Ea;a.A=this.A;a.pa=this.pa;return a};b.Ec=function(a){b.S.call(this);this.color=new b.p(16777215);this.ya=new b.p(16777215);this.kb=new b.p(0);this.Ac=new b.p(1118481);this.ld=30;this.eh=!1;this.$f=!0;this.Sc=!1;this.Pd=new b.a(1,1,1);this.Rb=this.Sa=this.map=null;this.Gg=1;this.nb=null;this.Ye=new b.h(1,1);this.Aa=this.Ma=null;this.Zc=b.Hh;this.Mc=1;this.hd=0.98;this.H=!0;this.Ga=b.Vc;this.W=!1;
this.Na=1;this.Rc=this.Qc="round";this.u=b.sg;this.pa=this.A=this.Ea=!1;this.Oc(a)};b.Ec.prototype=Object.create(b.S.prototype);b.Ec.prototype.b=function(){var a=new b.Ec;b.S.prototype.b.call(this,a);a.color.copy(this.color);a.ya.copy(this.ya);a.kb.copy(this.kb);a.Ac.copy(this.Ac);a.ld=this.ld;a.eh=this.eh;a.$f=this.$f;a.Sc=this.Sc;a.Pd.copy(this.Pd);a.map=this.map;a.Sa=this.Sa;a.Rb=this.Rb;a.Gg=this.Gg;a.nb=this.nb;a.Ye.copy(this.Ye);a.Ma=this.Ma;a.Aa=this.Aa;a.Zc=this.Zc;a.Mc=this.Mc;a.hd=this.hd;
a.H=this.H;a.Ga=this.Ga;a.W=this.W;a.Na=this.Na;a.Qc=this.Qc;a.Rc=this.Rc;a.u=this.u;a.Ea=this.Ea;a.A=this.A;a.pa=this.pa;return a};b.Ae=function(a){b.S.call(this);this.W=!1;this.Na=1;this.Oc(a)};b.Ae.prototype=Object.create(b.S.prototype);b.Ae.prototype.b=function(){var a=new b.Ae;b.S.prototype.b.call(this,a);a.W=this.W;a.Na=this.Na;return a};b.vf=function(a){b.S.call(this);this.Ga=b.og;this.W=!1;this.Na=1;this.A=!1;this.Oc(a)};b.vf.prototype=Object.create(b.S.prototype);b.vf.prototype.b=function(){var a=
new b.vf;b.S.prototype.b.call(this,a);a.Ga=this.Ga;a.W=this.W;a.Na=this.Na;return a};b.qc=function(a){this.Z=a instanceof Array?a:[]};b.qc.prototype.b=function(){for(var a=new b.qc,e=0;e<this.Z.length;e++)a.Z.push(this.Z[e].b());return a};b.Sd=function(a){b.S.call(this);this.color=new b.p(16777215);this.map=null;this.size=1;this.vh=!0;this.u=!1;this.H=!0;this.Oc(a)};b.Sd.prototype=Object.create(b.S.prototype);b.Sd.prototype.b=function(){var a=new b.Sd;b.S.prototype.b.call(this,a);a.color.copy(this.color);
a.map=this.map;a.size=this.size;a.vh=this.vh;a.u=this.u;a.H=this.H;return a};b.wu=b.Sd;b.Wa=function(a){b.S.call(this);this.R=this.P="void main() {}";this.Q={};this.hk={};this.attributes=null;this.Ga=b.Vc;this.Eb=1;this.W=!1;this.Na=1;this.yc=this.H=!1;this.u=b.sg;this.pa=this.A=this.Ea=!1;this.ja={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.Kr="position";this.Oc(a)};b.Wa.prototype=Object.create(b.S.prototype);b.Wa.prototype.b=function(){var a=new b.Wa;b.S.prototype.b.call(this,a);a.P=this.P;a.R=this.R;
a.Q=b.uc.b(this.Q);a.attributes=this.attributes;a.hk=this.hk;a.Ga=this.Ga;a.W=this.W;a.Na=this.Na;a.H=this.H;a.yc=this.yc;a.u=this.u;a.Ea=this.Ea;a.A=this.A;a.pa=this.pa;return a};b.wg=function(a){b.S.call(this);this.color=new b.p(16777215);this.map=null;this.rotation=0;this.H=!1;this.Oc(a)};b.wg.prototype=Object.create(b.S.prototype);b.wg.prototype.b=function(){var a=new b.wg;b.S.prototype.b.call(this,a);a.color.copy(this.color);a.map=this.map;a.rotation=this.rotation;a.H=this.H;return a};b.vg=function(a){b.S.call(this);
this.color=new b.p(16777215);this.xb=la();this.Oc(a)};b.vg.prototype=Object.create(b.S.prototype);b.vg.prototype.b=function(){var a=new b.vg;b.S.prototype.b.call(this,a);a.color.copy(this.color);a.xb=this.xb;return a};b.xu=b.vg;b.rb=function(a,e,c,d,f,g,h,k,n){this.id=b.Gp++;this.Cc=b.Jb.Vg();this.name="";this.M=a;this.Ka=[];this.lb=void 0!==e?e:new b.am;this.jc=void 0!==c?c:b.lg;this.kc=void 0!==d?d:b.lg;this.Gb=void 0!==f?f:b.ye;this.mb=void 0!==g?g:b.oj;this.Pb=void 0!==n?n:1;this.ba=void 0!==
h?h:b.Td;this.type=void 0!==k?k:b.zj;this.offset=new b.h(0,0);this.repeat=new b.h(1,1);this.Db=!0;this.Kk=!1;this.fe=!0;this.il=4;this.um=!1;this.Di=null};b.rb.prototype={constructor:b.rb,get ga(){return this.um},set ga(a){!0===a&&this.update();this.um=a},b:function(a){void 0===a&&(a=new b.rb);a.M=this.M;a.Ka=this.Ka.slice(0);a.lb=this.lb;a.jc=this.jc;a.kc=this.kc;a.Gb=this.Gb;a.mb=this.mb;a.Pb=this.Pb;a.ba=this.ba;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.Db=this.Db;
a.Kk=this.Kk;a.fe=this.fe;a.il=this.il;return a},update:function(){this.dispatchEvent({type:"update"})}};b.oc.prototype.apply(b.rb.prototype);b.Gp=0;b.Qd=function(a,e,c,d,f,g,h,k,n,l,p){b.rb.call(this,null,g,h,k,n,l,d,f,p);this.M={width:e,height:c};this.Ka=a;this.Db=!1};b.Qd.prototype=Object.create(b.rb.prototype);b.Qd.prototype.b=function(){var a=new b.Qd;b.rb.prototype.b.call(this,a);return a};b.ue=function(a,e,c,d,f,g,h,k,n,l,p){b.rb.call(this,null,g,h,k,n,l,d,f,p);this.M={data:a,width:e,height:c}};
b.ue.prototype=Object.create(b.rb.prototype);b.ue.prototype.b=function(){var a=new b.ue;b.rb.prototype.b.call(this,a);return a};b.Sb=function(a,e){b.C.call(this);this.j=void 0!==a?a:new b.B;this.D=void 0!==e?e:new b.Sd({color:16777215*Math.random()});this.Re=this.gf=!1};b.Sb.prototype=Object.create(b.C.prototype);b.Sb.prototype.b=function(a){void 0===a&&(a=new b.Sb(this.j,this.D));a.gf=this.gf;b.C.prototype.b.call(this,a);return a};b.fa=function(a,e,c){b.C.call(this);this.j=void 0!==a?a:new b.B;this.D=
void 0!==e?e:new b.ab({color:16777215*Math.random()});this.type=void 0!==c?c:b.nj};b.nj=0;b.Tc=1;b.fa.prototype=Object.create(b.C.prototype);b.fa.prototype.b=function(a){void 0===a&&(a=new b.fa(this.j,this.D,this.type));b.C.prototype.b.call(this,a);return a};b.U=function(a,e){b.C.call(this);this.j=void 0!==a?a:new b.B;this.D=void 0!==e?e:new b.Kb({color:16777215*Math.random()});this.Rt()};b.U.prototype=Object.create(b.C.prototype);b.U.prototype.Rt=function(){if(0<this.j.A.length){this.Dk=-1;this.Ln=
[];this.Kc=[];this.ps={};for(var a=0,b=this.j.A.length;a<b;a++)this.Kc.push(0),this.ps[this.j.A[a].name]=a}};b.U.prototype.b=function(a){void 0===a&&(a=new b.U(this.j,this.D));b.C.prototype.b.call(this,a);return a};b.qd=function(a){b.C.call(this);this.ut=a;this.md=new b.$};b.qd.prototype=Object.create(b.C.prototype);b.qd.prototype.update=function(a,b){this.sa&&(b|=this.Bc());if(b||this.eb)a?this.md.La(a,this.ra):this.md.copy(this.ra),this.eb=!1,b=!0;var c,d=this.children.length;for(c=0;c<d;c++)this.children[c].update(this.md,
b)};b.sc=function(a,e,c){b.U.call(this,a,e);this.Od=void 0!==c?c:!0;this.Jr=new b.$;this.Qa=[];this.Dg=[];var d,f,g;if(this.j&&void 0!==this.j.Qa){for(a=0;a<this.j.Qa.length;a++)c=this.j.Qa[a],d=c.Bx,f=c.Sx,g=c.Ux,e=this.mq(),e.name=c.name,e.position.set(d[0],d[1],d[2]),e.Ca.set(f[0],f[1],f[2],f[3]),void 0!==g?e.scale.set(g[0],g[1],g[2]):e.scale.set(1,1,1);for(a=0;a<this.Qa.length;a++)c=this.j.Qa[a],e=this.Qa[a],-1===c.parent?this.add(e):this.Qa[c.parent].add(e);a=this.Qa.length;this.Od?(this.Eg=
this.Fg=a=256<a?64:64<a?32:16<a?16:8,this.Dg=new Float32Array(4*this.Fg*this.Eg),this.Yd=new b.ue(this.Dg,this.Fg,this.Eg,b.Td,b.ej),this.Yd.mb=b.wf,this.Yd.Gb=b.wf,this.Yd.Db=!1,this.Yd.fe=!1):this.Dg=new Float32Array(16*a);this.Ns()}};b.sc.prototype=Object.create(b.U.prototype);b.sc.prototype.mq=function(){var a;void 0===a&&(a=new b.qd(this));this.Qa.push(a);return a};b.sc.prototype.Fa=function(){var a=new b.$;return function(e){this.sa&&this.Bc();if(this.eb||e)this.parent?this.l.La(this.parent.l,
this.ra):this.l.copy(this.ra),this.eb=!1;e=0;for(var c=this.children.length;e<c;e++){var d=this.children[e];d instanceof b.qd?d.update(this.Jr,!1):d.Fa(!0)}if(void 0==this.Wj)for(this.Wj=[],e=0,c=this.Qa.length;e<c;e++)d=new b.$,d.Fd(this.Qa[e].md),this.Wj.push(d);e=0;for(c=this.Qa.length;e<c;e++)a.La(this.Qa[e].md,this.Wj[e]),a.Wm(this.Dg,16*e);this.Od&&(this.Yd.ga=!0)}}();b.sc.prototype.Ns=function(){this.Fa(!0);this.xs()};b.sc.prototype.xs=function(){if(this.j instanceof b.B)for(var a=0;a<this.j.pe.length;a++){var e=
this.j.qe[a],c=1/e.vn();Infinity!==c?e.q(c):e.set(1)}};b.sc.prototype.b=function(a){void 0===a&&(a=new b.sc(this.j,this.D,this.Od));b.U.prototype.b.call(this,a);return a};b.rg=function(a,e){b.U.call(this,a,e);this.duration=1E3;this.Ve=!1;this.Km=this.un=this.time=0;this.direction=1;this.Nf=!1;this.bt(this.j.A.length-1)};b.rg.prototype=Object.create(b.U.prototype);b.rg.prototype.bt=function(a){this.Bt=0;this.gr=a;this.length=this.gr-this.Bt+1};b.rg.prototype.b=function(a){void 0===a&&(a=new b.rg(this.j,
this.D));a.duration=this.duration;a.Ve=this.Ve;a.time=this.time;a.un=this.un;a.Km=this.Km;a.direction=this.direction;a.Nf=this.Nf;b.U.prototype.b.call(this,a);return a};b.lj=function(){b.C.call(this);this.Ba=[]};b.lj.prototype=Object.create(b.C.prototype);b.lj.prototype.update=function(){var a=new b.a,e=new b.a;return function(b){if(1<this.Ba.length){a.Ua(b.l);e.Ua(this.l);b=a.Ed(e);this.Ba[0].object.visible=!0;for(var d=1,f=this.Ba.length;d<f;d++)if(b>=this.Ba[d].cb)this.Ba[d-1].object.visible=!1,
this.Ba[d].object.visible=!0;else break;for(;d<f;d++)this.Ba[d].object.visible=!1}}}();b.lj.prototype.b=la();b.xd=function(a){b.C.call(this);this.D=void 0!==a?a:new b.wg};b.xd.prototype=Object.create(b.C.prototype);b.xd.prototype.Bc=function(){this.ra.di(this.position,this.Ca,this.scale);this.eb=!0};b.xd.prototype.b=function(a){void 0===a&&(a=new b.xd(this.D));b.C.prototype.b.call(this,a);return a};b.vu=b.xd;b.wd=function(){b.C.call(this);this.kh=this.H=null;this.Gf=!0;this.sa=!1;this.Ub=[];this.zf=
[];this.Af=[]};b.wd.prototype=Object.create(b.C.prototype);b.wd.prototype.em=function(a){if(a instanceof b.Da)-1===this.Ub.indexOf(a)&&this.Ub.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof b.fb||a instanceof b.qd)){this.zf.push(a);var e=this.Af.indexOf(a);-1!==e&&this.Af.splice(e,1)}this.dispatchEvent({type:"objectAdded",object:a});a.dispatchEvent({type:"addedToScene",Nc:this});for(e=0;e<a.children.length;e++)this.em(a.children[e])};b.wd.prototype.Bj=function(a){if(a instanceof
b.Da){var e=this.Ub.indexOf(a);-1!==e&&this.Ub.splice(e,1);if(a.df)for(e=0;e<a.df.length;e++)this.Bj(a.df[e])}else a instanceof b.fb||(this.Af.push(a),e=this.zf.indexOf(a),-1!==e&&this.zf.splice(e,1));this.dispatchEvent({type:"objectRemoved",object:a});a.dispatchEvent({type:"removedFromScene",Nc:this});for(e=0;e<a.children.length;e++)this.Bj(a.children[e])};b.wd.prototype.b=function(a){void 0===a&&(a=new b.wd);b.C.prototype.b.call(this,a);null!==this.H&&(a.H=this.H.b());null!==this.kh&&(a.kh=this.kh.b());
a.Gf=this.Gf;a.sa=this.sa;return a};b.pg=function(a,e,c){this.name="";this.color=new b.p(a);this.ta=void 0!==e?e:1;this.wa=void 0!==c?c:1E3};b.pg.prototype.b=function(){return new b.pg(this.color.cn(),this.ta,this.wa)};b.qf=function(a,e){this.name="";this.color=new b.p(a);this.hi=void 0!==e?e:2.5E-4};b.qf.prototype.b=function(){return new b.qf(this.color.cn(),this.hi)};b.eu=function(a){function e(a,c,e){for(var d=0,f=N.length;d<f;d++){var g=N[d];qb.copy(g.color);if(g instanceof b.zb){var h=Ca.Ua(g.l).normalize(),
k=c.za(h);0>=k||(k*=g.na,e.add(qb.q(k)))}else g instanceof b.ud&&(h=Ca.Ua(g.l),k=c.za(Ca.ea(h,a).normalize()),0>=k||(k*=0==g.cb?1:1-Math.min(a.Ed(h)/g.cb,1),0!=k&&(k*=g.na,e.add(qb.q(k)))))}}function c(a,b,c,e){q(b);v(c);u(e);s(a.Gd());D.stroke();xa.Qf(2*b)}function d(a){x(a.Gd());D.fill()}function f(a){g(a.target)}function g(a){var c=a.jc===b.vd,e=a.kc===b.vd,d=a.M,f=document.createElement("canvas");f.width=d.width;f.height=d.height;var g=f.getContext("2d");g.setTransform(1,0,0,-1,0,d.height);g.drawImage(d,
0,0);ga[a.id]=D.createPattern(f,!0===c&&!0===e?"repeat":!0===c&&!1===e?"repeat-x":!1===c&&!0===e?"repeat-y":"no-repeat")}function h(a,c,e,d,h,k,n,l,p,q,s,r,ja){if(!(ja instanceof b.ue)){!1===ja.si("update",f)&&(void 0!==ja.M&&0<ja.M.width&&g(ja),ja.addEventListener("update",f));var t=ga[ja.id];if(void 0!==t){x(t);var t=ja.offset.x/ja.repeat.x,ub=ja.offset.y/ja.repeat.y,Ob=ja.M.width*ja.repeat.x;ja=ja.M.height*ja.repeat.y;n=(n+t)*Ob;l=(l+ub)*ja;e-=a;d-=c;h-=a;k-=c;p=(p+t)*Ob-n;q=(q+ub)*ja-l;s=(s+t)*
Ob-n;r=(r+ub)*ja-l;ja=p*r-s*q;0!==ja&&(t=1/ja,ja=(r*e-q*h)*t,q=(r*d-q*k)*t,e=(p*h-s*e)*t,d=(p*k-s*d)*t,a=a-ja*n-e*l,c=c-q*n-d*l,D.save(),D.transform(ja,q,e,d,a,c),D.fill(),D.restore())}else x("rgba(0,0,0,1)"),D.fill()}}function k(a,b,c,e,d,f,g){var h,k,n,l,p,ja,q,s;p=g.width-1;q=g.height-1;h=0*p;k=0*q;c-=a;e-=b;d-=a;f-=b;n=1*p-h;l=0*q-k;p=0*p-h;ja=1*q-k;s=1/(n*ja-p*l);q=(ja*c-l*d)*s;l=(ja*e-l*f)*s;c=(n*d-p*c)*s;e=(n*f-p*e)*s;a=a-q*h-c*k;b=b-l*h-e*k;D.save();D.transform(q,l,c,e,a,b);D.clip();D.drawImage(g,
0,0);D.restore()}function n(a,b,c,e){ha[0]=255*a.s|0;ha[1]=255*a.r|0;ha[2]=255*a.g|0;ha[4]=255*b.s|0;ha[5]=255*b.r|0;ha[6]=255*b.g|0;ha[8]=255*c.s|0;ha[9]=255*c.r|0;ha[10]=255*c.g|0;ha[12]=255*e.s|0;ha[13]=255*e.r|0;ha[14]=255*e.g|0;hb.putImageData(xb,0,0);Qa.drawImage(Wa,0,0);return ka}function l(a,b,c){var e=b.x-a.x,d=b.y-a.y,f=e*e+d*d;0!==f&&(c/=Math.sqrt(f),e*=c,d*=c,b.x+=e,b.y+=d,a.x-=e,a.y-=d)}function p(a){K!==a&&(K=D.globalAlpha=a)}function r(a){F!==a&&(a===b.Ih?D.globalCompositeOperation=
"source-over":a===b.ll?D.globalCompositeOperation="lighter":a===b.Yl&&(D.globalCompositeOperation="darker"),F=a)}function q(a){E!==a&&(E=D.lineWidth=a)}function v(a){W!==a&&(W=D.lineCap=a)}function u(a){G!==a&&(G=D.lineJoin=a)}function s(a){A!==a&&(A=D.strokeStyle=a)}function x(a){J!==a&&(J=D.fillStyle=a)}function z(a,b){if(S!==a||X!==b)D.setLineDash([a,b]),S=a,X=b}console.log("THREE.CanvasRenderer",b.Ll);var t=b.Jb.vt;a=a||{};var w=this,y,H,N,Q=new b.sj,C=void 0!==a.canvas?a.canvas:document.createElement("canvas"),
M=Math.floor(C.width/2),I=Math.floor(C.height/2),D=C.getContext("2d");new b.p(0);var K=1,F=0,A=null,J=null,E=null,W=null,G=null,S=null,X=0,aa,P,Y,R,pa,ma,va,U,V,B,ba=new b.p,Aa=new b.p,wa=new b.p,da=new b.p,ca=new b.p,T=new b.p,ea=new b.p,qb=new b.p,ga={},na,La,Ma,qa,ta,Da,Na,Fa,Ka,Va,Pa=new b.of,Ba=new b.of,xa=new b.of,Ea=new b.p,Ia=new b.p,za=new b.p,Ca=new b.a,Wa,hb,xb,ha,ka,Qa,C=16;Wa=document.createElement("canvas");Wa.width=Wa.height=2;hb=Wa.getContext("2d");hb.fillStyle="rgba(0,0,0,1)";hb.fillRect(0,
0,2,2);xb=hb.getImageData(0,0,2,2);ha=xb.data;ka=document.createElement("canvas");ka.width=ka.height=C;Qa=ka.getContext("2d");Qa.translate(-C/2,-C/2);Qa.scale(C,C);C--;void 0===D.setLineDash&&(D.setLineDash=void 0!==D.rs?function(a){D.rs=null!==a[0]?a:null}:la());this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.wt=this.Ri=this.Pj=!0;this.info={w:{e:0,i:0}};this.clear=function(){D.setTransform(1,0,0,-1,M,I);!1===Ba.empty()&&
(Ba.nn(Pa),Ba.Qf(2),D.clearRect(Ba.min.x|0,Ba.min.y|0,Ba.max.x-Ba.min.x|0,Ba.max.y-Ba.min.y|0),Ba.Id())};this.clearColor=la();this.clearDepth=la();this.clearStencil=la();this.w=function(a,m){if(!1===m instanceof b.fb)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.Pj&&this.clear();D.setTransform(1,0,0,-1,M,I);w.info.w.e=0;w.info.w.i=0;y=Q.Os(a,m,this.Ri,this.wt);H=y.elements;N=y.yc;aa=m;Ea.kd(0,0,0);Ia.kd(0,0,0);za.kd(0,0,0);for(var C=0,K=N.length;C<
K;C++){var A=N[C],E=A.color;A instanceof b.te?Ea.add(E):A instanceof b.zb?Ia.add(E):A instanceof b.ud&&za.add(E)}C=0;for(K=H.length;C<K;C++){var F=H[C],G=F.D;if(void 0!==G&&!1!==G.visible){xa.Id();if(F instanceof b.Sl){P=F;P.x*=M;P.y*=I;A=P;E=G;p(E.opacity);r(E.bb);var J=F.scale.x*M,F=F.scale.y*I,G=0.5*Math.sqrt(J*J+F*F);xa.min.set(A.x-G,A.y-G);xa.max.set(A.x+G,A.y+G);if(!1===Pa.Wf(xa))xa.Id();else if(E instanceof b.wg||E instanceof b.Sd){var W=E.map;if(null!==W){!1===W.si("update",f)&&(void 0!==
W.M&&0<W.M.width&&g(W),W.addEventListener("update",f));G=ga[W.id];void 0!==G?x(G):x("rgba( 0, 0, 0, 1 )");var S=W.M,G=S.width*W.offset.x,X=S.height*W.offset.y,ja=S.width*W.repeat.x,W=S.height*W.repeat.y,S=J/ja,ac=F/W;D.save();D.translate(A.x,A.y);0!==E.rotation&&D.rotate(E.rotation);D.translate(-J/2,-F/2);D.scale(S,ac);D.translate(-G,-X);D.fillRect(G,X,ja,W)}else x(E.color.Gd()),D.save(),D.translate(A.x,A.y),0!==E.rotation&&D.rotate(E.rotation),D.scale(J,-F),D.fillRect(-0.5,-0.5,1,1);D.restore()}else E instanceof
b.vg&&(s(E.color.Gd()),x(E.color.Gd()),D.save(),D.translate(A.x,A.y),0!==E.rotation&&D.rotate(E.rotation),D.scale(J,F),E.xb(D),D.restore())}else if(F instanceof b.Rl){if(P=F.ha,Y=F.ka,P.k.x*=M,P.k.y*=I,Y.k.x*=M,Y.k.y*=I,xa.Ld([P.k,Y.k]),!0===Pa.Wf(xa))if(A=P,E=Y,J=F,F=G,p(F.opacity),r(F.bb),D.beginPath(),D.moveTo(A.k.x,A.k.y),D.lineTo(E.k.x,E.k.y),F instanceof b.ab){q(F.Eb);v(F.zi);u(F.Ai);if(F.u!==b.De)s(F.color.Gd());else if(G=J.u[0].Gd(),J=J.u[1].Gd(),G===J)s(G);else{try{var ub=D.createLinearGradient(A.k.x,
A.k.y,E.k.x,E.k.y);ub.addColorStop(0,G);ub.addColorStop(1,J)}catch(Ob){ub=G}s(ub)}D.stroke();xa.Qf(2*F.Eb)}else F instanceof b.uf&&(q(F.Eb),v(F.zi),u(F.Ai),s(F.color.Gd()),z(F.Lf,F.oi),D.stroke(),xa.Qf(2*F.Eb),z(null,null))}else if(F instanceof b.Ql){P=F.ha;Y=F.ka;R=F.Dc;if(-1>P.k.z||1<P.k.z)continue;if(-1>Y.k.z||1<Y.k.z)continue;if(-1>R.k.z||1<R.k.z)continue;P.k.x*=M;P.k.y*=I;Y.k.x*=M;Y.k.y*=I;R.k.x*=M;R.k.y*=I;0<G.Zf&&(l(P.k,Y.k,G.Zf),l(Y.k,R.k,G.Zf),l(R.k,P.k,G.Zf));xa.Ld([P.k,Y.k,R.k]);if(!0===
Pa.Wf(xa)){A=P;E=Y;J=R;w.info.w.e+=3;w.info.w.i++;p(G.opacity);r(G.bb);pa=A.k.x;ma=A.k.y;va=E.k.x;U=E.k.y;V=J.k.x;B=J.k.y;var X=pa,ja=ma,W=va,S=U,ac=V,vc=B;D.beginPath();D.moveTo(X,ja);D.lineTo(W,S);D.lineTo(ac,vc);D.closePath();(G instanceof b.Uc||G instanceof b.Ec)&&null===G.map?(T.copy(G.color),ea.copy(G.kb),G.u===b.pf&&T.multiply(F.color),!1===G.W&&G.Ga===b.Vc&&3===F.Oo?(Aa.copy(Ea),wa.copy(Ea),da.copy(Ea),e(F.ha.bg,F.Yi[0],Aa),e(F.ka.bg,F.Yi[1],wa),e(F.Dc.bg,F.Yi[2],da),Aa.multiply(T).add(ea),
wa.multiply(T).add(ea),da.multiply(T).add(ea),ca.Kj(wa,da).q(0.5),Ma=n(Aa,wa,da,ca),k(pa,ma,va,U,V,B,Ma)):(ba.copy(Ea),e(F.bk,F.fh,ba),ba.multiply(T).add(ea),!0===G.W?c(ba,G.Na,G.Qc,G.Rc):d(ba))):G instanceof b.Kb||G instanceof b.Uc||G instanceof b.Ec?null!==G.map?G.map.lb instanceof b.am&&(qa=F.jf[0],h(pa,ma,va,U,V,B,qa[0].x,qa[0].y,qa[1].x,qa[1].y,qa[2].x,qa[2].y,G.map)):null!==G.Aa?G.Aa.lb instanceof b.zp&&(Ca.copy(F.kf[0]),ta=0.5*Ca.x+0.5,Da=0.5*Ca.y+0.5,Ca.copy(F.kf[1]),Na=0.5*Ca.x+0.5,Fa=0.5*
Ca.y+0.5,Ca.copy(F.kf[2]),Ka=0.5*Ca.x+0.5,Va=0.5*Ca.y+0.5,h(pa,ma,va,U,V,B,ta,Da,Na,Fa,Ka,Va,G.Aa)):(ba.copy(G.color),G.u===b.pf&&ba.multiply(F.color),!0===G.W?c(ba,G.Na,G.Qc,G.Rc):d(ba)):G instanceof b.Ae?(na=aa.ta,La=aa.wa,Aa.s=Aa.r=Aa.g=1-t(A.k.z*A.k.f,na,La),wa.s=wa.r=wa.g=1-t(E.k.z*E.k.f,na,La),da.s=da.r=da.g=1-t(J.k.z*J.k.f,na,La),ca.Kj(wa,da).q(0.5),Ma=n(Aa,wa,da,ca),k(pa,ma,va,U,V,B,Ma)):G instanceof b.vf&&(A=void 0,G.Ga===b.og?(A=F.On,ba.kd(A.x,A.y,A.z).q(0.5).Gc(0.5),!0===G.W?c(ba,G.Na,
G.Qc,G.Rc):d(ba)):G.Ga===b.Vc&&(A=F.kf[0],Aa.kd(A.x,A.y,A.z).q(0.5).Gc(0.5),A=F.kf[1],wa.kd(A.x,A.y,A.z).q(0.5).Gc(0.5),A=F.kf[2],da.kd(A.x,A.y,A.z).q(0.5).Gc(0.5),ca.Kj(wa,da).q(0.5),Ma=n(Aa,wa,da,ca),k(pa,ma,va,U,V,B,Ma)))}}Ba.hl(xa)}}D.setTransform(1,0,0,1,0,0)}}};b.d={Ov:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",Nv:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",
yv:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",xv:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",
zv:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",Ry:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",
Av:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",ax:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
$w:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",Zw:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",Yw:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",bx:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",
Xw:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",pw:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",qw:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",ow:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",rw:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",Uu:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
px:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
my:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",ly:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",sw:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",
tw:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",
ww:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",xw:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
vw:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
uw:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
av:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",$u:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n#endif",bv:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",cv:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",fy:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nuniform int boneTextureWidth;\nuniform int boneTextureHeight;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, float( boneTextureWidth ) );\nfloat y = floor( j / float( boneTextureWidth ) );\nfloat dx = 1.0 / float( boneTextureWidth );\nfloat dy = 1.0 / float( boneTextureHeight );\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",
ey:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",gy:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",mx:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",
nx:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",
mv:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",lx:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",
hy:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",nv:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
$x:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",Zx:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
ay:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",by:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",Mu:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",yw:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};b.uc={Ue:function(a){var b,c,d,f={};for(b=0;b<a.length;b++)for(c in d=this.b(a[b]),d)f[c]=d[c];
return f},b:function(a){var e,c,d,f={};for(e in a)for(c in f[e]={},a[e])d=a[e][c],f[e][c]=d instanceof b.p||d instanceof b.h||d instanceof b.a||d instanceof b.vc||d instanceof b.$||d instanceof b.rb?d.b():d instanceof Array?d.slice():d;return f}};b.Pa={dv:{diffuse:{type:"c",value:new b.p(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new b.vc(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",
value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},Tu:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},ox:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new b.h(1,1)}},H:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new b.p(16777215)}},yc:{ambientLightColor:{type:"fv",value:[]},
directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},
spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},ux:{psColor:{type:"c",value:new b.p(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new b.p(16777215)}},Yx:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},
shadowMatrix:{type:"m4v",value:[]}}};b.tg={basic:{Q:b.uc.Ue([b.Pa.common,b.Pa.fog,b.Pa.shadowmap]),R:[b.d.map_pars_vertex,b.d.lightmap_pars_vertex,b.d.envmap_pars_vertex,b.d.color_pars_vertex,b.d.morphtarget_pars_vertex,b.d.skinning_pars_vertex,b.d.shadowmap_pars_vertex,"void main() {",b.d.map_vertex,b.d.lightmap_vertex,b.d.color_vertex,b.d.skinbase_vertex,"#ifdef USE_ENVMAP",b.d.morphnormal_vertex,b.d.skinnormal_vertex,b.d.defaultnormal_vertex,"#endif",b.d.morphtarget_vertex,b.d.skinning_vertex,
b.d.default_vertex,b.d.worldpos_vertex,b.d.envmap_vertex,b.d.shadowmap_vertex,"}"].join("\n"),P:["uniform vec3 diffuse;\nuniform float opacity;",b.d.color_pars_fragment,b.d.map_pars_fragment,b.d.lightmap_pars_fragment,b.d.envmap_pars_fragment,b.d.fog_pars_fragment,b.d.shadowmap_pars_fragment,b.d.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",b.d.map_fragment,b.d.alphatest_fragment,b.d.specularmap_fragment,b.d.lightmap_fragment,b.d.color_fragment,b.d.envmap_fragment,
b.d.shadowmap_fragment,b.d.linear_to_gamma_fragment,b.d.fog_fragment,"}"].join("\n")},lambert:{Q:b.uc.Ue([b.Pa.common,b.Pa.fog,b.Pa.lights,b.Pa.shadowmap,{ambient:{type:"c",value:new b.p(16777215)},emissive:{type:"c",value:new b.p(0)},wrapRGB:{type:"v3",value:new b.a(1,1,1)}}]),R:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",b.d.map_pars_vertex,b.d.lightmap_pars_vertex,b.d.envmap_pars_vertex,b.d.lights_lambert_pars_vertex,b.d.color_pars_vertex,
b.d.morphtarget_pars_vertex,b.d.skinning_pars_vertex,b.d.shadowmap_pars_vertex,"void main() {",b.d.map_vertex,b.d.lightmap_vertex,b.d.color_vertex,b.d.morphnormal_vertex,b.d.skinbase_vertex,b.d.skinnormal_vertex,b.d.defaultnormal_vertex,b.d.morphtarget_vertex,b.d.skinning_vertex,b.d.default_vertex,b.d.worldpos_vertex,b.d.envmap_vertex,b.d.lights_lambert_vertex,b.d.shadowmap_vertex,"}"].join("\n"),P:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",
b.d.color_pars_fragment,b.d.map_pars_fragment,b.d.lightmap_pars_fragment,b.d.envmap_pars_fragment,b.d.fog_pars_fragment,b.d.shadowmap_pars_fragment,b.d.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",b.d.map_fragment,b.d.alphatest_fragment,b.d.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",b.d.lightmap_fragment,b.d.color_fragment,
b.d.envmap_fragment,b.d.shadowmap_fragment,b.d.linear_to_gamma_fragment,b.d.fog_fragment,"}"].join("\n")},phong:{Q:b.uc.Ue([b.Pa.common,b.Pa.bump,b.Pa.normalmap,b.Pa.fog,b.Pa.lights,b.Pa.shadowmap,{ambient:{type:"c",value:new b.p(16777215)},emissive:{type:"c",value:new b.p(0)},specular:{type:"c",value:new b.p(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new b.a(1,1,1)}}]),R:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",b.d.map_pars_vertex,b.d.lightmap_pars_vertex,
b.d.envmap_pars_vertex,b.d.lights_phong_pars_vertex,b.d.color_pars_vertex,b.d.morphtarget_pars_vertex,b.d.skinning_pars_vertex,b.d.shadowmap_pars_vertex,"void main() {",b.d.map_vertex,b.d.lightmap_vertex,b.d.color_vertex,b.d.morphnormal_vertex,b.d.skinbase_vertex,b.d.skinnormal_vertex,b.d.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",b.d.morphtarget_vertex,b.d.skinning_vertex,b.d.default_vertex,"vViewPosition = -mvPosition.xyz;",b.d.worldpos_vertex,b.d.envmap_vertex,b.d.lights_phong_vertex,
b.d.shadowmap_vertex,"}"].join("\n"),P:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",b.d.color_pars_fragment,b.d.map_pars_fragment,b.d.lightmap_pars_fragment,b.d.envmap_pars_fragment,b.d.fog_pars_fragment,b.d.lights_phong_pars_fragment,b.d.shadowmap_pars_fragment,b.d.bumpmap_pars_fragment,b.d.normalmap_pars_fragment,b.d.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",
b.d.map_fragment,b.d.alphatest_fragment,b.d.specularmap_fragment,b.d.lights_phong_fragment,b.d.lightmap_fragment,b.d.color_fragment,b.d.envmap_fragment,b.d.shadowmap_fragment,b.d.linear_to_gamma_fragment,b.d.fog_fragment,"}"].join("\n")},particle_basic:{Q:b.uc.Ue([b.Pa.particle,b.Pa.shadowmap]),R:["uniform float size;\nuniform float scale;",b.d.color_pars_vertex,b.d.shadowmap_pars_vertex,"void main() {",b.d.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",
b.d.worldpos_vertex,b.d.shadowmap_vertex,"}"].join("\n"),P:["uniform vec3 psColor;\nuniform float opacity;",b.d.color_pars_fragment,b.d.map_particle_pars_fragment,b.d.fog_pars_fragment,b.d.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",b.d.map_particle_fragment,b.d.alphatest_fragment,b.d.color_fragment,b.d.shadowmap_fragment,b.d.fog_fragment,"}"].join("\n")},dashed:{Q:b.uc.Ue([b.Pa.common,b.Pa.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",
value:2}}]),R:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",b.d.color_pars_vertex,"void main() {",b.d.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),P:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",b.d.color_pars_fragment,b.d.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",
b.d.color_fragment,b.d.fog_fragment,"}"].join("\n")},depth:{Q:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",value:1}},R:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",P:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{Q:{opacity:{type:"f",
value:1}},R:["varying vec3 vNormal;",b.d.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",b.d.morphtarget_vertex,b.d.default_vertex,"}"].join("\n"),P:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{Q:b.uc.Ue([b.Pa.fog,b.Pa.lights,b.Pa.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",
value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new b.h(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},diffuse:{type:"c",value:new b.p(16777215)},specular:{type:"c",value:new b.p(1118481)},ambient:{type:"c",value:new b.p(16777215)},shininess:{type:"f",value:30},
opacity:{type:"f",value:1},useRefract:{type:"i",value:0},refractionRatio:{type:"f",value:0.98},reflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new b.h(0,0)},uRepeat:{type:"v2",value:new b.h(1,1)},wrapRGB:{type:"v3",value:new b.a(1,1,1)}}]),P:["uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float refractionRatio;\nuniform float reflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
b.d.shadowmap_pars_fragment,b.d.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), opacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * diffuse * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * diffuse * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * diffuse * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * reflectivity );\n}",
b.d.shadowmap_fragment,b.d.linear_to_gamma_fragment,b.d.fog_fragment,"}"].join("\n"),R:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",b.d.skinning_pars_vertex,
b.d.shadowmap_pars_vertex,"void main() {",b.d.skinbase_vertex,b.d.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},
cube:{Q:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},R:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",P:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},depthRGBA:{Q:{},R:[b.d.morphtarget_pars_vertex,
b.d.skinning_pars_vertex,"void main() {",b.d.skinbase_vertex,b.d.morphtarget_vertex,b.d.skinning_vertex,b.d.default_vertex,"}"].join("\n"),P:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};b.Iu=
function(a){function e(a){var b=a.xb;if(void 0!==b){a.xb=void 0;var c,e,d=!1;a=0;for(c=ba.length;a<c;a++)if(e=ba[a],e.xb===b){e.jl--;0===e.jl&&(d=!0);break}if(!0===d){d=[];a=0;for(c=ba.length;a<c;a++)e=ba[a],e.xb!==b&&d.push(e);ba=d;m.deleteProgram(b);B.info.memory.Yn--}}}function c(a){void 0!==a.Ab&&m.deleteBuffer(a.Ab);void 0!==a.He&&m.deleteBuffer(a.He);void 0!==a.Th&&m.deleteBuffer(a.Th);void 0!==a.Fc&&m.deleteBuffer(a.Fc);void 0!==a.Vh&&m.deleteBuffer(a.Vh);void 0!==a.Uh&&m.deleteBuffer(a.Uh);
void 0!==a.Rh&&m.deleteBuffer(a.Rh);void 0!==a.Sh&&m.deleteBuffer(a.Sh);void 0!==a.Oh&&m.deleteBuffer(a.Oh);void 0!==a.Ph&&m.deleteBuffer(a.Ph);void 0!==a.Qh&&m.deleteBuffer(a.Qh);if(void 0!==a.Mb)for(var b in a.Mb)m.deleteBuffer(a.Mb[b].buffer);B.info.memory.Ra--}function d(a){a=a.target;a.removeEventListener("dispose",d);e(a)}function f(a){a=a.target;a.removeEventListener("dispose",f);if(a&&a.Wb)if(m.deleteTexture(a.Wb),a instanceof b.Fe)for(var c=0;6>c;c++)m.deleteFramebuffer(a.yd[c]),m.deleteRenderbuffer(a.Ad[c]);
else m.deleteFramebuffer(a.yd),m.deleteRenderbuffer(a.Ad);B.info.memory.Ib--}function g(a){a=a.target;a.removeEventListener("dispose",g);a.M&&a.M.Bg?m.deleteTexture(a.M.Bg):a.zd&&(a.zd=!1,m.deleteTexture(a.Wb));B.info.memory.Ib--}function h(a){a=a.target;a.removeEventListener("dispose",h);a.zd=void 0;if(a instanceof b.qb){var e=a.attributes,d;for(d in e)void 0!==e[d].buffer&&m.deleteBuffer(e[d].buffer);B.info.memory.Ra--}else if(void 0!==a.Za)for(e in a.Za){d=a.Za[e];if(void 0!==d.ih)for(var f=0,
g=d.ih;f<g;f++)m.deleteBuffer(d.Cf[f]);if(void 0!==d.hh)for(f=0,g=d.hh;f<g;f++)m.deleteBuffer(d.zg[f]);c(d)}else c(a)}function k(a,b){var c=a.e.length,e=b.D;if(e.attributes){void 0===a.Mb&&(a.Mb=[]);for(var d in e.attributes){var f=e.attributes[d];if(!f.Fj||f.Xq){f.Fj=!0;var g=1;"v2"===f.type?g=2:"v3"===f.type?g=3:"v4"===f.type?g=4:"c"===f.type&&(g=3);f.size=g;f.c=new Float32Array(c*g);f.buffer=m.createBuffer();f.buffer.ai=d;f.ga=!0}a.Mb.push(f)}}}function n(a,b){var c=b.j,e=a.Vm,d=3*e.length,f=1*
e.length,g=3*e.length,e=l(b,a),h=r(e),k=p(e),n=e.u?e.u:!1;a.Bf=new Float32Array(3*d);k&&(a.km=new Float32Array(3*d));c.Uf&&(a.nm=new Float32Array(4*d));n&&(a.yf=new Float32Array(3*d));h&&(0<c.v.length&&(a.pm=new Float32Array(2*d)),1<c.v.length&&(a.om=new Float32Array(2*d)));b.j.qe.length&&b.j.pe.length&&(a.lm=new Float32Array(4*d),a.mm=new Float32Array(4*d));a.fm=new Uint16Array(3*f);a.hm=new Uint16Array(2*g);if(a.ih)for(a.jm=[],c=0,h=a.ih;c<h;c++)a.jm.push(new Float32Array(3*d));if(a.hh)for(a.im=
[],c=0,h=a.hh;c<h;c++)a.im.push(new Float32Array(3*d));a.Dj=3*f;a.Gj=2*g;if(e.attributes){void 0===a.Mb&&(a.Mb=[]);for(var q in e.attributes){var f=e.attributes[q],g={},s;for(s in f)g[s]=f[s];if(!g.Fj||g.Xq)g.Fj=!0,c=1,"v2"===g.type?c=2:"v3"===g.type?c=3:"v4"===g.type?c=4:"c"===g.type&&(c=3),g.size=c,g.c=new Float32Array(d*c),g.buffer=m.createBuffer(),g.buffer.ai=q,f.ga=!0,g.Rp=f;a.Mb.push(g)}}a.gm=!0}function l(a,c){return a.D instanceof b.qc?a.D.Z[c.fc]:a.D}function p(a){return a instanceof b.Kb&&
!a.Aa||a instanceof b.Ae?!1:a&&void 0!==a.Ga&&a.Ga===b.Vc?b.Vc:b.og}function r(a){return a.map||a.Sa||a.Rb||a.nb||a.Ma||a instanceof b.Wa?!0:!1}function q(a){Ca[a]||(m.enableVertexAttribArray(a),Ca[a]=!0)}function v(){for(var a in Ca)Ca[a]&&(m.disableVertexAttribArray(a),Ca[a]=!1)}function u(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}function s(a,b){return b[0]-a[0]}function x(a,b,c){if(a.length)for(var e=0,d=a.length;e<d;e++)ea=wa=null,ca=T=La=na=Fa=Na=Ma=-1,Qa=!0,a[e].w(b,c,Ia,za),ea=wa=null,ca=T=
La=na=Fa=Na=Ma=-1,Qa=!0}function z(a,c,e,d,f,g,h,k){var m,n,l,p;c?(n=a.length-1,p=c=-1):(n=0,c=a.length,p=1);for(var q=n;q!==c;q+=p)if(m=a[q],m.w){n=m.object;l=m.buffer;if(k)m=k;else{m=m[e];if(!m)continue;h&&B.fg(m.bb,m.blendEquation,m.Oe,m.Ne);B.cf(m.Cd);B.nh(m.Dd);J(m.polygonOffset,m.lh,m.mh)}B.Wk(m);l instanceof b.qb?B.Pk(d,f,g,m,l,n):B.Ok(d,f,g,m,l,n)}}function t(a,b,c,e,d,f,g){for(var h,k,m=0,n=a.length;m<n;m++)if(h=a[m],k=h.object,k.visible){if(g)h=g;else{h=h[b];if(!h)continue;f&&B.fg(h.bb,
h.blendEquation,h.Oe,h.Ne);B.cf(h.Cd);B.nh(h.Dd);J(h.polygonOffset,h.lh,h.mh)}B.Qk(c,e,d,h,k)}}function w(a,c){var e,d,f,g;if(void 0===a.zd&&(a.zd=!0,a.wc=new b.$,a.Jj=new b.pc,void 0!==a.j&&void 0===a.j.zd&&(a.j.zd=!0,a.j.addEventListener("dispose",h)),d=a.j,void 0!==d))if(d instanceof b.qb){var l,p;for(l in d.attributes)p="index"===l?m.ELEMENT_ARRAY_BUFFER:m.ARRAY_BUFFER,g=d.attributes[l],void 0===g.gd&&(g.gd=g.c.length),g.buffer=m.createBuffer(),m.bindBuffer(p,g.buffer),m.bufferData(p,g.c,m.STATIC_DRAW)}else if(a instanceof
b.U){f=a.D;if(void 0===d.Za){l=d;var q,s,r;p={};var t=l.A.length,v=l.pa.length,u=f instanceof b.qc;l.Za={};f=0;for(q=l.i.length;f<q;f++)s=l.i[f],s=u?s.fc:0,void 0===p[s]&&(p[s]={hash:s,counter:0}),r=p[s].hash+"_"+p[s].ck,void 0===l.Za[r]&&(l.Za[r]={faces3:[],materialIndex:s,vertices:0,numMorphTargets:t,numMorphNormals:v}),65535<l.Za[r].e+3&&(p[s].ck+=1,r=p[s].hash+"_"+p[s].ck,void 0===l.Za[r]&&(l.Za[r]={faces3:[],materialIndex:s,vertices:0,numMorphTargets:t,numMorphNormals:v})),l.Za[r].Vm.push(f),
l.Za[r].e+=3;l.qk=[];for(g in l.Za)l.Za[g].id=qb++,l.qk.push(l.Za[g])}for(e in d.Za)if(g=d.Za[e],!g.Ab){l=g;l.Ab=m.createBuffer();l.He=m.createBuffer();l.Th=m.createBuffer();l.Fc=m.createBuffer();l.Vh=m.createBuffer();l.Uh=m.createBuffer();l.Rh=m.createBuffer();l.Sh=m.createBuffer();l.Oh=m.createBuffer();l.Ph=m.createBuffer();t=p=void 0;if(l.ih)for(l.Cf=[],p=0,t=l.ih;p<t;p++)l.Cf.push(m.createBuffer());if(l.hh)for(l.zg=[],p=0,t=l.hh;p<t;p++)l.zg.push(m.createBuffer());B.info.memory.Ra++;n(g,a);d.$a=
!0;d.Ek=!0;d.ki=!0;d.Xi=!0;d.Yf=!0;d.xh=!0;d.ac=!0}}else a instanceof b.fa?d.Ab||(g=d,g.Ab=m.createBuffer(),g.Fc=m.createBuffer(),g.Qh=m.createBuffer(),B.info.memory.Ra++,g=d,l=g.e.length,g.Bf=new Float32Array(3*l),g.yf=new Float32Array(3*l),g.Pp=new Float32Array(1*l),g.Gj=l,k(g,a),d.$a=!0,d.ac=!0,d.yi=!0):a instanceof b.Sb&&!d.Ab&&(g=d,g.Ab=m.createBuffer(),g.Fc=m.createBuffer(),B.info.memory.Ra++,g=d,l=g.e.length,g.Bf=new Float32Array(3*l),g.yf=new Float32Array(3*l),g.Tp=[],g.qm=l,k(g,a),d.$a=!0,
d.ac=!0);if(void 0===a.Cj){if(a instanceof b.U)if(d=a.j,d instanceof b.qb)y(c.Vb,d,a);else{if(d instanceof b.B)for(e in d.Za)g=d.Za[e],y(c.Vb,g,a)}else a instanceof b.fa||a instanceof b.Sb?(d=a.j,y(c.Vb,d,a)):a instanceof b.ij||a.wk?c.Ud.push({id:null,object:a,Ze:null,Ha:null,z:0}):a instanceof b.xd?c.Hj.push(a):a instanceof b.qg&&c.Ej.push(a);a.Cj=!0}}function y(a,b,c){a.push({id:null,buffer:b,object:c,Ze:null,Ha:null,z:0})}function H(a){for(var b in a.attributes)if(a.attributes[b].ga)return!0;return!1}
function N(a){for(var b in a.attributes)a.attributes[b].ga=!1}function Q(a,c){a instanceof b.U||a instanceof b.Sb||a instanceof b.fa?C(c.Vb,a):a instanceof b.xd?M(c.Hj,a):a instanceof b.qg?M(c.Ej,a):(a instanceof b.ij||a.wk)&&C(c.Ud,a);delete a.Cj}function C(a,b){for(var c=a.length-1;0<=c;c--)a[c].object===b&&a.splice(c,1)}function M(a,b){for(var c=a.length-1;0<=c;c--)a[c]===b&&a.splice(c,1)}function I(a,c,d,f,h){ga=0;f.ga&&(f.xb&&e(f),B.Lr(f,c,d,h),f.ga=!1);f.A&&!h.Ag&&(h.Ag=new Float32Array(B.dh));
var k=!1,n=f.xb,l=n.Q,p=f.Q;n!==wa&&(m.useProgram(n),wa=n,k=!0);f.id!==ca&&(ca=f.id,k=!0);if(k||a!==ea)m.uniformMatrix4fv(l.xa,!1,a.xa.elements),a!==ea&&(ea=a);if(f.Ea)if(Db&&h.Od){if(null!==l.Yd){var q=D();m.uniform1i(l.Yd,q);B.hg(h.Yd,q)}null!==l.Fg&&m.uniform1i(l.Fg,h.Fg);null!==l.Eg&&m.uniform1i(l.Eg,h.Eg)}else null!==l.Lq&&m.uniformMatrix4fv(l.Lq,!1,h.Dg);if(k){d&&f.H&&(p.Jv.value=d.color,d instanceof b.pg?(p.Mv.value=d.ta,p.Lv.value=d.wa):d instanceof b.qf&&(p.Kv.value=d.hi));if(f instanceof
b.Ec||f instanceof b.Uc||f.yc){if(Qa){var s,r=q=0,t=0,v,u,x,w=Lb,z=w.Qg.va,A=w.Qg.Lc,y=w.af.va,I=w.af.Lc,H=w.af.Rg,C=w.hc.va,E=w.hc.Lc,M=w.hc.Rg,N=w.hc.Pm,Q=w.hc.Bm,R=w.hc.Sm,J=w.Se.xo,U=w.Se.jn,W=w.Se.Lc,S=0,X=0,Y=0,V=0,bc=0,cc=0,dc=0,T=0,ba=s=0;d=x=ba=0;for(k=c.length;d<k;d++)if(s=c[d],!s.me)if(v=s.color,u=s.na,x=s.cb,s instanceof b.te)s.visible&&(B.cd?(q+=v.s*v.s,r+=v.r*v.r,t+=v.g*v.g):(q+=v.s,r+=v.r,t+=v.g));else if(s instanceof b.zb){if(bc+=1,s.visible&&(ka.Ua(s.l),ha.Ua(s.target.l),ka.sub(ha),
ka.normalize(),0!==ka.x||0!==ka.y||0!==ka.z))s=3*S,A[s]=ka.x,A[s+1]=ka.y,A[s+2]=ka.z,B.cd?K(z,s,v,u*u):F(z,s,v,u),S+=1}else s instanceof b.ud?(cc+=1,s.visible&&(ba=3*X,B.cd?K(y,ba,v,u*u):F(y,ba,v,u),ha.Ua(s.l),I[ba]=ha.x,I[ba+1]=ha.y,I[ba+2]=ha.z,H[X]=x,X+=1)):s instanceof b.Wc?(dc+=1,s.visible&&(ba=3*Y,B.cd?K(C,ba,v,u*u):F(C,ba,v,u),ha.Ua(s.l),E[ba]=ha.x,E[ba+1]=ha.y,E[ba+2]=ha.z,M[Y]=x,ka.copy(ha),ha.Ua(s.target.l),ka.sub(ha),ka.normalize(),N[ba]=ka.x,N[ba+1]=ka.y,N[ba+2]=ka.z,Q[Y]=Math.cos(s.Je),
R[Y]=s.mi,Y+=1)):s instanceof b.rf&&(T+=1,s.visible&&(ka.Ua(s.l),ka.normalize(),0!==ka.x||0!==ka.y||0!==ka.z))&&(x=3*V,W[x]=ka.x,W[x+1]=ka.y,W[x+2]=ka.z,v=s.color,s=s.Zg,B.cd?(u*=u,K(J,x,v,u),K(U,x,s,u)):(F(J,x,v,u),F(U,x,s,u)),V+=1);d=3*S;for(k=Math.max(z.length,3*bc);d<k;d++)z[d]=0;d=3*X;for(k=Math.max(y.length,3*cc);d<k;d++)y[d]=0;d=3*Y;for(k=Math.max(C.length,3*dc);d<k;d++)C[d]=0;d=3*V;for(k=Math.max(J.length,3*T);d<k;d++)J[d]=0;d=3*V;for(k=Math.max(U.length,3*T);d<k;d++)U[d]=0;w.Qg.length=S;
w.af.length=X;w.hc.length=Y;w.Se.length=V;w.ya[0]=q;w.ya[1]=r;w.ya[2]=t;Qa=!1}d=Lb;p.Nu.value=d.ya;p.qv.value=d.Qg.va;p.rv.value=d.Qg.Lc;p.yx.value=d.af.va;p.Ax.value=d.af.Lc;p.zx.value=d.af.Rg;p.oy.value=d.hc.va;p.sy.value=d.hc.Lc;p.qy.value=d.hc.Rg;p.py.value=d.hc.Pm;p.ny.value=d.hc.Bm;p.ry.value=d.hc.Sm;p.Yv.value=d.Se.xo;p.Xv.value=d.Se.jn;p.Wv.value=d.Se.Lc}if(f instanceof b.Kb||f instanceof b.Uc||f instanceof b.Ec){p.opacity.value=f.opacity;B.cd?p.ik.value.Kf(f.color):p.ik.value=f.color;p.map.value=
f.map;p.Sa.value=f.Sa;p.Ma.value=f.Ma;f.Rb&&(p.Rb.value=f.Rb,p.Gg.value=f.Gg);f.nb&&(p.nb.value=f.nb,p.Ye.value.copy(f.Ye));var da;f.map?da=f.map:f.Ma?da=f.Ma:f.nb?da=f.nb:f.Rb&&(da=f.Rb);void 0!==da&&(d=da.offset,da=da.repeat,p.qx.value.set(d.x,d.y,da.x,da.y));p.Aa.value=f.Aa;p.Iv.value=f.Aa instanceof b.Fe?1:-1;p.Mc.value=f.Mc;p.hd.value=f.hd;p.Zc.value=f.Zc;p.My.value=f.Aa&&f.Aa.lb instanceof b.Xo}f instanceof b.ab?(p.ik.value=f.color,p.opacity.value=f.opacity):f instanceof b.uf?(p.ik.value=f.color,
p.opacity.value=f.opacity,p.Lf.value=f.Lf,p.Gy.value=f.Lf+f.oi,p.scale.value=f.scale):f instanceof b.Sd?(p.Ex.value=f.color,p.opacity.value=f.opacity,p.size.value=f.size,p.scale.value=P.height/2,p.map.value=f.map):f instanceof b.Ec?(p.ld.value=f.ld,B.cd?(p.ya.value.Kf(f.ya),p.kb.value.Kf(f.kb),p.Ac.value.Kf(f.Ac)):(p.ya.value=f.ya,p.kb.value=f.kb,p.Ac.value=f.Ac),f.Sc&&p.Pd.value.copy(f.Pd)):f instanceof b.Uc?(B.cd?(p.ya.value.Kf(f.ya),p.kb.value.Kf(f.kb)):(p.ya.value=f.ya,p.kb.value=f.kb),f.Sc&&
p.Pd.value.copy(f.Pd)):f instanceof b.Ae?(p.Bw.value=a.ta,p.Aw.value=a.wa,p.opacity.value=f.opacity):f instanceof b.vf&&(p.opacity.value=f.opacity);if(h.cg&&!f.Xd&&p.jg)for(d=da=0,k=c.length;d<k;d++)q=c[d],q.tb&&(q instanceof b.Wc||q instanceof b.zb&&!q.bl)&&(p.ig.value[da]=q.ig,p.Qi.value[da]=q.Qi,p.jg.value[da]=q.jg,p.ef.value[da]=q.ef,p.oh.value[da]=q.oh,da++);c=f.Io;p=0;for(da=c.length;p<da;p++)if(k=n.Q[c[p][1]])if(d=c[p][0],r=d.type,q=d.value,"i"===r)m.uniform1i(k,q);else if("f"===r)m.uniform1f(k,
q);else if("v2"===r)m.uniform2f(k,q.x,q.y);else if("v3"===r)m.uniform3f(k,q.x,q.y,q.z);else if("v4"===r)m.uniform4f(k,q.x,q.y,q.z,q.f);else if("c"===r)m.uniform3f(k,q.s,q.r,q.g);else if("iv1"===r)m.uniform1iv(k,q);else if("iv"===r)m.uniform3iv(k,q);else if("fv1"===r)m.uniform1fv(k,q);else if("fv"===r)m.uniform3fv(k,q);else if("v2v"===r){void 0===d.ia&&(d.ia=new Float32Array(2*q.length));r=0;for(t=q.length;r<t;r++)w=2*r,d.ia[w]=q[r].x,d.ia[w+1]=q[r].y;m.uniform2fv(k,d.ia)}else if("v3v"===r){void 0===
d.ia&&(d.ia=new Float32Array(3*q.length));r=0;for(t=q.length;r<t;r++)w=3*r,d.ia[w]=q[r].x,d.ia[w+1]=q[r].y,d.ia[w+2]=q[r].z;m.uniform3fv(k,d.ia)}else if("v4v"===r){void 0===d.ia&&(d.ia=new Float32Array(4*q.length));r=0;for(t=q.length;r<t;r++)w=4*r,d.ia[w]=q[r].x,d.ia[w+1]=q[r].y,d.ia[w+2]=q[r].z,d.ia[w+3]=q[r].f;m.uniform4fv(k,d.ia)}else if("m4"===r)void 0===d.ia&&(d.ia=new Float32Array(16)),q.or(d.ia),m.uniformMatrix4fv(k,!1,d.ia);else if("m4v"===r){void 0===d.ia&&(d.ia=new Float32Array(16*q.length));
r=0;for(t=q.length;r<t;r++)q[r].Wm(d.ia,16*r);m.uniformMatrix4fv(k,!1,d.ia)}else if("t"===r){if(w=q,q=D(),m.uniform1i(k,q),w)if(w.M instanceof Array&&6===w.M.length){if(d=w,k=q,6===d.M.length)if(d.ga){d.M.Bg||(d.addEventListener("dispose",g),d.M.Bg=m.createTexture(),B.info.memory.Ib++);m.activeTexture(m.TEXTURE0+k);m.bindTexture(m.TEXTURE_CUBE_MAP,d.M.Bg);m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,d.fe);k=d instanceof b.Qd;q=[];for(r=0;6>r;r++)t=q,w=r,B.yq&&!k?(z=d.M[r],y=Zb,z.width<=y&&z.height<=y||(I=
Math.max(z.width,z.height),A=Math.floor(z.width*y/I),y=Math.floor(z.height*y/I),I=document.createElement("canvas"),I.width=A,I.height=y,I.getContext("2d").drawImage(z,0,0,z.width,z.height,0,0,A,y),z=I)):z=d.M[r],t[w]=z;r=q[0];t=0===(r.width&r.width-1)&&0===(r.height&r.height-1);w=aa(d.ba);z=aa(d.type);G(m.TEXTURE_CUBE_MAP,d,t);for(r=0;6>r;r++)if(k)for(y=q[r].Ka,I=0,H=y.length;I<H;I++)A=y[I],d.ba!==b.Td?m.compressedTexImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+r,I,w,A.width,A.height,0,A.data):m.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+
r,I,w,A.width,A.height,0,w,z,A.data);else m.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,w,w,z,q[r]);d.Db&&t&&m.generateMipmap(m.TEXTURE_CUBE_MAP);d.ga=!1;d.Di&&d.Di()}else m.activeTexture(m.TEXTURE0+k),m.bindTexture(m.TEXTURE_CUBE_MAP,d.M.Bg)}else w instanceof b.Fe?(d=w,m.activeTexture(m.TEXTURE0+q),m.bindTexture(m.TEXTURE_CUBE_MAP,d.Wb)):B.hg(w,q)}else if("tv"===r){void 0===d.ia&&(d.ia=[]);r=0;for(t=d.value.length;r<t;r++)d.ia[r]=D();m.uniform1iv(k,d.ia);r=0;for(t=d.value.length;r<t;r++)w=d.value[r],
q=d.ia[r],w&&B.hg(w,q)}else console.warn("THREE.WebGLRenderer: Unknown uniform type: "+r);(f instanceof b.Wa||f instanceof b.Ec||f.Aa)&&null!==l.Nq&&(ha.Ua(a.l),m.uniform3f(l.Nq,ha.x,ha.y,ha.z));(f instanceof b.Ec||f instanceof b.Uc||f instanceof b.Wa||f.Ea)&&null!==l.Wt&&m.uniformMatrix4fv(l.Wt,!1,a.Ta.elements)}m.uniformMatrix4fv(l.jx,!1,h.wc.elements);l.Xe&&m.uniformMatrix3fv(l.Xe,!1,h.Jj.elements);null!==l.os&&m.uniformMatrix4fv(l.os,!1,h.l.elements);return n}function D(){var a=ga;a>=Mb&&console.warn("WebGLRenderer: trying to use "+
a+" texture units while this GPU supports only "+Mb);ga+=1;return a}function K(a,b,c,e){a[b]=c.s*c.s*e;a[b+1]=c.r*c.r*e;a[b+2]=c.g*c.g*e}function F(a,b,c,e){a[b]=c.s*e;a[b+1]=c.r*e;a[b+2]=c.g*e}function A(a){a!==Ba&&(m.lineWidth(a),Ba=a)}function J(a,b,c){Ka!==a&&(a?m.enable(m.POLYGON_OFFSET_FILL):m.disable(m.POLYGON_OFFSET_FILL),Ka=a);!a||Va===b&&Pa===c||(m.polygonOffset(b,c),Va=b,Pa=c)}function E(a){a=a.split("\n");for(var b=0,c=a.length;b<c;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function W(a,
b){var c;"fragment"===a?c=m.createShader(m.FRAGMENT_SHADER):"vertex"===a&&(c=m.createShader(m.VERTEX_SHADER));m.shaderSource(c,b);m.compileShader(c);return m.getShaderParameter(c,m.COMPILE_STATUS)?c:(console.error(m.getShaderInfoLog(c)),console.error(E(b)),null)}function G(a,c,e){e?(m.texParameteri(a,m.TEXTURE_WRAP_S,aa(c.jc)),m.texParameteri(a,m.TEXTURE_WRAP_T,aa(c.kc)),m.texParameteri(a,m.TEXTURE_MAG_FILTER,aa(c.Gb)),m.texParameteri(a,m.TEXTURE_MIN_FILTER,aa(c.mb))):(m.texParameteri(a,m.TEXTURE_WRAP_S,
m.CLAMP_TO_EDGE),m.texParameteri(a,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(a,m.TEXTURE_MAG_FILTER,X(c.Gb)),m.texParameteri(a,m.TEXTURE_MIN_FILTER,X(c.mb)));gb&&c.type!==b.ej&&(1<c.Pb||c.Qp)&&(m.texParameterf(a,gb.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(c.Pb,$b)),c.Qp=c.Pb)}function S(a,b){m.bindRenderbuffer(m.RENDERBUFFER,a);b.ad&&!b.nd?(m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_COMPONENT16,b.width,b.height),m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,a)):b.ad&&
b.nd?(m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_STENCIL,b.width,b.height),m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,a)):m.renderbufferStorage(m.RENDERBUFFER,m.RGBA4,b.width,b.height)}function X(a){return a===b.wf||a===b.Dl||a===b.Cl?m.NEAREST:m.LINEAR}function aa(a){if(a===b.vd)return m.REPEAT;if(a===b.lg)return m.CLAMP_TO_EDGE;if(a===b.rj)return m.MIRRORED_REPEAT;if(a===b.wf)return m.NEAREST;if(a===b.Dl)return m.NEAREST_MIPMAP_NEAREST;if(a===b.Cl)return m.NEAREST_MIPMAP_LINEAR;
if(a===b.ye)return m.LINEAR;if(a===b.hp)return m.LINEAR_MIPMAP_NEAREST;if(a===b.oj)return m.LINEAR_MIPMAP_LINEAR;if(a===b.zj)return m.UNSIGNED_BYTE;if(a===b.Ip)return m.UNSIGNED_SHORT_4_4_4_4;if(a===b.Jp)return m.UNSIGNED_SHORT_5_5_5_1;if(a===b.Kp)return m.UNSIGNED_SHORT_5_6_5;if(a===b.To)return m.BYTE;if(a===b.yp)return m.SHORT;if(a===b.Lp)return m.UNSIGNED_SHORT;if(a===b.ep)return m.INT;if(a===b.Hp)return m.UNSIGNED_INT;if(a===b.ej)return m.FLOAT;if(a===b.Qo)return m.ALPHA;if(a===b.tj)return m.RGB;
if(a===b.Td)return m.RGBA;if(a===b.kp)return m.LUMINANCE;if(a===b.jp)return m.LUMINANCE_ALPHA;if(a===b.kl)return m.FUNC_ADD;if(a===b.Dp)return m.FUNC_SUBTRACT;if(a===b.wp)return m.FUNC_REVERSE_SUBTRACT;if(a===b.Np)return m.ZERO;if(a===b.pp)return m.ONE;if(a===b.Cp)return m.SRC_COLOR;if(a===b.sp)return m.ONE_MINUS_SRC_COLOR;if(a===b.Xl)return m.SRC_ALPHA;if(a===b.Gl)return m.ONE_MINUS_SRC_ALPHA;if(a===b.$o)return m.DST_ALPHA;if(a===b.qp)return m.ONE_MINUS_DST_ALPHA;if(a===b.ap)return m.DST_COLOR;if(a===
b.rp)return m.ONE_MINUS_DST_COLOR;if(a===b.Bp)return m.SRC_ALPHA_SATURATE;if(void 0!==Oa){if(a===b.Ol)return Oa.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===b.up)return Oa.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===b.Ml)return Oa.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===b.Nl)return Oa.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",b.Ll);a=a||{};var P=void 0!==a.canvas?a.canvas:document.createElement("canvas"),Y=void 0!==a.precision?a.precision:"highp",R=void 0!==a.alpha?a.alpha:!1,pa=void 0!==
a.premultipliedAlpha?a.premultipliedAlpha:!0,ma=void 0!==a.antialias?a.antialias:!1,va=void 0!==a.stencil?a.stencil:!0,U=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,V=new b.p(0);this.Mg=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.Aq=this.Ri=this.xq=this.wq=this.vq=this.Pj=!0;this.ff=this.Ym=this.cd=!1;this.qt=!0;this.sh=b.Hl;this.to=b.dj;this.Oi=this.Pi=!1;this.dh=8;this.Bi=4;this.yq=!0;this.io=
[];this.ho=[];this.info={memory:{Yn:0,Ra:0,Ib:0},w:{Zd:0,e:0,i:0,ca:0}};var B=this,ba=[],Aa=0,wa=null,da=null,ca=-1,T=null,ea=null,qb=0,ga=0,na=-1,La=-1,Ma=-1,qa=-1,ta=-1,Da=-1,Na=-1,Fa=-1,Ka=null,Va=null,Pa=null,Ba=null,xa=P.width,Ea=P.height,Ia=0,za=0,Ca={},Wa=new b.xe,hb=new b.$,xb=new b.$,ha=new b.a,ka=new b.a,Qa=!0,Lb={ya:[0,0,0],Qg:{length:0,va:[],Lc:[]},af:{length:0,va:[],Lc:[],Rg:[]},hc:{length:0,va:[],Lc:[],Rg:[],Pm:[],Bm:[],Sm:[]},Se:{length:0,xo:[],jn:[],Lc:[]}},m,Cb,Gb,gb,Oa;(function(){try{var a=
{alpha:R,premultipliedAlpha:pa,antialias:ma,stencil:va,preserveDrawingBuffer:U};m=P.getContext("webgl",a)||P.getContext("experimental-webgl",a);if(null===m)throw"Error creating WebGL context.";}catch(b){console.error(b)}Cb=m.getExtension("OES_texture_float");m.getExtension("OES_texture_float_linear");Gb=m.getExtension("OES_standard_derivatives");gb=m.getExtension("EXT_texture_filter_anisotropic")||m.getExtension("MOZ_EXT_texture_filter_anisotropic")||m.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
Oa=m.getExtension("WEBGL_compressed_texture_s3tc")||m.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||m.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");Cb||console.log("THREE.WebGLRenderer: Float textures not supported.");Gb||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");gb||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");Oa||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");void 0===m.getShaderPrecisionFormat&&
(m.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})})();m.clearColor(0,0,0,1);m.clearDepth(1);m.clearStencil(0);m.enable(m.DEPTH_TEST);m.depthFunc(m.LEQUAL);m.frontFace(m.CCW);m.cullFace(m.BACK);m.enable(m.CULL_FACE);m.enable(m.BLEND);m.blendEquation(m.FUNC_ADD);m.blendFunc(m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA);m.viewport(0,0,xa,Ea);m.clearColor(V.s,V.r,V.g,0);this.Mg=m;var Mb=m.getParameter(m.MAX_TEXTURE_IMAGE_UNITS);a=m.getParameter(m.MAX_VERTEX_TEXTURE_IMAGE_UNITS);
m.getParameter(m.MAX_TEXTURE_SIZE);var Zb=m.getParameter(m.MAX_CUBE_MAP_TEXTURE_SIZE),$b=gb?m.getParameter(gb.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Nb=0<a,Db=Nb&&Cb;Oa&&m.getParameter(m.COMPRESSED_TEXTURE_FORMATS);var wb=m.getShaderPrecisionFormat(m.FRAGMENT_SHADER,m.HIGH_FLOAT);a=m.getShaderPrecisionFormat(m.FRAGMENT_SHADER,m.MEDIUM_FLOAT);wb=0<m.getShaderPrecisionFormat(m.VERTEX_SHADER,m.HIGH_FLOAT).precision&&0<wb.precision;a=0<m.getShaderPrecisionFormat(m.VERTEX_SHADER,m.MEDIUM_FLOAT).precision&&
0<a.precision;"highp"!==Y||wb||(a?(Y="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(Y="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"!==Y||a||(Y="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return m};this.sk=function(){return Y};this.an=function(){return V};this.clear=function(a,b,c){var e=0;if(void 0===a||a)e|=m.COLOR_BUFFER_BIT;if(void 0===b||b)e|=m.DEPTH_BUFFER_BIT;
if(void 0===c||c)e|=m.STENCIL_BUFFER_BIT;m.clear(e)};this.clearColor=function(){m.clear(m.COLOR_BUFFER_BIT)};this.clearDepth=function(){m.clear(m.DEPTH_BUFFER_BIT)};this.clearStencil=function(){m.clear(m.STENCIL_BUFFER_BIT)};this.ym=function(a){a.$g(this);this.ho.push(a)};this.qq=function(a){a.$g(this);this.io.push(a)};this.Ys=function(a,c,e){a.Gr&&!a.Ab&&(a.Ab=m.createBuffer());a.Fr&&!a.He&&(a.He=m.createBuffer());a.Ir&&!a.rm&&(a.rm=m.createBuffer());a.Er&&!a.Fc&&(a.Fc=m.createBuffer());a.Gr&&(m.bindBuffer(m.ARRAY_BUFFER,
a.Ab),m.bufferData(m.ARRAY_BUFFER,a.Cx,m.DYNAMIC_DRAW),m.enableVertexAttribArray(c.attributes.position),m.vertexAttribPointer(c.attributes.position,3,m.FLOAT,!1,0,0));if(a.Fr){m.bindBuffer(m.ARRAY_BUFFER,a.He);if(e.Ga===b.og){var d,f,g,h,k,l,n,p,q,r,s,t=3*a.count;for(s=0;s<t;s+=9)r=a.ws,d=r[s],f=r[s+1],g=r[s+2],h=r[s+3],l=r[s+4],p=r[s+5],k=r[s+6],n=r[s+7],q=r[s+8],d=(d+h+k)/3,f=(f+l+n)/3,g=(g+p+q)/3,r[s]=d,r[s+1]=f,r[s+2]=g,r[s+3]=d,r[s+4]=f,r[s+5]=g,r[s+6]=d,r[s+7]=f,r[s+8]=g}m.bufferData(m.ARRAY_BUFFER,
a.ws,m.DYNAMIC_DRAW);m.enableVertexAttribArray(c.attributes.F);m.vertexAttribPointer(c.attributes.F,3,m.FLOAT,!1,0,0)}a.Ir&&e.map&&(m.bindBuffer(m.ARRAY_BUFFER,a.rm),m.bufferData(m.ARRAY_BUFFER,a.Oy,m.DYNAMIC_DRAW),m.enableVertexAttribArray(c.attributes.ic),m.vertexAttribPointer(c.attributes.ic,2,m.FLOAT,!1,0,0));a.Er&&e.u!==b.sg&&(m.bindBuffer(m.ARRAY_BUFFER,a.Fc),m.bufferData(m.ARRAY_BUFFER,a.Zu,m.DYNAMIC_DRAW),m.enableVertexAttribArray(c.attributes.color),m.vertexAttribPointer(c.attributes.color,
3,m.FLOAT,!1,0,0));m.drawArrays(m.TRIANGLES,0,a.count);a.count=0};this.Pk=function(a,c,e,d,f,g){if(!1!==d.visible){var h,k,l,n;h=I(a,c,e,d,g);c=h.attributes;a=f.attributes;e=!1;h=16777215*f.id+2*h.id+(d.W?1:0);h!==T&&(T=h,e=!0);e&&v();if(g instanceof b.U)if(g=a.index){f=f.Kd;1<f.length&&(e=!0);for(var p=0,r=f.length;p<r;p++){var s=f[p].index;if(e){for(k in c)l=c[k],h=a[k],0<=l&&(h?(n=h.fd,m.bindBuffer(m.ARRAY_BUFFER,h.buffer),q(l),m.vertexAttribPointer(l,n,m.FLOAT,!1,0,4*s*n)):d.ja&&(2===d.ja[k].length?
m.vertexAttrib2fv(l,d.ja[k]):3===d.ja[k].length&&m.vertexAttrib3fv(l,d.ja[k])));m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,g.buffer)}m.drawElements(m.TRIANGLES,f[p].count,m.UNSIGNED_SHORT,2*f[p].start);B.info.w.Zd++;B.info.w.e+=f[p].count;B.info.w.i+=f[p].count/3}}else{if(e)for(k in c)"index"!==k&&(l=c[k],h=a[k],0<=l&&(h?(n=h.fd,m.bindBuffer(m.ARRAY_BUFFER,h.buffer),q(l),m.vertexAttribPointer(l,n,m.FLOAT,!1,0,0)):d.ja&&d.ja[k]&&(2===d.ja[k].length?m.vertexAttrib2fv(l,d.ja[k]):3===d.ja[k].length&&m.vertexAttrib3fv(l,
d.ja[k]))));d=f.attributes.position;m.drawArrays(m.TRIANGLES,0,d.gd/3);B.info.w.Zd++;B.info.w.e+=d.gd/3;B.info.w.i+=d.gd/3/3}else if(g instanceof b.Sb){if(e)for(k in c)l=c[k],h=a[k],0<=l&&(h?(n=h.fd,m.bindBuffer(m.ARRAY_BUFFER,h.buffer),q(l),m.vertexAttribPointer(l,n,m.FLOAT,!1,0,0)):d.ja&&d.ja[k]&&(2===d.ja[k].length?m.vertexAttrib2fv(l,d.ja[k]):3===d.ja[k].length&&m.vertexAttrib3fv(l,d.ja[k])));d=a.position;m.drawArrays(m.POINTS,0,d.gd/3);B.info.w.Zd++;B.info.w.ca+=d.gd/3}else if(g instanceof b.fa){if(e)for(k in c)l=
c[k],h=a[k],0<=l&&(h?(n=h.fd,m.bindBuffer(m.ARRAY_BUFFER,h.buffer),q(l),m.vertexAttribPointer(l,n,m.FLOAT,!1,0,0)):d.ja&&d.ja[k]&&(2===d.ja[k].length?m.vertexAttrib2fv(l,d.ja[k]):3===d.ja[k].length&&m.vertexAttrib3fv(l,d.ja[k])));k=g.type===b.nj?m.LINE_STRIP:m.LINES;A(d.Eb);d=a.position;m.drawArrays(k,0,d.gd/3);B.info.w.Zd++;B.info.w.ca+=d.gd}}};this.Ok=function(a,c,e,d,f,g){if(!1!==d.visible){var h,k;e=I(a,c,e,d,g);a=e.attributes;c=!1;e=16777215*f.id+2*e.id+(d.W?1:0);e!==T&&(T=e,c=!0);c&&v();if(!d.A&&
0<=a.position)c&&(m.bindBuffer(m.ARRAY_BUFFER,f.Ab),q(a.position),m.vertexAttribPointer(a.position,3,m.FLOAT,!1,0,0));else if(g.Dk){e=d.xb.attributes;-1!==g.Dk&&0<=e.position?(m.bindBuffer(m.ARRAY_BUFFER,f.Cf[g.Dk]),q(e.position),m.vertexAttribPointer(e.position,3,m.FLOAT,!1,0,0)):0<=e.position&&(m.bindBuffer(m.ARRAY_BUFFER,f.Ab),q(e.position),m.vertexAttribPointer(e.position,3,m.FLOAT,!1,0,0));if(g.Ln.length){var l=0;k=g.Ln;for(h=g.Kc;l<d.jh&&l<k.length;)0<=e["morphTarget"+l]&&(m.bindBuffer(m.ARRAY_BUFFER,
f.Cf[k[l]]),q(e["morphTarget"+l]),m.vertexAttribPointer(e["morphTarget"+l],3,m.FLOAT,!1,0,0)),0<=e["morphNormal"+l]&&d.pa&&(m.bindBuffer(m.ARRAY_BUFFER,f.zg[k[l]]),q(e["morphNormal"+l]),m.vertexAttribPointer(e["morphNormal"+l],3,m.FLOAT,!1,0,0)),g.Ag[l]=h[k[l]],l++}else{k=[];h=g.Kc;var n,p=h.length;for(n=0;n<p;n++)l=h[n],0<l&&k.push([l,n]);k.length>d.jh?(k.sort(s),k.length=d.jh):k.length>d.Qn?k.sort(s):0===k.length&&k.push([0,0]);for(l=0;l<d.jh;)k[l]?(n=k[l][1],0<=e["morphTarget"+l]&&(m.bindBuffer(m.ARRAY_BUFFER,
f.Cf[n]),q(e["morphTarget"+l]),m.vertexAttribPointer(e["morphTarget"+l],3,m.FLOAT,!1,0,0)),0<=e["morphNormal"+l]&&d.pa&&(m.bindBuffer(m.ARRAY_BUFFER,f.zg[n]),q(e["morphNormal"+l]),m.vertexAttribPointer(e["morphNormal"+l],3,m.FLOAT,!1,0,0)),g.Ag[l]=h[n]):g.Ag[l]=0,l++}null!==d.xb.Q.Kc&&m.uniform1fv(d.xb.Q.Kc,g.Ag)}if(c){if(f.Mb)for(h=0,k=f.Mb.length;h<k;h++)e=f.Mb[h],0<=a[e.buffer.ai]&&(m.bindBuffer(m.ARRAY_BUFFER,e.buffer),q(a[e.buffer.ai]),m.vertexAttribPointer(a[e.buffer.ai],e.size,m.FLOAT,!1,0,
0));0<=a.color&&(0<g.j.va.length||0<g.j.i.length?(m.bindBuffer(m.ARRAY_BUFFER,f.Fc),q(a.color),m.vertexAttribPointer(a.color,3,m.FLOAT,!1,0,0)):d.ja&&m.vertexAttrib3fv(a.color,d.ja.color));0<=a.F&&(m.bindBuffer(m.ARRAY_BUFFER,f.He),q(a.F),m.vertexAttribPointer(a.F,3,m.FLOAT,!1,0,0));0<=a.zo&&(m.bindBuffer(m.ARRAY_BUFFER,f.Th),q(a.zo),m.vertexAttribPointer(a.zo,4,m.FLOAT,!1,0,0));0<=a.ic&&(g.j.v[0]?(m.bindBuffer(m.ARRAY_BUFFER,f.Vh),q(a.ic),m.vertexAttribPointer(a.ic,2,m.FLOAT,!1,0,0)):d.ja&&m.vertexAttrib2fv(a.ic,
d.ja.ic));0<=a.Wi&&(g.j.v[1]?(m.bindBuffer(m.ARRAY_BUFFER,f.Uh),q(a.Wi),m.vertexAttribPointer(a.Wi,2,m.FLOAT,!1,0,0)):d.ja&&m.vertexAttrib2fv(a.Wi,d.ja.Wi));d.Ea&&0<=a.vo&&0<=a.wo&&(m.bindBuffer(m.ARRAY_BUFFER,f.Rh),q(a.vo),m.vertexAttribPointer(a.vo,4,m.FLOAT,!1,0,0),m.bindBuffer(m.ARRAY_BUFFER,f.Sh),q(a.wo),m.vertexAttribPointer(a.wo,4,m.FLOAT,!1,0,0));0<=a.wn&&(m.bindBuffer(m.ARRAY_BUFFER,f.Qh),q(a.wn),m.vertexAttribPointer(a.wn,1,m.FLOAT,!1,0,0))}g instanceof b.U?(d.W?(A(d.Na),c&&m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,
f.Ph),m.drawElements(m.LINES,f.Gj,m.UNSIGNED_SHORT,0)):(c&&m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,f.Oh),m.drawElements(m.TRIANGLES,f.Dj,m.UNSIGNED_SHORT,0)),B.info.w.Zd++,B.info.w.e+=f.Dj,B.info.w.i+=f.Dj/3):g instanceof b.fa?(g=g.type===b.nj?m.LINE_STRIP:m.LINES,A(d.Eb),m.drawArrays(g,0,f.Gj),B.info.w.Zd++):g instanceof b.Sb&&(m.drawArrays(m.POINTS,0,f.qm),B.info.w.Zd++,B.info.w.ca+=f.qm)}};this.w=function(a,c,e,d){if(!1===c instanceof b.fb)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
else{var f,g,h,k,l=a.Ub,n=a.H;ca=-1;Qa=!0;!0===a.Gf&&a.Fa();void 0===c.parent&&c.Fa();c.Ta.Fd(c.l);hb.La(c.xa,c.Ta);Wa.Ki(hb);this.Aq&&this.Nr(a);x(this.io,a,c);B.info.w.Zd=0;B.info.w.e=0;B.info.w.i=0;B.info.w.ca=0;this.Xk(e);(this.Pj||d)&&this.clear(this.vq,this.wq,this.xq);k=a.Vb;d=0;for(f=k.length;d<f;d++)if(g=k[d],h=g.object,g.id=d,g.w=!1,h.visible&&(!(h instanceof b.U||h instanceof b.Sb)||!h.Re||Wa.ti(h))){var p=h;p.wc.La(c.Ta,p.l);p.Jj.dd(p.wc);var p=g,q=p.buffer,r=void 0,s=r=void 0,s=p.object.D;
if(s instanceof b.qc)r=q.fc,r=s.Z[r],r.Ha?(p.Ha=r,p.Ze=null):(p.Ze=r,p.Ha=null);else if(r=s)r.Ha?(p.Ha=r,p.Ze=null):(p.Ze=r,p.Ha=null);g.w=!0;!0===this.Ri&&(null!==h.dg?g.z=h.dg:(ha.Ua(h.l),ha.Ke(hb),g.z=ha.z))}this.Ri&&k.sort(u);k=a.Ud;d=0;for(f=k.length;d<f;d++)g=k[d],h=g.object,h.visible&&(h.wc.La(c.Ta,h.l),h.Jj.dd(h.wc),h=g.object.D,h.Ha?(g.Ha=h,g.Ze=null):(g.Ze=h,g.Ha=null));a.kh?(d=a.kh,this.fg(d.bb,d.blendEquation,d.Oe,d.Ne),this.cf(d.Cd),this.nh(d.Dd),J(d.polygonOffset,d.lh,d.mh),z(a.Vb,!1,
"",c,l,n,!0,d),t(a.Ud,"",c,l,n,!1,d)):(d=null,this.fg(b.El),z(a.Vb,!0,"opaque",c,l,n,!1,d),t(a.Ud,"opaque",c,l,n,!1,d),z(a.Vb,!1,"transparent",c,l,n,!0,d),t(a.Ud,"transparent",c,l,n,!0,d));x(this.ho,a,c);e&&e.Db&&e.mb!==b.wf&&e.mb!==b.ye&&(e instanceof b.Fe?(m.bindTexture(m.TEXTURE_CUBE_MAP,e.Wb),m.generateMipmap(m.TEXTURE_CUBE_MAP),m.bindTexture(m.TEXTURE_CUBE_MAP,null)):(m.bindTexture(m.TEXTURE_2D,e.Wb),m.generateMipmap(m.TEXTURE_2D),m.bindTexture(m.TEXTURE_2D,null)));this.cf(!0);this.nh(!0)}};
this.Qk=function(a,b,c,e,d){var f=I(a,b,c,e,d);T=-1;B.Wk(e);d.wk?d.wk(f,m,Wa):d.w(function(a){B.Ys(a,f,e)})};this.Nr=function(a){a.Vb||(a.Vb=[],a.Ud=[],a.Hj=[],a.Ej=[]);for(;a.zf.length;)w(a.zf[0],a),a.zf.splice(0,1);for(;a.Af.length;)Q(a.Af[0],a),a.Af.splice(0,1);for(var c=0,e=a.Vb.length;c<e;c++){var d=a.Vb[c].object;void 0===d.zd&&(void 0!==d.Cj&&Q(d,a),w(d,a));var f=d,g=f.j,h=void 0,k=void 0,q=void 0;if(g instanceof b.qb){var t=m.DYNAMIC_DRAW,v=!g.ji,u=g.attributes,x=void 0,z=void 0;for(x in u)z=
u[x],z.ga&&("index"===x?(m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,z.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,z.c,t)):(m.bindBuffer(m.ARRAY_BUFFER,z.buffer),m.bufferData(m.ARRAY_BUFFER,z.c,t)),z.ga=!1),v&&!z.ji&&(z.c=null)}else if(f instanceof b.U){for(var A=0,I=g.qk.length;A<I;A++)if(h=g.qk[A],q=l(f,h),g.Fm&&n(h,f),k=q.attributes&&H(q),g.$a||g.Ek||g.ki||g.Xi||g.Yf||g.ac||g.xh||k){var y=h,C=m.DYNAMIC_DRAW,E=!g.ji,D=q;if(y.gm){var F=p(D),G=D.u?D.u:!1,K=r(D),M=F===b.Vc,B=void 0,J=void 0,R=void 0,U=void 0,
W=void 0,S=void 0,da=void 0,X=void 0,ba=void 0,Y=void 0,ca=void 0,P=void 0,V=void 0,T=void 0,aa=void 0,ea=void 0,ga=void 0,Aa=void 0,wa=void 0,ka=void 0,na=void 0,ma=void 0,pa=void 0,ta=void 0,Ua=void 0,va=void 0,xa=void 0,Ba=void 0,Ca=void 0,Ja=void 0,Ma=void 0,Fa=void 0,Ia=void 0,La=void 0,qa=void 0,Ka=void 0,za=void 0,Da=void 0,Na=void 0,Pa=void 0,Ea=0,fb=0,Qa=0,Va=0,Wa=0,ib=0,Ya=0,Oa=0,cb=0,ya=0,Ga=0,O=0,Xa=void 0,jb=y.Bf,qb=y.pm,gb=y.om,yb=y.km,Za=y.nm,kb=y.yf,$a=y.lm,ab=y.mm,Cb=y.jm,Db=y.im,
wb=y.Mb,L=void 0,Pb=y.fm,zb=y.hm,Ra=f.j,Lb=Ra.ki,Gb=Ra.Xi,Mb=Ra.Yf,Nb=Ra.xh,Zb=Ra.ac,$b=Ra.Ek,ec=Ra.e,ia=y.Vm,lb=Ra.i,kc=Ra.v[0],lc=Ra.v[1],fc=Ra.pe,Qb=Ra.qe,Rb=Ra.A,mc=Ra.pa;if(Ra.$a){B=0;for(J=ia.length;B<J;B++)U=lb[ia[B]],P=ec[U.I],V=ec[U.g],T=ec[U.J],jb[fb]=P.x,jb[fb+1]=P.y,jb[fb+2]=P.z,jb[fb+3]=V.x,jb[fb+4]=V.y,jb[fb+5]=V.z,jb[fb+6]=T.x,jb[fb+7]=T.y,jb[fb+8]=T.z,fb+=9;m.bindBuffer(m.ARRAY_BUFFER,y.Ab);m.bufferData(m.ARRAY_BUFFER,jb,C)}if($b)for(qa=0,Ka=Rb.length;qa<Ka;qa++){B=Ga=0;for(J=ia.length;B<
J;B++)Na=ia[B],U=lb[Na],P=Rb[qa].e[U.I],V=Rb[qa].e[U.g],T=Rb[qa].e[U.J],za=Cb[qa],za[Ga]=P.x,za[Ga+1]=P.y,za[Ga+2]=P.z,za[Ga+3]=V.x,za[Ga+4]=V.y,za[Ga+5]=V.z,za[Ga+6]=T.x,za[Ga+7]=T.y,za[Ga+8]=T.z,D.pa&&(M?(Pa=mc[qa].V[Na],Aa=Pa.I,wa=Pa.g,ka=Pa.J):ka=wa=Aa=mc[qa].nk[Na],Da=Db[qa],Da[Ga]=Aa.x,Da[Ga+1]=Aa.y,Da[Ga+2]=Aa.z,Da[Ga+3]=wa.x,Da[Ga+4]=wa.y,Da[Ga+5]=wa.z,Da[Ga+6]=ka.x,Da[Ga+7]=ka.y,Da[Ga+8]=ka.z),Ga+=9;m.bindBuffer(m.ARRAY_BUFFER,y.Cf[qa]);m.bufferData(m.ARRAY_BUFFER,Cb[qa],C);D.pa&&(m.bindBuffer(m.ARRAY_BUFFER,
y.zg[qa]),m.bufferData(m.ARRAY_BUFFER,Db[qa],C))}if(Qb.length){B=0;for(J=ia.length;B<J;B++)U=lb[ia[B]],ta=Qb[U.I],Ua=Qb[U.g],va=Qb[U.J],ab[ya]=ta.x,ab[ya+1]=ta.y,ab[ya+2]=ta.z,ab[ya+3]=ta.f,ab[ya+4]=Ua.x,ab[ya+5]=Ua.y,ab[ya+6]=Ua.z,ab[ya+7]=Ua.f,ab[ya+8]=va.x,ab[ya+9]=va.y,ab[ya+10]=va.z,ab[ya+11]=va.f,xa=fc[U.I],Ba=fc[U.g],Ca=fc[U.J],$a[ya]=xa.x,$a[ya+1]=xa.y,$a[ya+2]=xa.z,$a[ya+3]=xa.f,$a[ya+4]=Ba.x,$a[ya+5]=Ba.y,$a[ya+6]=Ba.z,$a[ya+7]=Ba.f,$a[ya+8]=Ca.x,$a[ya+9]=Ca.y,$a[ya+10]=Ca.z,$a[ya+11]=Ca.f,
ya+=12;0<ya&&(m.bindBuffer(m.ARRAY_BUFFER,y.Rh),m.bufferData(m.ARRAY_BUFFER,$a,C),m.bindBuffer(m.ARRAY_BUFFER,y.Sh),m.bufferData(m.ARRAY_BUFFER,ab,C))}if(Zb&&G){B=0;for(J=ia.length;B<J;B++)U=lb[ia[B]],da=U.u,X=U.color,3===da.length&&G===b.De?(na=da[0],ma=da[1],pa=da[2]):pa=ma=na=X,kb[cb]=na.s,kb[cb+1]=na.r,kb[cb+2]=na.g,kb[cb+3]=ma.s,kb[cb+4]=ma.r,kb[cb+5]=ma.g,kb[cb+6]=pa.s,kb[cb+7]=pa.r,kb[cb+8]=pa.g,cb+=9;0<cb&&(m.bindBuffer(m.ARRAY_BUFFER,y.Fc),m.bufferData(m.ARRAY_BUFFER,kb,C))}if(Nb&&Ra.Uf){B=
0;for(J=ia.length;B<J;B++)U=lb[ia[B]],ba=U.se,aa=ba[0],ea=ba[1],ga=ba[2],Za[Ya]=aa.x,Za[Ya+1]=aa.y,Za[Ya+2]=aa.z,Za[Ya+3]=aa.f,Za[Ya+4]=ea.x,Za[Ya+5]=ea.y,Za[Ya+6]=ea.z,Za[Ya+7]=ea.f,Za[Ya+8]=ga.x,Za[Ya+9]=ga.y,Za[Ya+10]=ga.z,Za[Ya+11]=ga.f,Ya+=12;m.bindBuffer(m.ARRAY_BUFFER,y.Th);m.bufferData(m.ARRAY_BUFFER,Za,C)}if(Mb&&F){B=0;for(J=ia.length;B<J;B++)if(U=lb[ia[B]],W=U.V,S=U.F,3===W.length&&M)for(Ja=0;3>Ja;Ja++)Fa=W[Ja],yb[ib]=Fa.x,yb[ib+1]=Fa.y,yb[ib+2]=Fa.z,ib+=3;else for(Ja=0;3>Ja;Ja++)yb[ib]=
S.x,yb[ib+1]=S.y,yb[ib+2]=S.z,ib+=3;m.bindBuffer(m.ARRAY_BUFFER,y.He);m.bufferData(m.ARRAY_BUFFER,yb,C)}if(Gb&&kc&&K){B=0;for(J=ia.length;B<J;B++)if(R=ia[B],Y=kc[R],void 0!==Y)for(Ja=0;3>Ja;Ja++)Ia=Y[Ja],qb[Qa]=Ia.x,qb[Qa+1]=Ia.y,Qa+=2;0<Qa&&(m.bindBuffer(m.ARRAY_BUFFER,y.Vh),m.bufferData(m.ARRAY_BUFFER,qb,C))}if(Gb&&lc&&K){B=0;for(J=ia.length;B<J;B++)if(R=ia[B],ca=lc[R],void 0!==ca)for(Ja=0;3>Ja;Ja++)La=ca[Ja],gb[Va]=La.x,gb[Va+1]=La.y,Va+=2;0<Va&&(m.bindBuffer(m.ARRAY_BUFFER,y.Uh),m.bufferData(m.ARRAY_BUFFER,
gb,C))}if(Lb){B=0;for(J=ia.length;B<J;B++)Pb[Wa]=Ea,Pb[Wa+1]=Ea+1,Pb[Wa+2]=Ea+2,Wa+=3,zb[Oa]=Ea,zb[Oa+1]=Ea+1,zb[Oa+2]=Ea,zb[Oa+3]=Ea+2,zb[Oa+4]=Ea+1,zb[Oa+5]=Ea+2,Oa+=6,Ea+=3;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,y.Oh);m.bufferData(m.ELEMENT_ARRAY_BUFFER,Pb,C);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,y.Ph);m.bufferData(m.ELEMENT_ARRAY_BUFFER,zb,C)}if(wb)for(Ja=0,Ma=wb.length;Ja<Ma;Ja++)if(L=wb[Ja],L.Rp.ga){O=0;if(1===L.size)if(void 0===L.Xa||"vertices"===L.Xa)for(B=0,J=ia.length;B<J;B++)U=lb[ia[B]],L.c[O]=
L.value[U.I],L.c[O+1]=L.value[U.g],L.c[O+2]=L.value[U.J],O+=3;else{if("faces"===L.Xa)for(B=0,J=ia.length;B<J;B++)Xa=L.value[ia[B]],L.c[O]=Xa,L.c[O+1]=Xa,L.c[O+2]=Xa,O+=3}else if(2===L.size)if(void 0===L.Xa||"vertices"===L.Xa)for(B=0,J=ia.length;B<J;B++)U=lb[ia[B]],P=L.value[U.I],V=L.value[U.g],T=L.value[U.J],L.c[O]=P.x,L.c[O+1]=P.y,L.c[O+2]=V.x,L.c[O+3]=V.y,L.c[O+4]=T.x,L.c[O+5]=T.y,O+=6;else{if("faces"===L.Xa)for(B=0,J=ia.length;B<J;B++)T=V=P=Xa=L.value[ia[B]],L.c[O]=P.x,L.c[O+1]=P.y,L.c[O+2]=V.x,
L.c[O+3]=V.y,L.c[O+4]=T.x,L.c[O+5]=T.y,O+=6}else if(3===L.size){var ua;ua="c"===L.type?["r","g","b"]:["x","y","z"];if(void 0===L.Xa||"vertices"===L.Xa)for(B=0,J=ia.length;B<J;B++)U=lb[ia[B]],P=L.value[U.I],V=L.value[U.g],T=L.value[U.J],L.c[O]=P[ua[0]],L.c[O+1]=P[ua[1]],L.c[O+2]=P[ua[2]],L.c[O+3]=V[ua[0]],L.c[O+4]=V[ua[1]],L.c[O+5]=V[ua[2]],L.c[O+6]=T[ua[0]],L.c[O+7]=T[ua[1]],L.c[O+8]=T[ua[2]],O+=9;else if("faces"===L.Xa)for(B=0,J=ia.length;B<J;B++)T=V=P=Xa=L.value[ia[B]],L.c[O]=P[ua[0]],L.c[O+1]=
P[ua[1]],L.c[O+2]=P[ua[2]],L.c[O+3]=V[ua[0]],L.c[O+4]=V[ua[1]],L.c[O+5]=V[ua[2]],L.c[O+6]=T[ua[0]],L.c[O+7]=T[ua[1]],L.c[O+8]=T[ua[2]],O+=9;else if("faceVertices"===L.Xa)for(B=0,J=ia.length;B<J;B++)Xa=L.value[ia[B]],P=Xa[0],V=Xa[1],T=Xa[2],L.c[O]=P[ua[0]],L.c[O+1]=P[ua[1]],L.c[O+2]=P[ua[2]],L.c[O+3]=V[ua[0]],L.c[O+4]=V[ua[1]],L.c[O+5]=V[ua[2]],L.c[O+6]=T[ua[0]],L.c[O+7]=T[ua[1]],L.c[O+8]=T[ua[2]],O+=9}else if(4===L.size)if(void 0===L.Xa||"vertices"===L.Xa)for(B=0,J=ia.length;B<J;B++)U=lb[ia[B]],P=
L.value[U.I],V=L.value[U.g],T=L.value[U.J],L.c[O]=P.x,L.c[O+1]=P.y,L.c[O+2]=P.z,L.c[O+3]=P.f,L.c[O+4]=V.x,L.c[O+5]=V.y,L.c[O+6]=V.z,L.c[O+7]=V.f,L.c[O+8]=T.x,L.c[O+9]=T.y,L.c[O+10]=T.z,L.c[O+11]=T.f,O+=12;else if("faces"===L.Xa)for(B=0,J=ia.length;B<J;B++)T=V=P=Xa=L.value[ia[B]],L.c[O]=P.x,L.c[O+1]=P.y,L.c[O+2]=P.z,L.c[O+3]=P.f,L.c[O+4]=V.x,L.c[O+5]=V.y,L.c[O+6]=V.z,L.c[O+7]=V.f,L.c[O+8]=T.x,L.c[O+9]=T.y,L.c[O+10]=T.z,L.c[O+11]=T.f,O+=12;else if("faceVertices"===L.Xa)for(B=0,J=ia.length;B<J;B++)Xa=
L.value[ia[B]],P=Xa[0],V=Xa[1],T=Xa[2],L.c[O]=P.x,L.c[O+1]=P.y,L.c[O+2]=P.z,L.c[O+3]=P.f,L.c[O+4]=V.x,L.c[O+5]=V.y,L.c[O+6]=V.z,L.c[O+7]=V.f,L.c[O+8]=T.x,L.c[O+9]=T.y,L.c[O+10]=T.z,L.c[O+11]=T.f,O+=12;m.bindBuffer(m.ARRAY_BUFFER,L.buffer);m.bufferData(m.ARRAY_BUFFER,L.c,C)}E&&(delete y.gm,delete y.yf,delete y.km,delete y.nm,delete y.pm,delete y.om,delete y.fm,delete y.Bf,delete y.hm,delete y.lm,delete y.mm)}}g.$a=!1;g.Ek=!1;g.ki=!1;g.Xi=!1;g.Yf=!1;g.ac=!1;g.xh=!1;g.Fm=!1;q.attributes&&N(q)}else if(f instanceof
b.fa){q=l(f,g);k=q.attributes&&H(q);if(g.$a||g.ac||g.yi||k){var bb=g,Sb=m.DYNAMIC_DRAW,Hb=void 0,Ib=void 0,Jb=void 0,Tb=void 0,sa=void 0,Ub=void 0,nc=bb.e,oc=bb.va,pc=bb.Wr,wc=nc.length,xc=oc.length,yc=pc.length,Vb=bb.Bf,Wb=bb.yf,qc=bb.Pp,zc=bb.ac,Ac=bb.yi,gc=bb.Mb,Xb=void 0,rc=void 0,Ha=void 0,Eb=void 0,Sa=void 0,ra=void 0;if(bb.$a){for(Hb=0;Hb<wc;Hb++)Tb=nc[Hb],sa=3*Hb,Vb[sa]=Tb.x,Vb[sa+1]=Tb.y,Vb[sa+2]=Tb.z;m.bindBuffer(m.ARRAY_BUFFER,bb.Ab);m.bufferData(m.ARRAY_BUFFER,Vb,Sb)}if(zc){for(Ib=0;Ib<
xc;Ib++)Ub=oc[Ib],sa=3*Ib,Wb[sa]=Ub.s,Wb[sa+1]=Ub.r,Wb[sa+2]=Ub.g;m.bindBuffer(m.ARRAY_BUFFER,bb.Fc);m.bufferData(m.ARRAY_BUFFER,Wb,Sb)}if(Ac){for(Jb=0;Jb<yc;Jb++)qc[Jb]=pc[Jb];m.bindBuffer(m.ARRAY_BUFFER,bb.Qh);m.bufferData(m.ARRAY_BUFFER,qc,Sb)}if(gc)for(Xb=0,rc=gc.length;Xb<rc;Xb++)if(ra=gc[Xb],ra.ga&&(void 0===ra.Xa||"vertices"===ra.Xa)){sa=0;Eb=ra.value.length;if(1===ra.size)for(Ha=0;Ha<Eb;Ha++)ra.c[Ha]=ra.value[Ha];else if(2===ra.size)for(Ha=0;Ha<Eb;Ha++)Sa=ra.value[Ha],ra.c[sa]=Sa.x,ra.c[sa+
1]=Sa.y,sa+=2;else if(3===ra.size)if("c"===ra.type)for(Ha=0;Ha<Eb;Ha++)Sa=ra.value[Ha],ra.c[sa]=Sa.s,ra.c[sa+1]=Sa.r,ra.c[sa+2]=Sa.g,sa+=3;else for(Ha=0;Ha<Eb;Ha++)Sa=ra.value[Ha],ra.c[sa]=Sa.x,ra.c[sa+1]=Sa.y,ra.c[sa+2]=Sa.z,sa+=3;else if(4===ra.size)for(Ha=0;Ha<Eb;Ha++)Sa=ra.value[Ha],ra.c[sa]=Sa.x,ra.c[sa+1]=Sa.y,ra.c[sa+2]=Sa.z,ra.c[sa+3]=Sa.f,sa+=4;m.bindBuffer(m.ARRAY_BUFFER,ra.buffer);m.bufferData(m.ARRAY_BUFFER,ra.c,Sb)}}g.$a=!1;g.ac=!1;g.yi=!1;q.attributes&&N(q)}else if(f instanceof b.Sb){q=
l(f,g);k=q.attributes&&H(q);if(g.$a||g.ac||f.gf||k){var mb=g,hc=m.DYNAMIC_DRAW,Kb=f,Ta=void 0,nb=void 0,ob=void 0,$=void 0,pb=void 0,vb=void 0,Yb=mb.e,ic=Yb.length,jc=mb.va,sc=jc.length,Ab=mb.Bf,Bb=mb.yf,rb=mb.Tp,tc=mb.$a,uc=mb.ac,sb=mb.Mb,db=void 0,Fb=void 0,fa=void 0,eb=void 0,oa=void 0,Z=void 0;if(Kb.gf){xb.copy(hb);xb.multiply(Kb.l);for(Ta=0;Ta<ic;Ta++)ob=Yb[Ta],ha.copy(ob),ha.Ke(xb),rb[Ta]=[ha.z,Ta];rb.sort(s);for(Ta=0;Ta<ic;Ta++)ob=Yb[rb[Ta][1]],$=3*Ta,Ab[$]=ob.x,Ab[$+1]=ob.y,Ab[$+2]=ob.z;for(nb=
0;nb<sc;nb++)$=3*nb,vb=jc[rb[nb][1]],Bb[$]=vb.s,Bb[$+1]=vb.r,Bb[$+2]=vb.g;if(sb)for(db=0,Fb=sb.length;db<Fb;db++)if(Z=sb[db],void 0===Z.Xa||"vertices"===Z.Xa)if($=0,eb=Z.value.length,1===Z.size)for(fa=0;fa<eb;fa++)pb=rb[fa][1],Z.c[fa]=Z.value[pb];else if(2===Z.size)for(fa=0;fa<eb;fa++)pb=rb[fa][1],oa=Z.value[pb],Z.c[$]=oa.x,Z.c[$+1]=oa.y,$+=2;else if(3===Z.size)if("c"===Z.type)for(fa=0;fa<eb;fa++)pb=rb[fa][1],oa=Z.value[pb],Z.c[$]=oa.s,Z.c[$+1]=oa.r,Z.c[$+2]=oa.g,$+=3;else for(fa=0;fa<eb;fa++)pb=
rb[fa][1],oa=Z.value[pb],Z.c[$]=oa.x,Z.c[$+1]=oa.y,Z.c[$+2]=oa.z,$+=3;else if(4===Z.size)for(fa=0;fa<eb;fa++)pb=rb[fa][1],oa=Z.value[pb],Z.c[$]=oa.x,Z.c[$+1]=oa.y,Z.c[$+2]=oa.z,Z.c[$+3]=oa.f,$+=4}else{if(tc)for(Ta=0;Ta<ic;Ta++)ob=Yb[Ta],$=3*Ta,Ab[$]=ob.x,Ab[$+1]=ob.y,Ab[$+2]=ob.z;if(uc)for(nb=0;nb<sc;nb++)vb=jc[nb],$=3*nb,Bb[$]=vb.s,Bb[$+1]=vb.r,Bb[$+2]=vb.g;if(sb)for(db=0,Fb=sb.length;db<Fb;db++)if(Z=sb[db],Z.ga&&(void 0===Z.Xa||"vertices"===Z.Xa))if(eb=Z.value.length,$=0,1===Z.size)for(fa=0;fa<
eb;fa++)Z.c[fa]=Z.value[fa];else if(2===Z.size)for(fa=0;fa<eb;fa++)oa=Z.value[fa],Z.c[$]=oa.x,Z.c[$+1]=oa.y,$+=2;else if(3===Z.size)if("c"===Z.type)for(fa=0;fa<eb;fa++)oa=Z.value[fa],Z.c[$]=oa.s,Z.c[$+1]=oa.r,Z.c[$+2]=oa.g,$+=3;else for(fa=0;fa<eb;fa++)oa=Z.value[fa],Z.c[$]=oa.x,Z.c[$+1]=oa.y,Z.c[$+2]=oa.z,$+=3;else if(4===Z.size)for(fa=0;fa<eb;fa++)oa=Z.value[fa],Z.c[$]=oa.x,Z.c[$+1]=oa.y,Z.c[$+2]=oa.z,Z.c[$+3]=oa.f,$+=4}if(tc||Kb.gf)m.bindBuffer(m.ARRAY_BUFFER,mb.Ab),m.bufferData(m.ARRAY_BUFFER,
Ab,hc);if(uc||Kb.gf)m.bindBuffer(m.ARRAY_BUFFER,mb.Fc),m.bufferData(m.ARRAY_BUFFER,Bb,hc);if(sb)for(db=0,Fb=sb.length;db<Fb;db++)if(Z=sb[db],Z.ga||Kb.gf)m.bindBuffer(m.ARRAY_BUFFER,Z.buffer),m.bufferData(m.ARRAY_BUFFER,Z.c,hc)}g.$a=!1;g.ac=!1;q.attributes&&N(q)}}};this.Lr=function(a,c,e,f){var g,h,k,l;a.addEventListener("dispose",d);var n,p,q,r,s;a instanceof b.Ae?s="depth":a instanceof b.vf?s="normal":a instanceof b.Kb?s="basic":a instanceof b.Uc?s="lambert":a instanceof b.Ec?s="phong":a instanceof
b.ab?s="basic":a instanceof b.uf?s="dashed":a instanceof b.Sd&&(s="particle_basic");if(s){var t=b.tg[s];a.Q=b.uc.b(t.Q);a.R=t.R;a.P=t.P}var v=g=0,u=0,x=t=0;for(h=c.length;x<h;x++)k=c[x],k.me||(k instanceof b.zb&&g++,k instanceof b.ud&&v++,k instanceof b.Wc&&u++,k instanceof b.rf&&t++);h=v;k=u;l=t;u=t=0;for(v=c.length;u<v;u++)x=c[u],x.tb&&(x instanceof b.Wc&&t++,x instanceof b.zb&&!x.bl&&t++);r=t;Db&&f&&f.Od?q=1024:(c=m.getParameter(m.MAX_VERTEX_UNIFORM_VECTORS),c=Math.floor((c-20)/4),void 0!==f&&
f instanceof b.sc&&(c=Math.min(f.Qa.length,c),c<f.Qa.length&&console.warn("WebGLRenderer: too many bones - "+f.Qa.length+", this GPU supports just "+c+" (try OpenGL instead of ANGLE)")),q=c);a:{u=a.P;v=a.R;t=a.Q;c=a.attributes;x=a.hk;e={map:!!a.map,Aa:!!a.Aa,Sa:!!a.Sa,Rb:!!a.Rb,nb:!!a.nb,Ma:!!a.Ma,u:a.u,H:e,Lo:a.H,pr:e instanceof b.qf,vh:a.vh,Ea:a.Ea,ks:q,Od:Db&&f&&f.Od,A:a.A,pa:a.pa,dh:this.dh,Bi:this.Bi,Gn:g,In:h,Kn:k,Hn:l,Jn:r,ff:this.ff&&f.cg,sh:this.sh,Pi:this.Pi,Oi:this.Oi,Ie:a.Ie,eh:a.eh,$f:a.$f,
Sc:a.Sc,kk:a.zc===b.we,ok:a.zc===b.nf};f=a.Kr;var w,z,y;g=[];s?g.push(s):(g.push(u),g.push(v));for(z in x)g.push(z),g.push(x[z]);for(w in e)g.push(w),g.push(e[w]);s=g.join();w=0;for(z=ba.length;w<z;w++)if(g=ba[w],g.code===s){g.jl++;p=g.xb;break a}w="SHADOWMAP_TYPE_BASIC";e.sh===b.Hl?w="SHADOWMAP_TYPE_PCF":e.sh===b.Il&&(w="SHADOWMAP_TYPE_PCF_SOFT");z=[];for(y in x)g=x[y],!1!==g&&(g="#define "+y+" "+g,z.push(g));g=z.join("\n");y=m.createProgram();z=["precision "+Y+" float;","precision "+Y+" int;",e.Rb||
e.nb?"#extension GL_OES_standard_derivatives : enable":"",g,"#define MAX_DIR_LIGHTS "+e.Gn,"#define MAX_POINT_LIGHTS "+e.In,"#define MAX_SPOT_LIGHTS "+e.Kn,"#define MAX_HEMI_LIGHTS "+e.Hn,"#define MAX_SHADOWS "+e.Jn,e.Ie?"#define ALPHATEST "+e.Ie:"",B.cd?"#define GAMMA_INPUT":"",B.Ym?"#define GAMMA_OUTPUT":"",e.Lo&&e.H?"#define USE_FOG":"",e.Lo&&e.pr?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.Aa?"#define USE_ENVMAP":"",e.Sa?"#define USE_LIGHTMAP":"",e.Rb?"#define USE_BUMPMAP":"",e.nb?"#define USE_NORMALMAP":
"",e.Ma?"#define USE_SPECULARMAP":"",e.u?"#define USE_COLOR":"",e.eh?"#define METAL":"",e.$f?"#define PHONG_PER_PIXEL":"",e.Sc?"#define WRAP_AROUND":"",e.kk?"#define DOUBLE_SIDED":"",e.ok?"#define FLIP_SIDED":"",e.ff?"#define USE_SHADOWMAP":"",e.ff?"#define "+w:"",e.Pi?"#define SHADOWMAP_DEBUG":"",e.Oi?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");w=W("vertex",["precision "+Y+" float;","precision "+Y+" int;",g,Nb?"#define VERTEX_TEXTURES":"",
B.cd?"#define GAMMA_INPUT":"",B.Ym?"#define GAMMA_OUTPUT":"","#define MAX_DIR_LIGHTS "+e.Gn,"#define MAX_POINT_LIGHTS "+e.In,"#define MAX_SPOT_LIGHTS "+e.Kn,"#define MAX_HEMI_LIGHTS "+e.Hn,"#define MAX_SHADOWS "+e.Jn,"#define MAX_BONES "+e.ks,e.map?"#define USE_MAP":"",e.Aa?"#define USE_ENVMAP":"",e.Sa?"#define USE_LIGHTMAP":"",e.Rb?"#define USE_BUMPMAP":"",e.nb?"#define USE_NORMALMAP":"",e.Ma?"#define USE_SPECULARMAP":"",e.u?"#define USE_COLOR":"",e.Ea?"#define USE_SKINNING":"",e.Od?"#define BONE_TEXTURE":
"",e.A?"#define USE_MORPHTARGETS":"",e.pa?"#define USE_MORPHNORMALS":"",e.$f?"#define PHONG_PER_PIXEL":"",e.Sc?"#define WRAP_AROUND":"",e.kk?"#define DOUBLE_SIDED":"",e.ok?"#define FLIP_SIDED":"",e.ff?"#define USE_SHADOWMAP":"",e.ff?"#define "+w:"",e.Pi?"#define SHADOWMAP_DEBUG":"",e.Oi?"#define SHADOWMAP_CASCADE":"",e.vh?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n")+
v);z=W("fragment",z+u);m.attachShader(y,w);m.attachShader(y,z);f&&m.bindAttribLocation(y,0,f);m.linkProgram(y);m.getProgramParameter(y,m.LINK_STATUS)||(console.error("Could not initialise shader\nVALIDATE_STATUS: "+m.getProgramParameter(y,m.VALIDATE_STATUS)+", gl error ["+m.getError()+"]"),console.error("Program Info Log: "+m.getProgramInfoLog(y)));m.deleteShader(z);m.deleteShader(w);y.Q={};y.attributes={};var A;w="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" ");
e.Od?(w.push("boneTexture"),w.push("boneTextureWidth"),w.push("boneTextureHeight")):w.push("boneGlobalMatrices");for(A in t)w.push(A);A=w;w=0;for(z=A.length;w<z;w++)t=A[w],y.Q[t]=m.getUniformLocation(y,t);w="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(A=0;A<e.dh;A++)w.push("morphTarget"+A);for(A=0;A<e.Bi;A++)w.push("morphNormal"+A);for(p in c)w.push(p);p=w;A=0;for(c=p.length;A<c;A++)w=p[A],y.attributes[w]=m.getAttribLocation(y,w);y.id=Aa++;ba.push({xb:y,
code:s,jl:1});B.info.memory.Yn=ba.length;p=y}a.xb=p;A=a.xb.attributes;if(a.A)for(a.jh=0,c="morphTarget",p=0;p<this.dh;p++)y=c+p,0<=A[y]&&a.jh++;if(a.pa)for(a.Qn=0,c="morphNormal",p=0;p<this.Bi;p++)y=c+p,0<=A[y]&&a.Qn++;a.Io=[];for(n in a.Q)a.Io.push([a.Q[n],n])};this.Wk=function(a){var c=a.zc===b.we;a=a.zc===b.nf;na!==c&&(c?m.disable(m.CULL_FACE):m.enable(m.CULL_FACE),na=c);La!==a&&(a?m.frontFace(m.CW):m.frontFace(m.CCW),La=a)};this.cf=function(a){Na!==a&&(a?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),
Na=a)};this.nh=function(a){Fa!==a&&(m.depthMask(a),Fa=a)};this.fg=function(a,c,e,d){a!==Ma&&(a===b.El?m.disable(m.BLEND):a===b.ll?(m.enable(m.BLEND),m.blendEquation(m.FUNC_ADD),m.blendFunc(m.SRC_ALPHA,m.ONE)):a===b.Yl?(m.enable(m.BLEND),m.blendEquation(m.FUNC_ADD),m.blendFunc(m.ZERO,m.ONE_MINUS_SRC_COLOR)):a===b.mp?(m.enable(m.BLEND),m.blendEquation(m.FUNC_ADD),m.blendFunc(m.ZERO,m.SRC_COLOR)):a===b.sl?m.enable(m.BLEND):(m.enable(m.BLEND),m.blendEquationSeparate(m.FUNC_ADD,m.FUNC_ADD),m.blendFuncSeparate(m.SRC_ALPHA,
m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA)),Ma=a);if(a===b.sl){if(c!==qa&&(m.blendEquation(aa(c)),qa=c),e!==ta||d!==Da)m.blendFunc(aa(e),aa(d)),ta=e,Da=d}else Da=ta=qa=null};this.hg=function(a,c){if(a.ga){a.zd||(a.zd=!0,a.addEventListener("dispose",g),a.Wb=m.createTexture(),B.info.memory.Ib++);m.activeTexture(m.TEXTURE0+c);m.bindTexture(m.TEXTURE_2D,a.Wb);m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,a.fe);m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.Kk);m.pixelStorei(m.UNPACK_ALIGNMENT,a.il);var e=
a.M,d=0===(e.width&e.width-1)&&0===(e.height&e.height-1),f=aa(a.ba),h=aa(a.type);G(m.TEXTURE_2D,a,d);var k=a.Ka;if(a instanceof b.ue)if(0<k.length&&d){for(var l=0,n=k.length;l<n;l++)e=k[l],m.texImage2D(m.TEXTURE_2D,l,f,e.width,e.height,0,f,h,e.data);a.Db=!1}else m.texImage2D(m.TEXTURE_2D,0,f,e.width,e.height,0,f,h,e.data);else if(a instanceof b.Qd)for(l=0,n=k.length;l<n;l++)e=k[l],a.ba!==b.Td?m.compressedTexImage2D(m.TEXTURE_2D,l,f,e.width,e.height,0,e.data):m.texImage2D(m.TEXTURE_2D,l,f,e.width,
e.height,0,f,h,e.data);else if(0<k.length&&d){l=0;for(n=k.length;l<n;l++)e=k[l],m.texImage2D(m.TEXTURE_2D,l,f,f,h,e);a.Db=!1}else m.texImage2D(m.TEXTURE_2D,0,f,f,h,a.M);a.Db&&d&&m.generateMipmap(m.TEXTURE_2D);a.ga=!1;a.Di&&a.Di()}else m.activeTexture(m.TEXTURE0+c),m.bindTexture(m.TEXTURE_2D,a.Wb)};this.Xk=function(a){var c=a instanceof b.Fe;if(a&&!a.yd){void 0===a.ad&&(a.ad=!0);void 0===a.nd&&(a.nd=!0);a.addEventListener("dispose",f);a.Wb=m.createTexture();B.info.memory.Ib++;var e=0===(a.width&a.width-
1)&&0===(a.height&a.height-1),d=aa(a.ba),g=aa(a.type);if(c){a.yd=[];a.Ad=[];m.bindTexture(m.TEXTURE_CUBE_MAP,a.Wb);G(m.TEXTURE_CUBE_MAP,a,e);for(var h=0;6>h;h++){a.yd[h]=m.createFramebuffer();a.Ad[h]=m.createRenderbuffer();m.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,d,a.width,a.height,0,d,g,null);var k=a,l=m.TEXTURE_CUBE_MAP_POSITIVE_X+h;m.bindFramebuffer(m.FRAMEBUFFER,a.yd[h]);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,l,k.Wb,0);S(a.Ad[h],a)}e&&m.generateMipmap(m.TEXTURE_CUBE_MAP)}else a.yd=
m.createFramebuffer(),a.Ad=a.uh?a.uh.Ad:m.createRenderbuffer(),m.bindTexture(m.TEXTURE_2D,a.Wb),G(m.TEXTURE_2D,a,e),m.texImage2D(m.TEXTURE_2D,0,d,a.width,a.height,0,d,g,null),d=m.TEXTURE_2D,m.bindFramebuffer(m.FRAMEBUFFER,a.yd),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,d,a.Wb,0),a.uh?a.ad&&!a.nd?m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,a.Ad):a.ad&&a.nd&&m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,a.Ad):S(a.Ad,a),
e&&m.generateMipmap(m.TEXTURE_2D);c?m.bindTexture(m.TEXTURE_CUBE_MAP,null):m.bindTexture(m.TEXTURE_2D,null);m.bindRenderbuffer(m.RENDERBUFFER,null);m.bindFramebuffer(m.FRAMEBUFFER,null)}a?(c=c?a.yd[a.kq]:a.yd,e=a.width,a=a.height):(c=null,e=xa,a=Ea);c!==da&&(m.bindFramebuffer(m.FRAMEBUFFER,c),m.viewport(0,0,e,a),da=c);Ia=e;za=a};this.rt=new b.uj;this.qq(this.rt);this.ym(new b.Ap);this.ym(new b.gp)};b.Ee=function(a,e,c){this.width=a;this.height=e;c=c||{};this.jc=void 0!==c.jc?c.jc:b.lg;this.kc=void 0!==
c.kc?c.kc:b.lg;this.Gb=void 0!==c.Gb?c.Gb:b.ye;this.mb=void 0!==c.mb?c.mb:b.oj;this.Pb=void 0!==c.Pb?c.Pb:1;this.offset=new b.h(0,0);this.repeat=new b.h(1,1);this.ba=void 0!==c.ba?c.ba:b.Td;this.type=void 0!==c.type?c.type:b.zj;this.ad=void 0!==c.ad?c.ad:!0;this.nd=void 0!==c.nd?c.nd:!0;this.Db=!0;this.uh=null};b.Ee.prototype={constructor:b.Ee,b:function(){var a=new b.Ee(this.width,this.height);a.jc=this.jc;a.kc=this.kc;a.Gb=this.Gb;a.mb=this.mb;a.Pb=this.Pb;a.offset.copy(this.offset);a.repeat.copy(this.repeat);
a.ba=this.ba;a.type=this.type;a.ad=this.ad;a.nd=this.nd;a.Db=this.Db;a.uh=this.uh;return a}};b.oc.prototype.apply(b.Ee.prototype);b.Fe=function(a,e,c){b.Ee.call(this,a,e,c);this.kq=0};b.Fe.prototype=Object.create(b.Ee.prototype);b.Be=function(){this.position=new b.a;this.bg=new b.a;this.k=new b.vc;this.visible=!0};b.Be.prototype.copy=function(a){this.bg.copy(a.bg);this.k.copy(a.k)};b.Ql=function(){this.id=0;this.ha=new b.Be;this.ka=new b.Be;this.Dc=new b.Be;this.bk=new b.a;this.fh=new b.a;this.On=
new b.a;this.Oo=0;this.Yi=[new b.a,new b.a,new b.a];this.kf=[new b.a,new b.a,new b.a];this.D=this.color=null;this.jf=[[]];this.z=0};b.vp=function(){this.id=0;this.object=null;this.z=0};b.Sl=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=this.x=0;this.scale=new b.h;this.D=null};b.Rl=function(){this.id=0;this.ha=new b.Be;this.ka=new b.Be;this.u=[new b.p,new b.p];this.D=null;this.z=0};b.gj={Ue:function(a,e,c){var d,f,g=a.e.length,h=e instanceof b.U?e.j:e,k=a.e,n=h.e,l=a.i,p=h.i;a=
a.v[0];h=h.v[0];void 0===c&&(c=0);e instanceof b.U&&(e.sa&&e.Bc(),d=e.ra,f=(new b.pc).dd(d));e=0;for(var r=n.length;e<r;e++){var q=n[e].b();d&&q.O(d);k.push(q)}e=0;for(r=p.length;e<r;e++){var q=p[e],v,u,s=q.V,x=q.u;v=new b.N(q.I+g,q.g+g,q.J+g);v.F.copy(q.F);f&&v.F.xc(f).normalize();k=0;for(n=s.length;k<n;k++)u=s[k].b(),f&&u.xc(f).normalize(),v.V.push(u);v.color.copy(q.color);k=0;for(n=x.length;k<n;k++)u=x[k],v.u.push(u.b());v.fc=q.fc+c;v.jb.copy(q.jb);d&&v.jb.O(d);l.push(v)}e=0;for(r=h.length;e<r;e++){c=
h[e];d=[];k=0;for(n=c.length;k<n;k++)d.push(new b.h(c[k].x,c[k].y));a.push(d)}},Ts:function(){var a=new b.a;return function(e,c,d){var f=new b.a,g=b.Jb.Nk(),h=b.Jb.Nk();1<g+h&&(g=1-g,h=1-h);var k=1-g-h;f.copy(e);f.q(g);a.copy(c);a.q(h);f.add(a);a.copy(d);a.q(k);f.add(a);return f}}(),Ss:function(a,e){return b.gj.Ts(e.e[a.I],e.e[a.g],e.e[a.J])},Kx:function(a,e){function c(a){function b(c,e){if(e<c)return c;var d=c+Math.floor((e-c)/2);return l[d]>a?b(c,d-1):l[d]<a?b(d+1,e):d}return b(0,l.length-1)}var d,
f,g=a.i,h=a.e,k=g.length,n=0,l=[],p,r,q;for(f=0;f<k;f++)d=g[f],p=h[d.I],r=h[d.g],q=h[d.J],d.$p=b.gj.Ot(p,r,q),n+=d.$p,l[f]=n;d=[];for(f=0;f<e;f++)h=b.Jb.Nk()*n,h=c(h),d[f]=b.gj.Ss(g[h],a,!0);return d},Ot:function(){var a=new b.a,e=new b.a;return function(b,d,f){a.ea(d,b);e.ea(f,b);a.Qe(e);return 0.5*a.length()}}(),ua:function(a){a.Jg();var e=a.Qb,c=new b.a;c.Hc(e.min,e.max);c.q(-0.5);a.Bd((new b.$).Ck(c.x,c.y,c.z));a.Jg();return c},Iy:function(a){var b,c,d,f,g=[],h=[];b=0;for(c=a.v.length;b<c;b++)h[b]=
[];b=0;for(c=a.i.length;b<c;b++)for(g.push(a.i[b]),d=0,f=a.v.length;d<f;d++)h[d].push(a.v[d][b]);a.i=g;a.v=h;a.ub();a.vb();a.Pe();a.Uf&&a.ei()}};b.sd={crossOrigin:void 0,$r:function(a,e,c){var d=new b.Eh;d.crossOrigin=this.crossOrigin;var f=new b.rb(void 0,e);e=d.load(a,function(){f.ga=!0;c&&c(f)});f.M=e;f.yt=a;return f},xn:function(a,e,c,d){var f=new b.Qd;f.lb=e;var g=new XMLHttpRequest;g.onload=function(){var a=b.sd.Hi(g.response,!0);f.ba=a.ba;f.Ka=a.Ka;f.M.width=a.width;f.M.height=a.height;f.Db=
!1;f.ga=!0;c&&c(f)};g.onerror=d;g.open("GET",a,!0);g.responseType="arraybuffer";g.send(null);return f},as:function(a,e,c,d){var f=[];f.ke=0;var g=new b.rb;g.M=f;void 0!==e&&(g.lb=e);g.fe=!1;e=0;for(var h=a.length;e<h;++e){var k=new Image;f[e]=k;k.onload=function(){f.ke+=1;6===f.ke&&(g.ga=!0,c&&c(g))};k.onerror=d;k.crossOrigin=this.crossOrigin;k.src=a[e]}return g},Zr:function(a,e,c,d){function f(a,e){return function(){var d=b.sd.Hi(a.response,!0);e.ba=d.ba;e.Ka=d.Ka;e.width=d.width;e.height=d.height;
g.ke+=1;6===g.ke&&(h.ba=d.ba,h.ga=!0,c&&c(h))}}var g=[];g.ke=0;var h=new b.Qd;h.M=g;void 0!==e&&(h.lb=e);h.fe=!1;h.Db=!1;if(a instanceof Array){e=0;for(var k=a.length;e<k;++e){var n={};g[e]=n;var l=new XMLHttpRequest;l.onload=f(l,n);l.onerror=d;n=a[e];l.open("GET",n,!0);l.responseType="arraybuffer";l.send(null)}}else l=new XMLHttpRequest,l.onload=function(){var a=b.sd.Hi(l.response,!0);if(a.xk){for(var e=a.Ka.length/a.Jd,d=0;d<e;d++){g[d]={Ka:[]};for(var f=0;f<a.Jd;f++)g[d].Ka.push(a.Ka[d*a.Jd+f]),
g[d].ba=a.ba,g[d].width=a.width,g[d].height=a.height}h.ba=a.ba;h.ga=!0;c&&c(h)}},l.onerror=d,l.open("GET",a,!0),l.responseType="arraybuffer",l.send(null);return h},zw:function(a,e,c,d){var f=[];f.ke=0;var g=new b.Qd;g.M=f;void 0!==e&&(g.lb=e);g.fe=!1;g.Db=!1;var h=new XMLHttpRequest;h.onload=function(){var a=b.sd.Hi(h.response,!0);if(a.xk)for(var e=a.Ka.length/a.Jd,d=0;d<e;d++){f[d]={Ka:[]};for(var p=0;p<a.Jd;p++)f[d].Ka.push(a.Ka[d*a.Jd+p]),f[d].ba=a.ba,f[d].width=a.width,f[d].height=a.height}else g.M.width=
a.width,g.M.height=a.height,g.Ka=a.Ka;g.ba=a.ba;g.ga=!0;c&&c(g)};h.onerror=d;h.open("GET",a,!0);h.responseType="arraybuffer";h.send(null);return g},Hi:function(a,e){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function d(a,b,c,e){var d=4*c*e;a=new Uint8Array(a,b,d);for(var d=new Uint8Array(d),f=b=0,g=0;g<e;g++)for(var h=0;h<c;h++){var k=a[f];f++;var l=a[f];f++;var n=a[f];f++;var p=a[f];f++;d[b]=n;b++;d[b]=l;b++;d[b]=k;b++;d[b]=p;b++}return d}
var f={Ka:[],width:0,height:0,ba:null,Jd:1},g=c("DXT1"),h=c("DXT3"),k=c("DXT5"),n=new Int32Array(a,0,31);if(542327876!==n[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),f;if(!n[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),f;var l=n[21],p=!1;switch(l){case g:g=8;f.ba=b.Ol;break;case h:g=16;f.ba=b.Ml;break;case k:g=16;f.ba=b.Nl;break;default:if(32==n[22]&&n[23]&16711680&&n[24]&65280&&n[25]&255&&n[26]&4278190080)p=
!0,g=64,f.ba=b.Td;else return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(l&255,l>>8&255,l>>16&255,l>>24&255)),f}f.Jd=1;n[2]&131072&&!1!==e&&(f.Jd=Math.max(1,n[7]));f.xk=n[28]&512?!0:!1;f.width=n[4];f.height=n[3];for(var n=n[1]+4,h=f.width,k=f.height,l=f.xk?6:1,r=0;r<l;r++){for(var q=0;q<f.Jd;q++){if(p)var v=d(a,n,h,k),u=v.length;else u=Math.max(4,h)/4*Math.max(4,k)/4*g,v=new Uint8Array(a,n,u);f.Ka.push({data:v,width:h,height:k});n+=u;h=Math.max(0.5*h,1);k=
Math.max(0.5*k,1)}h=f.width;k=f.height}return f},Sv:function(a,b){b|=1;var c=a.width,d=a.height,f=document.createElement("canvas");f.width=c;f.height=d;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,c,d).data,k=g.createImageData(c,d),n=k.data,l=0;l<c;l++)for(var p=0;p<d;p++){var r=0>p-1?0:p-1,q=p+1>d-1?d-1:p+1,v=0>l-1?0:l-1,u=l+1>c-1?c-1:l+1,s=[],x=[0,0,h[4*(p*c+l)]/255*b];s.push([-1,0,h[4*(p*c+v)]/255*b]);s.push([-1,-1,h[4*(r*c+v)]/255*b]);s.push([0,-1,h[4*(r*c+l)]/255*
b]);s.push([1,-1,h[4*(r*c+u)]/255*b]);s.push([1,0,h[4*(p*c+u)]/255*b]);s.push([1,1,h[4*(q*c+u)]/255*b]);s.push([0,1,h[4*(q*c+l)]/255*b]);s.push([-1,1,h[4*(q*c+v)]/255*b]);r=[];v=s.length;for(q=0;q<v;q++){var u=s[q],z=s[(q+1)%v],u=[u[0]-x[0],u[1]-x[1],u[2]-x[2]],z=[z[0]-x[0],z[1]-x[1],z[2]-x[2]],u=[u[1]*z[2]-u[2]*z[1],u[2]*z[0]-u[0]*z[2],u[0]*z[1]-u[1]*z[0]],z=Math.sqrt(u[0]*u[0]+u[1]*u[1]+u[2]*u[2]);r.push([u[0]/z,u[1]/z,u[2]/z])}s=[0,0,0];for(q=0;q<r.length;q++)s[0]+=r[q][0],s[1]+=r[q][1],s[2]+=
r[q][2];s[0]/=r.length;s[1]/=r.length;s[2]/=r.length;x=4*(p*c+l);n[x]=255*((s[0]+1)/2)|0;n[x+1]=255*((s[1]+1)/2)|0;n[x+2]=255*s[2]|0;n[x+3]=255}g.putImageData(k,0,0);return f},Rv:function(a,e,c){var d=a*e,f=new Uint8Array(3*d),g=Math.floor(255*c.s),h=Math.floor(255*c.r);c=Math.floor(255*c.g);for(var k=0;k<d;k++)f[3*k]=g,f[3*k+1]=h,f[3*k+2]=c;a=new b.ue(f,a,e,b.tj);a.ga=!0;return a}};b.Bu={hv:function(a,e){for(var c=new b.C,d=0,f=e.length;d<f;d++)c.add(new b.U(a,e[d]));return c},detach:function(a,
b,c){a.Bd(b.l);b.remove(a);c.add(a)},Qu:function(a,e,c){var d=new b.$;d.Fd(c.l);a.Bd(d);e.remove(a);c.add(a)}};b.gb={i:{},face:"helvetiker",lf:"normal",style:"normal",size:150,jk:10,yr:function(){return this.i[this.face][this.lf][this.style]},yn:function(a){var b=a.Ev.toLowerCase();this.i[b]=this.i[b]||{};this.i[b][a.ek]=this.i[b][a.ek]||{};this.i[b][a.ek][a.Yq]=a;return this.i[b][a.ek][a.Yq]=a},dr:function(a){var e=this.yr(),c=this.size/e.Qx,d=0,f=String(a).split(""),g=f.length,h=[];for(a=0;a<g;a++){var k=
new b.hb,k=this.lr(f[a],e,c,d,k),d=d+k.offset;h.push(k.path)}return{Js:h,offset:d/2}},lr:function(a,b,c,d,f){var g=[],h,k,n,l,p,r,q,v=b.Dr[a]||b.Dr["?"];if(v){if(v.ys)for(b=v.aq||(v.aq=v.ys.split(" ")),n=b.length,a=0;a<n;)switch(h=b[a++],h){case "m":h=b[a++]*c+d;k=b[a++]*c;f.moveTo(h,k);break;case "l":h=b[a++]*c+d;k=b[a++]*c;f.lineTo(h,k);break;case "q":h=b[a++]*c+d;k=b[a++]*c;l=b[a++]*c+d;p=b[a++]*c;f.quadraticCurveTo(l,p,h,k);if(h=g[g.length-1])for(h=1,k=this.jk;h<=k;h++);break;case "b":if(h=b[a++]*
c+d,k=b[a++]*c,l=b[a++]*c+d,p=b[a++]*-c,r=b[a++]*c+d,q=b[a++]*-c,f.bezierCurveTo(h,k,l,p,r,q),h=g[g.length-1])for(h=1,k=this.jk;h<=k;h++);}return{offset:v.Uv*c,path:f}}}};b.gb.tr=function(a,e){e=e||{};var c=void 0!==e.Og?e.Og:4,d=void 0!==e.font?e.font:"helvetiker",f=void 0!==e.lf?e.lf:"normal",g=void 0!==e.style?e.style:"normal";b.gb.size=void 0!==e.size?e.size:100;b.gb.jk=c;b.gb.face=d;b.gb.lf=f;b.gb.style=g;c=b.gb.dr(a).Js;d=[];f=0;for(g=c.length;f<g;f++)Array.prototype.push.apply(d,c[f].Jt());
return d};(function(a){function b(a){for(var e=a.length,f=0,g=e-1,h=0;h<e;g=h++)f+=a[g].x*a[h].y-a[h].x*a[g].y;return 0.5*f}a.Ce=function(a,d){var f=a.length;if(3>f)return null;var g=[],h=[],k=[],n,l,p;if(0<b(a))for(l=0;l<f;l++)h[l]=l;else for(l=0;l<f;l++)h[l]=f-1-l;var r=2*f;for(l=f-1;2<f;){if(0>=r--){console.log("Warning, unable to triangulate polygon!");break}n=l;f<=n&&(n=0);l=n+1;f<=l&&(l=0);p=l+1;f<=p&&(p=0);var q;a:{var v=q=void 0,u=void 0,s=void 0,x=void 0,z=void 0,t=void 0,w=void 0,y=void 0,
v=a[h[n]].x,u=a[h[n]].y,s=a[h[l]].x,x=a[h[l]].y,z=a[h[p]].x,t=a[h[p]].y;if(1E-10>(s-v)*(t-u)-(x-u)*(z-v))q=!1;else{var H=void 0,N=void 0,Q=void 0,C=void 0,M=void 0,I=void 0,D=void 0,K=void 0,F=void 0,A=void 0,F=K=D=y=w=void 0,H=z-s,N=t-x,Q=v-z,C=u-t,M=s-v,I=x-u;for(q=0;q<f;q++)if(q!==n&&q!==l&&q!==p&&(w=a[h[q]].x,y=a[h[q]].y,D=w-v,K=y-u,F=w-s,A=y-x,w-=z,y-=t,F=H*A-N*F,D=M*K-I*D,K=Q*y-C*w,-1E-10<=F&&-1E-10<=K&&-1E-10<=D)){q=!1;break a}q=!0}}if(q){g.push([a[h[n]],a[h[l]],a[h[p]]]);k.push([h[n],h[l],
h[p]]);n=l;for(p=l+1;p<f;n++,p++)h[n]=h[p];f--;r=2*f}}return d?k:g};a.Ce.Ef=b;return a})(b.gb);self.dq={i:b.gb.i,yn:b.gb.yn};b.Jy=self.dq;b.X=la();b.X.prototype.Ja=function(){console.log("Warning, getPoint() not implemented!");return null};b.X.prototype.Xg=function(a){a=this.uk(a);return this.Ja(a)};b.X.prototype.Sf=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.Ja(b/a));return c};b.X.prototype.ri=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.Xg(b/a));return c};b.X.prototype.Wg=
function(){var a=this.dn();return a[a.length-1]};b.X.prototype.dn=function(){var a;a||(a=this.Op?this.Op:200);if(this.Yj&&this.Yj.length==a+1&&!this.ga)return this.Yj;this.ga=!1;var b=[],c,d=this.Ja(0),f,g=0;b.push(0);for(f=1;f<=a;f++)c=this.Ja(f/a),g+=c.Ed(d),b.push(g),d=c;return this.Yj=b};b.X.prototype.uk=function(a,b){var c=this.dn(),d=0,f=c.length,g;g=b?b:a*c[f-1];for(var h=0,k=f-1,n;h<=k;)if(d=Math.floor(h+(k-h)/2),n=c[d]-g,0>n)h=d+1;else if(0<n)k=d-1;else{k=d;break}d=k;if(c[d]==g)return d/
(f-1);h=c[d];return c=(d+(g-h)/(c[d+1]-h))/(f-1)};b.X.prototype.Yg=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.Ja(b);return this.Ja(a).b().sub(b).normalize()};b.X.prototype.Cr=function(a){a=this.uk(a);return this.Yg(a)};b.X.T={Bo:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},Ao:function(a,b,c,d,f){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*f},yy:function(a){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},wb:function(a,b,c,d,f){a=0.5*
(c-a);d=0.5*(d-b);var g=f*f;return(2*b-2*c+a+d)*f*g+(-3*b+3*c-2*a-d)*g+a*f+b}};b.X.create=function(a,e){a.prototype=Object.create(b.X.prototype);a.prototype.Ja=e;return a};b.mc=function(){this.Ya=[];this.bi=[]};b.mc.prototype=Object.create(b.X.prototype);b.mc.prototype.add=function(a){this.Ya.push(a)};b.mc.prototype.closePath=function(){var a=this.Ya[0].Ja(0),e=this.Ya[this.Ya.length-1].Ja(1);a.oa(e)||this.Ya.push(new b.tf(e,a))};b.mc.prototype.Ja=function(a){var b=a*this.Wg(),c=this.bn();for(a=0;a<
c.length;){if(c[a]>=b)return b=c[a]-b,a=this.Ya[a],b=1-b/a.Wg(),a.Xg(b);a++}return null};b.mc.prototype.Wg=function(){var a=this.bn();return a[a.length-1]};b.mc.prototype.bn=function(){if(this.Zj&&this.Zj.length==this.Ya.length)return this.Zj;var a=[],b=0,c,d=this.Ya.length;for(c=0;c<d;c++)b+=this.Ya[c].Wg(),a.push(b);return this.Zj=a};b.mc.prototype.pi=function(){var a=this.Sf(),e,c,d,f,g,h;e=c=Number.NEGATIVE_INFINITY;f=g=Number.POSITIVE_INFINITY;var k,n,l,p,r=a[0]instanceof b.a;p=r?new b.a:new b.h;
n=0;for(l=a.length;n<l;n++)k=a[n],k.x>e?e=k.x:k.x<f&&(f=k.x),k.y>c?c=k.y:k.y<g&&(g=k.y),r&&(k.z>d?d=k.z:k.z<h&&(h=k.z)),p.add(k);a={gx:f,hx:g,ls:e,cx:c,jb:p.de(l)};r&&(a.dx=d,a.ix=h);return a};b.mc.prototype.fn=function(a,b){var c=this.Sf(a),d,f;b||(b=this.bi);d=0;for(f=b.length;d<f;d++)c=this.hn(c,b[d]);return c};b.mc.prototype.gn=function(a,b){var c=this.ri(a),d,f;b||(b=this.bi);d=0;for(f=b.length;d<f;d++)c=this.hn(c,b[d]);return c};b.mc.prototype.hn=function(a,b){var c=this.pi(),d,f,g,h,k,n;d=
0;for(f=a.length;d<f;d++)g=a[d],h=g.x,k=g.y,n=h/c.ls,n=b.uk(n,h),h=b.Ja(n),n=b.Yg(n),n.set(-n.y,n.x).q(k),g.x=h.x+n.x,g.y=h.y+n.y;return a};b.rd=function(){b.C.call(this)};b.rd.prototype=Object.create(b.C.prototype);b.rd.prototype.Fa=function(a){this.sa&&this.Bc();if(this.eb||a)this.parent?(this.l.La(this.parent.l,this.ra),this.l.gi(this.Fo,this.Ps,this.mo),this.ra.gi(this.Mt,this.bo,this.Zs),this.l.di(this.Fo,this.bo,this.mo)):this.l.copy(this.ra),this.eb=!1,a=!0;for(var b=0,c=this.children.length;b<
c;b++)this.children[b].Fa(a)};b.rd.prototype.Fo=new b.a;b.rd.prototype.Mt=new b.a;b.rd.prototype.Ps=new b.rc;b.rd.prototype.bo=new b.rc;b.rd.prototype.mo=new b.a;b.rd.prototype.Zs=new b.a;b.hb=function(a){b.mc.call(this);this.ma=[];a&&this.rr(a)};b.hb.prototype=Object.create(b.mc.prototype);b.Tb={pj:"moveTo",Bl:"lineTo",Kl:"quadraticCurveTo",nl:"bezierCurveTo",Uo:"splineThru",Po:"arc",vl:"ellipse"};b.hb.prototype.rr=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,
a[b].y)};b.hb.prototype.moveTo=function(a,e){var c=Array.prototype.slice.call(arguments);this.ma.push({action:b.Tb.pj,Zb:c})};b.hb.prototype.lineTo=function(a,e){var c=Array.prototype.slice.call(arguments),d=this.ma[this.ma.length-1].Zb;this.Ya.push(new b.tf(new b.h(d[d.length-2],d[d.length-1]),new b.h(a,e)));this.ma.push({action:b.Tb.Bl,Zb:c})};b.hb.prototype.quadraticCurveTo=function(a,e,c,d){var f=Array.prototype.slice.call(arguments),g=this.ma[this.ma.length-1].Zb;this.Ya.push(new b.Lh(new b.h(g[g.length-
2],g[g.length-1]),new b.h(a,e),new b.h(c,d)));this.ma.push({action:b.Tb.Kl,Zb:f})};b.hb.prototype.bezierCurveTo=function(a,e,c,d,f,g){var h=Array.prototype.slice.call(arguments),k=this.ma[this.ma.length-1].Zb;this.Ya.push(new b.Dh(new b.h(k[k.length-2],k[k.length-1]),new b.h(a,e),new b.h(c,d),new b.h(f,g)));this.ma.push({action:b.Tb.nl,Zb:h})};b.hb.prototype.arc=function(a,b,c,d,f,g){var h=this.ma[this.ma.length-1].Zb;this.hq(a+h[h.length-2],b+h[h.length-1],c,d,f,g)};b.hb.prototype.hq=function(a,
b,c,d,f,g){this.iq(a,b,c,c,d,f,g)};b.hb.prototype.iq=function(a,e,c,d,f,g,h){var k=Array.prototype.slice.call(arguments),n=new b.ng(a,e,c,d,f,g,h);this.Ya.push(n);n=n.Ja(1);k.push(n.x);k.push(n.y);this.ma.push({action:b.Tb.vl,Zb:k})};b.hb.prototype.ri=function(a){a||(a=40);for(var b=[],c=0;c<a;c++)b.push(this.Ja(c/a));return b};b.hb.prototype.Sf=function(a,e){if(this.St)return console.log("tata"),this.ri(a,e);a=a||12;var c=[],d,f,g,h,k,n,l,p,r,q,v,u,s;d=0;for(f=this.ma.length;d<f;d++)switch(g=this.ma[d],
h=g.action,g=g.Zb,h){case b.Tb.pj:c.push(new b.h(g[0],g[1]));break;case b.Tb.Bl:c.push(new b.h(g[0],g[1]));break;case b.Tb.Kl:k=g[2];n=g[3];r=g[0];q=g[1];0<c.length?(h=c[c.length-1],v=h.x,u=h.y):(h=this.ma[d-1].Zb,v=h[h.length-2],u=h[h.length-1]);for(g=1;g<=a;g++)s=g/a,h=b.Y.T.Le(s,v,r,k),s=b.Y.T.Le(s,u,q,n),c.push(new b.h(h,s));break;case b.Tb.nl:k=g[4];n=g[5];r=g[0];q=g[1];l=g[2];p=g[3];0<c.length?(h=c[c.length-1],v=h.x,u=h.y):(h=this.ma[d-1].Zb,v=h[h.length-2],u=h[h.length-1]);for(g=1;g<=a;g++)s=
g/a,h=b.Y.T.Me(s,v,r,l,k),s=b.Y.T.Me(s,u,q,p,n),c.push(new b.h(h,s));break;case b.Tb.Uo:h=this.ma[d-1].Zb;s=[new b.h(h[h.length-2],h[h.length-1])];h=a*g[0].length;s=s.concat(g[0]);s=new b.wj(s);for(g=1;g<=h;g++)c.push(s.Xg(g/h));break;case b.Tb.Po:k=g[0];n=g[1];q=g[2];l=g[3];h=g[4];r=!!g[5];v=h-l;u=2*a;for(g=1;g<=u;g++)s=g/u,r||(s=1-s),s=l+s*v,h=k+q*Math.cos(s),s=n+q*Math.sin(s),c.push(new b.h(h,s));break;case b.Tb.vl:for(k=g[0],n=g[1],q=g[2],p=g[3],l=g[4],h=g[5],r=!!g[6],v=h-l,u=2*a,g=1;g<=u;g++)s=
g/u,r||(s=1-s),s=l+s*v,h=k+q*Math.cos(s),s=n+p*Math.sin(s),c.push(new b.h(h,s))}d=c[c.length-1];1E-10>Math.abs(d.x-c[0].x)&&1E-10>Math.abs(d.y-c[0].y)&&c.splice(c.length-1,1);e&&c.push(c[0]);return c};b.hb.prototype.Jt=function(){var a,e,c,d,f=[],g=new b.hb;a=0;for(e=this.ma.length;a<e;a++)c=this.ma[a],d=c.Zb,c=c.action,c==b.Tb.pj&&0!=g.ma.length&&(f.push(g),g=new b.hb),g[c].apply(g,d);0!=g.ma.length&&f.push(g);if(0==f.length)return[];var h=[];if(1==f.length)return g=f[0],c=new b.Y,c.ma=g.ma,c.Ya=
g.Ya,h.push(c),h;if(b.Y.T.Te(f[0].Sf())){c=void 0;a=0;for(e=f.length;a<e;a++)g=f[a],(d=b.Y.T.Te(g.Sf()))?(c&&h.push(c),c=new b.Y,c.ma=g.ma,c.Ya=g.Ya):c.ed.push(g);h.push(c)}else for(c=new b.Y,a=0,e=f.length;a<e;a++)g=f[a],(d=b.Y.T.Te(g.Sf()))?(c.ma=g.ma,c.Ya=g.Ya,h.push(c),c=new b.Y):c.ed.push(g);return h};b.Y=function(){b.hb.apply(this,arguments);this.ed=[]};b.Y.prototype=Object.create(b.hb.prototype);b.Y.prototype.Ar=function(a){var b,c=this.ed.length,d=[];for(b=0;b<c;b++)d[b]=this.ed[b].fn(a,this.bi);
return d};b.Y.prototype.Br=function(a){var b,c=this.ed.length,d=[];for(b=0;b<c;b++)d[b]=this.ed[b].gn(a,this.bi);return d};b.Y.prototype.jr=function(a){return{shape:this.fn(a),ed:this.Ar(a)}};b.Y.prototype.Tm=function(a){return this.St?this.kr(a):this.jr(a)};b.Y.prototype.kr=function(a){return{shape:this.gn(a),ed:this.Br(a)}};b.Y.T={Ws:function(a,e){var c=a.concat(),d=c.concat(),f,g,h,k,n,l,p,r,q,v,u=[];for(n=0;n<e.length;n++){l=e[n];Array.prototype.push.apply(d,l);g=Number.POSITIVE_INFINITY;for(f=
0;f<l.length;f++)for(q=l[f],v=[],r=0;r<c.length;r++)p=c[r],p=q.ce(p),v.push(p),p<g&&(g=p,h=f,k=r);f=0<=k-1?k-1:c.length-1;g=0<=h-1?h-1:l.length-1;var s=[l[h],c[k],c[f]];r=b.gb.Ce.Ef(s);var x=[l[h],l[g],c[k]];q=b.gb.Ce.Ef(x);v=k;p=h;k+=1;h+=-1;0>k&&(k+=c.length);k%=c.length;0>h&&(h+=l.length);h%=l.length;f=0<=k-1?k-1:c.length-1;g=0<=h-1?h-1:l.length-1;s=[l[h],c[k],c[f]];s=b.gb.Ce.Ef(s);x=[l[h],l[g],c[k]];x=b.gb.Ce.Ef(x);r+q>s+x&&(k=v,h=p,0>k&&(k+=c.length),k%=c.length,0>h&&(h+=l.length),h%=l.length,
f=0<=k-1?k-1:c.length-1,g=0<=h-1?h-1:l.length-1);r=c.slice(0,k);q=c.slice(k);v=l.slice(h);p=l.slice(0,h);g=[l[h],l[g],c[k]];u.push([l[h],c[k],c[f]]);u.push(g);c=r.concat(v).concat(p).concat(q)}return{shape:c,Ur:u,sq:d}},Ho:function(a,e){var c=b.Y.T.Ws(a,e),d=c.sq,f=c.Ur,c=b.gb.Ce(c.shape,!1),g,h,k,n,l={};g=0;for(h=d.length;g<h;g++)n=d[g].x+":"+d[g].y,void 0!==l[n]&&console.log("Duplicate point",n),l[n]=g;g=0;for(h=c.length;g<h;g++)for(k=c[g],d=0;3>d;d++)n=k[d].x+":"+k[d].y,n=l[n],void 0!==n&&(k[d]=
n);g=0;for(h=f.length;g<h;g++)for(k=f[g],d=0;3>d;d++)n=k[d].x+":"+k[d].y,n=l[n],void 0!==n&&(k[d]=n);return c.concat(f)},Te:function(a){return 0>b.gb.Ce.Ef(a)},Bq:function(a,b){var c=1-a;return c*c*b},Cq:function(a,b){return 2*(1-a)*a*b},Dq:function(a,b){return a*a*b},Le:function(a,b,c,d){return this.Bq(a,b)+this.Cq(a,c)+this.Dq(a,d)},Eq:function(a,b){var c=1-a;return c*c*c*b},Fq:function(a,b){var c=1-a;return 3*c*c*a*b},Gq:function(a,b){return 3*(1-a)*a*a*b},Hq:function(a,b){return a*a*a*b},Me:function(a,
b,c,d,f){return this.Eq(a,b)+this.Fq(a,c)+this.Gq(a,d)+this.Hq(a,f)}};b.tf=function(a,b){this.ha=a;this.ka=b};b.tf.prototype=Object.create(b.X.prototype);b.tf.prototype.Ja=function(a){var b=this.ka.b().sub(this.ha);b.q(a).add(this.ha);return b};b.tf.prototype.Xg=function(a){return this.Ja(a)};b.tf.prototype.Yg=function(){return this.ka.b().sub(this.ha).normalize()};b.Lh=function(a,b,c){this.pb=a;this.ha=b;this.ka=c};b.Lh.prototype=Object.create(b.X.prototype);b.Lh.prototype.Ja=function(a){return new b.h(b.Y.T.Le(a,
this.pb.x,this.ha.x,this.ka.x),b.Y.T.Le(a,this.pb.y,this.ha.y,this.ka.y))};b.Lh.prototype.Yg=function(a){a=new b.h(b.X.T.Bo(a,this.pb.x,this.ha.x,this.ka.x),b.X.T.Bo(a,this.pb.y,this.ha.y,this.ka.y));a.normalize();return a};b.Dh=function(a,b,c,d){this.pb=a;this.ha=b;this.ka=c;this.Dc=d};b.Dh.prototype=Object.create(b.X.prototype);b.Dh.prototype.Ja=function(a){return new b.h(b.Y.T.Me(a,this.pb.x,this.ha.x,this.ka.x,this.Dc.x),b.Y.T.Me(a,this.pb.y,this.ha.y,this.ka.y,this.Dc.y))};b.Dh.prototype.Yg=
function(a){a=new b.h(b.X.T.Ao(a,this.pb.x,this.ha.x,this.ka.x,this.Dc.x),b.X.T.Ao(a,this.pb.y,this.ha.y,this.ka.y,this.Dc.y));a.normalize();return a};b.wj=function(a){this.ca=void 0==a?[]:a};b.wj.prototype=Object.create(b.X.prototype);b.wj.prototype.Ja=function(a){var e=new b.h,c=[],d=this.ca,f;f=(d.length-1)*a;a=Math.floor(f);f-=a;c[0]=0==a?a:a-1;c[1]=a;c[2]=a>d.length-2?d.length-1:a+1;c[3]=a>d.length-3?d.length-1:a+2;e.x=b.X.T.wb(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,f);e.y=b.X.T.wb(d[c[0]].y,
d[c[1]].y,d[c[2]].y,d[c[3]].y,f);return e};b.ng=function(a,b,c,d,f,g,h){this.fq=a;this.gq=b;this.Zt=c;this.$t=d;this.wm=f;this.vm=g;this.eq=h};b.ng.prototype=Object.create(b.X.prototype);b.ng.prototype.Ja=function(a){var e=this.vm-this.wm;0>e&&(e+=2*Math.PI);e>2*Math.PI&&(e-=2*Math.PI);a=!0===this.eq?this.vm+(1-a)*(2*Math.PI-e):this.wm+a*e;return new b.h(this.fq+this.Zt*Math.cos(a),this.gq+this.$t*Math.sin(a))};b.Ro=function(a,e,c,d,f,g){b.ng.call(this,a,e,c,c,d,f,g)};b.Ro.prototype=Object.create(b.ng.prototype);
b.ru=b.X.create(function(a,b){this.ha=a;this.ka=b},function(a){var e=new b.a;e.ea(this.ka,this.ha);e.q(a);e.add(this.ha);return e});b.yu=b.X.create(function(a,b,c){this.pb=a;this.ha=b;this.ka=c},function(a){return new b.a(b.Y.T.Le(a,this.pb.x,this.ha.x,this.ka.x),b.Y.T.Le(a,this.pb.y,this.ha.y,this.ka.y),b.Y.T.Le(a,this.pb.z,this.ha.z,this.ka.z))});b.hu=b.X.create(function(a,b,c,d){this.pb=a;this.ha=b;this.ka=c;this.Dc=d},function(a){return new b.a(b.Y.T.Me(a,this.pb.x,this.ha.x,this.ka.x,this.Dc.x),
b.Y.T.Me(a,this.pb.y,this.ha.y,this.ka.y,this.Dc.y),b.Y.T.Me(a,this.pb.z,this.ha.z,this.ka.z,this.Dc.z))});b.Eu=b.X.create(function(a){this.ca=void 0==a?[]:a},function(a){var e=new b.a,c=[],d=this.ca,f;a*=d.length-1;f=Math.floor(a);a-=f;c[0]=0==f?f:f-1;c[1]=f;c[2]=f>d.length-2?d.length-1:f+1;c[3]=f>d.length-3?d.length-1:f+2;f=d[c[0]];var g=d[c[1]],h=d[c[2]],c=d[c[3]];e.x=b.X.T.wb(f.x,g.x,h.x,c.x,a);e.y=b.X.T.wb(f.y,g.y,h.y,c.y,a);e.z=b.X.T.wb(f.z,g.z,h.z,c.z,a);return e});b.fu=b.X.create(function(a){this.ca=
void 0==a?[]:a},function(a){var e=new b.a,c=[],d=this.ca,f;f=(d.length-0)*a;a=Math.floor(f);f-=a;a+=0<a?0:(Math.floor(Math.abs(a)/d.length)+1)*d.length;c[0]=(a-1)%d.length;c[1]=a%d.length;c[2]=(a+1)%d.length;c[3]=(a+2)%d.length;e.x=b.X.T.wb(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,f);e.y=b.X.T.wb(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,f);e.z=b.X.T.wb(d[c[0]].z,d[c[1]].z,d[c[2]].z,d[c[3]].z,f);return e});b.yb=function(){function a(b,c){c.push(b);for(var d=0;d<b.children.length;d++)a(b.children[d],
c)}var e=[],c={},d={update:function(a){for(var b=0;b<e.length;b++)e[b].update(a)},Ku:function(a){-1===e.indexOf(a)&&e.push(a)},fo:function(a){a=e.indexOf(a);-1!==a&&e.splice(a,1)},add:function(a){void 0!==c[a.name]&&console.log("THREE.AnimationHandler.add: Warning! "+a.name+" already exists in library. Overwriting.");c[a.name]=a;if(!0!==a.Or){for(var d=0;d<a.t.length;d++){for(var e=0;e<a.t[d].keys.length;e++)if(0>a.t[d].keys[e].time&&(a.t[d].keys[e].time=0),void 0!==a.t[d].keys[e].Vk&&!(a.t[d].keys[e].Vk instanceof
b.rc)){var k=a.t[d].keys[e].Vk;a.t[d].keys[e].Vk=new b.rc(k[0],k[1],k[2],k[3])}if(a.t[d].keys.length&&void 0!==a.t[d].keys[0].A){k={};for(e=0;e<a.t[d].keys.length;e++)for(var n=0;n<a.t[d].keys[e].A.length;n++){var l=a.t[d].keys[e].A[n];k[l]=-1}a.t[d].Ny=k;for(e=0;e<a.t[d].keys.length;e++){var p={};for(l in k){for(n=0;n<a.t[d].keys[e].A.length;n++)if(a.t[d].keys[e].A[n]===l){p[l]=a.t[d].keys[e].qs[n];break}n===a.t[d].keys[e].A.length&&(p[l]=0)}a.t[d].keys[e].qs=p}}for(e=1;e<a.t[d].keys.length;e++)a.t[d].keys[e].time===
a.t[d].keys[e-1].time&&(a.t[d].keys.splice(e,1),e--);for(e=0;e<a.t[d].keys.length;e++)a.t[d].keys[e].index=e}e=parseInt(a.length*a.Ug,10);a.jj={};a.jj.t=[];for(d=0;d<a.t.length;d++)a.jj.t.push(Array(e));a.Or=!0}},get:function(a){if("string"===typeof a){if(c[a])return c[a];console.log("THREE.AnimationHandler.get: Couldn't find animation "+a);return null}},parse:function(c){var d=[];if(c instanceof b.sc)for(var e=0;e<c.Qa.length;e++)d.push(c.Qa[e]);else a(c,d);return d},LINEAR:0,bj:1,Ah:2};return d}();
b.mf=function(a,e,c){this.root=a;this.data=b.yb.get(e);this.t=b.yb.parse(a);this.currentTime=0;this.fl=1;this.ah=!1;this.loop=!0;this.he=void 0!==c?c:b.yb.LINEAR;this.ca=[];this.target=new b.a};b.mf.prototype.stop=function(){this.ah=!1;b.yb.fo(this)};b.mf.prototype.update=function(a){if(!1!==this.ah){var e=["pos","rot","scl"],c,d,f,g,h,k,n,l,p;for(p=this.currentTime+=a*this.fl;this.currentTime>this.data.length;)this.currentTime-=this.data.length;l=this.currentTime%=this.data.length;Math.min(l*this.data.Ug,
this.data.length*this.data.Ug);for(var r=0,q=this.t.length;r<q;r++){a=this.t[r];n=a.Yh;for(var v=0;3>v;v++){c=e[v];h=n.Lk[c];k=n.Gk[c];if(k.time<=p){if(l<=p)if(this.loop)for(h=this.data.t[r].keys[0],k=this.Rf(c,r,1);null!==k&&k.time<l&&k.index>h.index;)h=k,k=this.Rf(c,r,k.index+1);else{this.stop();return}else{do h=k,k=this.Rf(c,r,k.index+1);while(null!==k&&k.time<l&&k.index>h.index)}n.Lk[c]=h;n.Gk[c]=k}a.sa=!0;a.eb=!0;d=(l-h.time)/(k.time-h.time);f=h[c];g=k[c];if(0>d||1<d)console.log("THREE.Animation.update: Warning! Scale out of bounds:"+
d+" on bone "+r),d=0>d?0:1;if("pos"===c)if(c=a.position,this.he===b.yb.LINEAR)c.x=f[0]+(g[0]-f[0])*d,c.y=f[1]+(g[1]-f[1])*d,c.z=f[2]+(g[2]-f[2])*d;else{if(this.he===b.yb.bj||this.he===b.yb.Ah)this.ca[0]=this.tk("pos",r,h.index-1).pos,this.ca[1]=f,this.ca[2]=g,this.ca[3]=this.Rf("pos",r,k.index+1).pos,d=0.33*d+0.33,f=this.mn(this.ca,d),c.x=f[0],c.y=f[1],c.z=f[2],this.he===b.yb.Ah&&(d=this.mn(this.ca,1.01*d),this.target.set(d[0],d[1],d[2]),this.target.sub(c),this.target.y=0,this.target.normalize(),
d=Math.atan2(this.target.x,this.target.z),a.rotation.set(0,d,0))}else"rot"===c?b.rc.cl(f,g,a.Ca,d):"scl"===c&&(c=a.scale,c.x=f[0]+(g[0]-f[0])*d,c.y=f[1]+(g[1]-f[1])*d,c.z=f[2]+(g[2]-f[2])*d)}}}};b.mf.prototype.mn=function(a,b){var c=[],d=[],f,g,h,k,n,l;f=(a.length-1)*b;g=Math.floor(f);f-=g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>a.length-2?g:g+1;c[3]=g>a.length-3?g:g+2;g=a[c[0]];k=a[c[1]];n=a[c[2]];l=a[c[3]];c=f*f;h=f*c;d[0]=this.wb(g[0],k[0],n[0],l[0],f,c,h);d[1]=this.wb(g[1],k[1],n[1],l[1],f,c,h);d[2]=this.wb(g[2],
k[2],n[2],l[2],f,c,h);return d};b.mf.prototype.wb=function(a,b,c,d,f,g,h){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*h+(-3*(b-c)-2*a-d)*g+a*f+b};b.mf.prototype.Rf=function(a,e,c){var d=this.data.t[e].keys;for(c=this.he===b.yb.bj||this.he===b.yb.Ah?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.t[e].keys[0]};b.mf.prototype.tk=function(a,e,c){var d=this.data.t[e].keys;for(c=this.he===b.yb.bj||this.he===b.yb.Ah?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==
d[c][a])return d[c];return this.data.t[e].keys[d.length-1]};b.Fh=function(a,e,c){this.root=a;this.data=b.yb.get(e);this.t=b.yb.parse(a);this.currentTime=0;this.fl=0.0010;this.ah=!1;this.loop=!0;this.kj=void 0!==c?c:!0;a=0;for(e=this.t.length;a<e;a++){c=this.data.t[a].tt;var d=this.t[a];if(this.data.t[a].keys.length&&c){for(var f=0;f<c.length;f++){var g=c[f],h=this.Rf(g,a,0);h&&h.apply(g)}d.sa=!1;this.data.t[a].Nn.Bc();d.eb=!0}}};b.Fh.prototype.stop=function(){this.ah=!1;b.yb.fo(this);for(var a=0;a<
this.data.t.length;a++){var e=this.t[a],c=this.data.t[a];if(void 0!==c.Yh){var d=c.Yh.Vn;e instanceof b.qd?(d.copy(e.md),e.md=d):(d.copy(e.ra),e.ra=d);delete c.Yh}}};b.Fh.prototype.update=function(a){if(this.ah){var e,c,d,f,g=this.data.jj.t,h,k,n;k=this.currentTime+=a*this.fl;h=this.currentTime%=this.data.length;h<this.Ct&&(h=this.currentTime=this.Ct+h);f=parseInt(Math.min(h*this.data.Ug,this.data.length*this.data.Ug),10);if((n=h<k)&&!this.loop){a=0;for(var l=this.t.length;a<l;a++){var p=this.data.t[a].keys,
g=this.data.t[a].tt;d=p.length-1;f=this.t[a];if(p.length){for(p=0;p<g.length;p++)h=g[p],(k=this.tk(h,a,d))&&k.apply(h);this.data.t[a].Nn.Bc();f.eb=!0}}this.stop()}else if(!(h<this.startTime)){a=0;for(l=this.t.length;a<l;a++){d=this.t[a];e=this.data.t[a];var p=e.keys,r=e.Yh;if(this.kj&&void 0!==g[a][f])d instanceof b.qd?(d.md=g[a][f],d.eb=!1):(d.ra=g[a][f],d.eb=!0);else if(p.length){this.kj&&r&&(d instanceof b.qd?d.md=r.Vn:d.ra=r.Vn);e=r.Lk;c=r.Gk;if(e&&c){if(c.time<=k){if(n&&this.loop)for(e=p[0],
c=p[1];c.time<h;)e=c,c=p[e.index+1];else if(!n)for(var q=p.length-1;c.time<h&&c.index!==q;)e=c,c=p[e.index+1];r.Lk=e;r.Gk=c}c.time>=h?e.wb(c,h):e.wb(c,c.time)}this.data.t[a].Nn.Bc();d.eb=!0}}if(this.kj&&void 0===g[0][f])for(this.t[0].Fa(!0),a=0;a<this.t.length;a++)g[a][f]=this.t[a]instanceof b.qd?this.t[a].md.b():this.t[a].ra.b()}}};b.Fh.prototype.Rf=function(a,b,c){b=this.data.t[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].Hr(a))return b[c];return b[0]};b.Fh.prototype.tk=function(a,b,c){b=this.data.t[b].keys;
for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].Hr(a))return b[c];return b[b.length-1]};b.Wo=function(a,e,c){b.C.call(this);var d=new b.Lb(90,1,a,e);d.od.set(0,-1,0);d.Fb(new b.a(1,0,0));this.add(d);d=new b.Lb(90,1,a,e);d.od.set(0,-1,0);d.Fb(new b.a(-1,0,0));this.add(d);d=new b.Lb(90,1,a,e);d.od.set(0,0,1);d.Fb(new b.a(0,1,0));this.add(d);d=new b.Lb(90,1,a,e);d.od.set(0,0,-1);d.Fb(new b.a(0,-1,0));this.add(d);d=new b.Lb(90,1,a,e);d.od.set(0,-1,0);d.Fb(new b.a(0,0,1));this.add(d);a=new b.Lb(90,1,a,e);a.od.set(0,
-1,0);a.Fb(new b.a(0,0,-1));this.add(a);this.jo=new b.Fe(c,c,{ba:b.tj,Gb:b.ye,mb:b.ye})};b.Wo.prototype=Object.create(b.C.prototype);b.Bh=function(a,e,c,d,f,g,h){b.fb.call(this);this.bd=c;this.left=-a/2;this.right=a/2;this.top=e/2;this.bottom=-e/2;this.$d=new b.Rd(a/-2,a/2,e/2,e/-2,g,h);this.ae=new b.Lb(c,a/e,d,f);this.zoom=1;this.gl()};b.Bh.prototype=Object.create(b.fb.prototype);b.Bh.prototype.gl=function(){this.ta=this.ae.ta;this.wa=this.ae.wa;this.ae.bd=this.bd/this.zoom;this.ae.hf();this.xa=
this.ae.xa;this.ln=!0};b.Bh.prototype.It=function(){var a=this.ae.Ff,b=(this.ae.ta+this.ae.wa)/2,b=Math.tan(this.bd/2)*b,a=2*b*a/2,b=b/this.zoom,a=a/this.zoom;this.$d.left=-a;this.$d.right=a;this.$d.top=b;this.$d.bottom=-b;this.$d.hf();this.ta=this.$d.ta;this.wa=this.$d.wa;this.xa=this.$d.xa;this.ln=!1};b.Bh.prototype.hf=function(){this.ln?this.gl():(this.gl(),this.It())};b.ql=function(a,e,c,d){b.B.call(this);this.K=a=a||50;this.jd=e=void 0!==e?Math.max(3,e):8;this.Eo=c=void 0!==c?c:0;this.Do=d=void 0!==
d?d:2*Math.PI;var f,g=[],h=new b.h(0.5,0.5);this.e.push(new b.a);g.push(h);for(f=0;f<=e;f++){var k=new b.a,n=c+f/e*d;k.x=a*Math.cos(n);k.y=a*Math.sin(n);this.e.push(k);g.push(new b.h((k.x/a+1)/2,(k.y/a+1)/2))}c=new b.a(0,0,1);for(f=1;f<=e;f++)this.i.push(new b.N(f,f+1,0,[c.b(),c.b(),c.b()])),this.v[0].push([g[f].b(),g[f+1].b(),h.b()]);this.ub();this.vb();this.ib=new b.tc(new b.a,a)};b.ql.prototype=Object.create(b.B.prototype);b.Ch=function(a,e,c,d,f,g){function h(a,c,d,e,f,g,h,s){var x,z=k.Pc,t=k.dc,
w=f/2,y=g/2,H=k.e.length;if("x"===a&&"y"===c||"y"===a&&"x"===c)x="z";else if("x"===a&&"z"===c||"z"===a&&"x"===c)x="y",t=k.ii;else if("z"===a&&"y"===c||"y"===a&&"z"===c)x="x",z=k.ii;var N=z+1,Q=t+1,C=f/z,M=g/t,I=new b.a;I[x]=0<h?1:-1;for(f=0;f<Q;f++)for(g=0;g<N;g++){var D=new b.a;D[a]=(g*C-w)*d;D[c]=(f*M-y)*e;D[x]=h;k.e.push(D)}for(f=0;f<t;f++)for(g=0;g<z;g++)a=g+N*(f+1),c=g+1+N*(f+1),d=g+1+N*f,e=new b.h(g/z,1-f/t),h=new b.h(g/z,1-(f+1)/t),x=new b.h((g+1)/z,1-(f+1)/t),w=new b.h((g+1)/z,1-f/t),y=new b.N(g+
N*f+H,a+H,d+H),y.F.copy(I),y.V.push(I.b(),I.b(),I.b()),y.fc=s,k.i.push(y),k.v[0].push([e,h,w]),y=new b.N(a+H,c+H,d+H),y.F.copy(I),y.V.push(I.b(),I.b(),I.b()),y.fc=s,k.i.push(y),k.v[0].push([h.b(),x,w.b()])}b.B.call(this);var k=this;this.width=a;this.height=e;this.depth=c;this.Pc=d||1;this.dc=f||1;this.ii=g||1;a=this.width/2;e=this.height/2;c=this.depth/2;h("z","y",-1,-1,this.depth,this.height,a,0);h("z","y",1,-1,this.depth,this.height,-a,1);h("x","z",1,1,this.width,this.depth,e,2);h("x","z",1,-1,
this.width,this.depth,-e,3);h("x","y",1,-1,this.width,this.height,c,4);h("x","y",-1,-1,this.width,this.height,-c,5);this.ub();this.Ci()};b.Ch.prototype=Object.create(b.B.prototype);b.mg=function(a,e,c,d,f,g){b.B.call(this);this.Rs=a=void 0!==a?a:20;this.Qs=e=void 0!==e?e:20;this.height=c=void 0!==c?c:100;this.qa=d=d||8;this.dc=f=f||1;this.Fs=g=void 0!==g?g:!1;var h=c/2,k,n,l=[],p=[];for(n=0;n<=f;n++){var r=[],q=[],v=n/f,u=v*(e-a)+a;for(k=0;k<=d;k++){var s=k/d,x=new b.a;x.x=u*Math.sin(2*s*Math.PI);
x.y=-v*c+h;x.z=u*Math.cos(2*s*Math.PI);this.e.push(x);r.push(this.e.length-1);q.push(new b.h(s,1-v))}l.push(r);p.push(q)}c=(e-a)/c;for(k=0;k<d;k++)for(0!==a?(r=this.e[l[0][k]].b(),q=this.e[l[0][k+1]].b()):(r=this.e[l[1][k]].b(),q=this.e[l[1][k+1]].b()),r.Ni(Math.sqrt(r.x*r.x+r.z*r.z)*c).normalize(),q.Ni(Math.sqrt(q.x*q.x+q.z*q.z)*c).normalize(),n=0;n<f;n++){var v=l[n][k],u=l[n+1][k],s=l[n+1][k+1],x=l[n][k+1],z=r.b(),t=r.b(),w=q.b(),y=q.b(),H=p[n][k].b(),N=p[n+1][k].b(),Q=p[n+1][k+1].b(),C=p[n][k+
1].b();this.i.push(new b.N(v,u,x,[z,t,y]));this.v[0].push([H,N,C]);this.i.push(new b.N(u,s,x,[t.b(),w,y.b()]));this.v[0].push([N.b(),Q,C.b()])}if(!1===g&&0<a)for(this.e.push(new b.a(0,h,0)),k=0;k<d;k++)v=l[0][k],u=l[0][k+1],s=this.e.length-1,z=new b.a(0,1,0),t=new b.a(0,1,0),w=new b.a(0,1,0),H=p[0][k].b(),N=p[0][k+1].b(),Q=new b.h(N.x,0),this.i.push(new b.N(v,u,s,[z,t,w])),this.v[0].push([H,N,Q]);if(!1===g&&0<e)for(this.e.push(new b.a(0,-h,0)),k=0;k<d;k++)v=l[n][k+1],u=l[n][k],s=this.e.length-1,z=
new b.a(0,-1,0),t=new b.a(0,-1,0),w=new b.a(0,-1,0),H=p[n][k+1].b(),N=p[n][k].b(),Q=new b.h(N.x,1),this.i.push(new b.N(v,u,s,[z,t,w])),this.v[0].push([H,N,Q]);this.ub();this.vb()};b.mg.prototype=Object.create(b.B.prototype);b.Oa=function(a,e){"undefined"!==typeof a&&(b.B.call(this),a=a instanceof Array?a:[a],a[a.length-1].pi(),this.Mj(a,e),this.ub(),this.vb())};b.Oa.prototype=Object.create(b.B.prototype);b.Oa.prototype.Mj=function(a,b){for(var c=a.length,d=0;d<c;d++)this.Lj(a[d],b)};b.Oa.prototype.Lj=
function(a,e){function c(a,b,c){b||console.log("die");return b.b().q(c).add(a)}function d(a,c,d){var e=b.Oa.Up,f=b.Oa.Vp,g=b.Oa.Wp,h=b.Oa.Xp,k=b.Oa.Yp,l=b.Oa.Zp;e.set(a.x-c.x,a.y-c.y);f.set(a.x-d.x,a.y-d.y);e=e.normalize();f=f.normalize();g.set(-e.y,e.x);h.set(f.y,-f.x);k.copy(a).add(g);l.copy(a).add(h);if(k.oa(l))return h.b();k.copy(c).add(g);l.copy(d).add(h);g=e.za(h);h=l.sub(k).za(h);0===g&&(console.log("Either infinite or no solutions!"),0===h?console.log("Its finite solutions."):console.log("Too bad, no solutions."));
h/=g;0>h?(c=Math.atan2(c.y-a.y,c.x-a.x),a=Math.atan2(d.y-a.y,d.x-a.x),c>a&&(a+=2*Math.PI),a=(c+a)/2,a=new b.h(-Math.cos(a),-Math.sin(a))):a=e.q(h).add(k).sub(a).b();return a}function f(c,d){var f,g;for(R=c.length;0<=--R;){f=R;g=R-1;0>g&&(g=c.length-1);for(var h=0,k=v+2*p,h=0;h<k;h++){var l=aa*h,n=aa*(h+1),r=d+f+l,l=d+g+l,q=d+g+n,n=d+f+n,s=c,u=h,x=k,z=f,y=g,r=r+K,l=l+K,q=q+K,n=n+K;D.i.push(new b.N(r,l,n,null,null,t));D.i.push(new b.N(l,q,n,null,null,t));r=w.ur(D,a,s,e,r,l,q,n,u,x,z,y);D.v[0].push([r[0],
r[1],r[3]]);D.v[0].push([r[1],r[2],r[3]])}}}function g(a,c,d){D.e.push(new b.a(a,c,d))}function h(c,d,f,g){c+=K;d+=K;f+=K;D.i.push(new b.N(c,d,f,null,null,z));D.v[0].push(g?w.Zm(D,a,e,c,d,f):w.$m(D,a,e,c,d,f))}var k=void 0!==e.zm?e.zm:100,n=void 0!==e.Vj?e.Vj:6,l=void 0!==e.Uj?e.Uj:n-2,p=void 0!==e.Kq?e.Kq:3,r=void 0!==e.Tj?e.Tj:!0,q=void 0!==e.Og?e.Og:12,v=void 0!==e.Dt?e.Dt:1,u=e.Dv,s,x=!1,z=e.D,t=e.Cv,w=void 0!==e.yj?e.yj:b.Oa.dm,y,H,N,Q;u&&(s=u.ri(v),x=!0,r=!1,y=void 0!==e.frames?e.frames:new b.Nh.xl(u,
v,!1),H=new b.a,N=new b.a,Q=new b.a);r||(l=n=p=0);var C,M,I,D=this,K=this.e.length,u=a.Tm(q),q=u.shape,F=u.ed;if(u=!b.Y.T.Te(q)){q=q.reverse();M=0;for(I=F.length;M<I;M++)C=F[M],b.Y.T.Te(C)&&(F[M]=C.reverse());u=!1}var A=b.Y.T.Ho(q,F),J=q;M=0;for(I=F.length;M<I;M++)C=F[M],q=q.concat(C);var E,W,G,S,X,aa=q.length,P,Y=A.length,u=[],R=0;G=J.length;E=G-1;for(W=R+1;R<G;R++,E++,W++)E===G&&(E=0),W===G&&(W=0),u[R]=d(J[R],J[E],J[W]);var pa=[],ma,va=u.concat();M=0;for(I=F.length;M<I;M++){C=F[M];ma=[];R=0;G=C.length;
E=G-1;for(W=R+1;R<G;R++,E++,W++)E===G&&(E=0),W===G&&(W=0),ma[R]=d(C[R],C[E],C[W]);pa.push(ma);va=va.concat(ma)}for(E=0;E<p;E++){G=E/p;S=n*(1-G);W=l*Math.sin(G*Math.PI/2);R=0;for(G=J.length;R<G;R++)X=c(J[R],u[R],W),g(X.x,X.y,-S);M=0;for(I=F.length;M<I;M++)for(C=F[M],ma=pa[M],R=0,G=C.length;R<G;R++)X=c(C[R],ma[R],W),g(X.x,X.y,-S)}W=l;for(R=0;R<aa;R++)X=r?c(q[R],va[R],W):q[R],x?(N.copy(y.gh[0]).q(X.x),H.copy(y.ci[0]).q(X.y),Q.copy(s[0]).add(N).add(H),g(Q.x,Q.y,Q.z)):g(X.x,X.y,0);for(G=1;G<=v;G++)for(R=
0;R<aa;R++)X=r?c(q[R],va[R],W):q[R],x?(N.copy(y.gh[G]).q(X.x),H.copy(y.ci[G]).q(X.y),Q.copy(s[G]).add(N).add(H),g(Q.x,Q.y,Q.z)):g(X.x,X.y,k/v*G);for(E=p-1;0<=E;E--){G=E/p;S=n*(1-G);W=l*Math.sin(G*Math.PI/2);R=0;for(G=J.length;R<G;R++)X=c(J[R],u[R],W),g(X.x,X.y,k+S);M=0;for(I=F.length;M<I;M++)for(C=F[M],ma=pa[M],R=0,G=C.length;R<G;R++)X=c(C[R],ma[R],W),x?g(X.x,X.y+s[v-1].y,s[v-1].x+S):g(X.x,X.y,k+S)}(function(){if(r){var a;a=0*aa;for(R=0;R<Y;R++)P=A[R],h(P[2]+a,P[1]+a,P[0]+a,!0);a=v+2*p;a*=aa;for(R=
0;R<Y;R++)P=A[R],h(P[0]+a,P[1]+a,P[2]+a,!1)}else{for(R=0;R<Y;R++)P=A[R],h(P[2],P[1],P[0],!0);for(R=0;R<Y;R++)P=A[R],h(P[0]+aa*v,P[1]+aa*v,P[2]+aa*v,!1)}})();(function(){var a=0;f(J,a);a+=J.length;M=0;for(I=F.length;M<I;M++)C=F[M],f(C,a),a+=C.length})()};b.Oa.dm={$m:function(a,e,c,d,f,g){return[new b.h(a.e[d].x,a.e[d].y),new b.h(a.e[f].x,a.e[f].y),new b.h(a.e[g].x,a.e[g].y)]},Zm:function(a,b,c,d,f,g){return this.$m(a,b,c,d,f,g)},ur:function(a,e,c,d,f,g,h,k){e=a.e[f].x;c=a.e[f].y;f=a.e[f].z;d=a.e[g].x;
var n=a.e[g].y;g=a.e[g].z;var l=a.e[h].x,p=a.e[h].y;h=a.e[h].z;var r=a.e[k].x,q=a.e[k].y;a=a.e[k].z;return 0.01>Math.abs(c-n)?[new b.h(e,1-f),new b.h(d,1-g),new b.h(l,1-h),new b.h(r,1-a)]:[new b.h(c,1-f),new b.h(n,1-g),new b.h(p,1-h),new b.h(q,1-a)]}};b.Oa.Up=new b.h;b.Oa.Vp=new b.h;b.Oa.Wp=new b.h;b.Oa.Xp=new b.h;b.Oa.Yp=new b.h;b.Oa.Zp=new b.h;b.vj=function(a,e){b.B.call(this);!1===a instanceof Array&&(a=[a]);a[a.length-1].pi();this.Mj(a,e);this.ub();this.vb()};b.vj.prototype=Object.create(b.B.prototype);
b.vj.prototype.Mj=function(a,b){for(var c=0,d=a.length;c<d;c++)this.Lj(a[c],b);return this};b.vj.prototype.Lj=function(a,e){void 0===e&&(e={});var c=e.D,d=void 0===e.yj?b.Oa.dm:e.yj,f,g,h,k=this.e.length;f=a.Tm(void 0!==e.Og?e.Og:12);var n=f.shape,l=f.ed;if(!b.Y.T.Te(n))for(n=n.reverse(),f=0,g=l.length;f<g;f++)h=l[f],b.Y.T.Te(h)&&(l[f]=h.reverse());var p=b.Y.T.Ho(n,l);f=0;for(g=l.length;f<g;f++)h=l[f],n=n.concat(h);l=n.length;g=p.length;for(f=0;f<l;f++)h=n[f],this.e.push(new b.a(h.x,h.y,0));for(f=
0;f<g;f++)l=p[f],n=l[0]+k,h=l[1]+k,l=l[2]+k,this.i.push(new b.N(n,h,l,null,null,c)),this.v[0].push(d.Zm(this,a,e,n,h,l))};b.fp=function(a,e,c,d){b.B.call(this);e=e||12;c=c||0;d=d||2*Math.PI;for(var f=1/(a.length-1),g=1/e,h=0,k=e;h<=k;h++)for(var n=c+h*g*d,l=Math.cos(n),p=Math.sin(n),n=0,r=a.length;n<r;n++){var q=a[n],v=new b.a;v.x=l*q.x-p*q.y;v.y=p*q.x+l*q.y;v.z=q.z;this.e.push(v)}c=a.length;h=0;for(k=e;h<k;h++)for(n=0,r=a.length-1;n<r;n++){e=p=n+c*h;d=p+c;var l=p+1+c,p=p+1,q=h*g,v=n*f,u=q+g,s=v+
f;this.i.push(new b.N(e,d,p));this.v[0].push([new b.h(q,v),new b.h(u,v),new b.h(q,s)]);this.i.push(new b.N(d,l,p));this.v[0].push([new b.h(u,v),new b.h(u,s),new b.h(q,s)])}this.Ci();this.ub();this.vb();this.Pe()};b.fp.prototype=Object.create(b.B.prototype);b.Jh=function(a,e,c,d){b.B.call(this);this.width=a;this.height=e;this.Pc=c||1;this.dc=d||1;var f=a/2,g=e/2;c=this.Pc;d=this.dc;var h=c+1,k=d+1,n=this.width/c,l=this.height/d,p=new b.a(0,0,1);for(a=0;a<k;a++)for(e=0;e<h;e++)this.e.push(new b.a(e*
n-f,-(a*l-g),0));for(a=0;a<d;a++)for(e=0;e<c;e++){var f=e+h*(a+1),g=e+1+h*(a+1),k=e+1+h*a,n=new b.h(e/c,1-a/d),l=new b.h(e/c,1-(a+1)/d),r=new b.h((e+1)/c,1-(a+1)/d),q=new b.h((e+1)/c,1-a/d),v=new b.N(e+h*a,f,k);v.F.copy(p);v.V.push(p.b(),p.b(),p.b());this.i.push(v);this.v[0].push([n,l,q]);v=new b.N(f,g,k);v.F.copy(p);v.V.push(p.b(),p.b(),p.b());this.i.push(v);this.v[0].push([l.b(),r,q.b()])}this.ub()};b.Jh.prototype=Object.create(b.B.prototype);b.xp=function(a,e,c,d,f,g){b.B.call(this);a=a||0;e=e||
50;f=void 0!==f?f:0;g=void 0!==g?g:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(3,d):8;var h,k=[],n=a,l=(e-a)/d;for(a=0;a<=d;a++){for(h=0;h<=c;h++){var p=new b.a,r=f+h/c*g;p.x=n*Math.cos(r);p.y=n*Math.sin(r);this.e.push(p);k.push(new b.h((p.x/e+1)/2,(p.y/e+1)/2))}n+=l}e=new b.a(0,0,1);for(a=0;a<d;a++)for(f=a*c,h=0;h<=c;h++)r=h+f,g=r+a,l=r+c+a,p=r+c+1+a,this.i.push(new b.N(g,l,p,[e.b(),e.b(),e.b()])),this.v[0].push([k[g].b(),k[l].b(),k[p].b()]),g=r+a,l=r+c+1+a,p=r+1+a,this.i.push(new b.N(g,
l,p,[e.b(),e.b(),e.b()])),this.v[0].push([k[g].b(),k[l].b(),k[p].b()]);this.ub();this.vb();this.ib=new b.tc(new b.a,n)};b.xp.prototype=Object.create(b.B.prototype);b.ug=function(a,e,c,d,f,g,h){b.B.call(this);this.K=a=a||50;this.Pc=e=Math.max(3,Math.floor(e)||8);this.dc=c=Math.max(2,Math.floor(c)||6);this.Ls=d=void 0!==d?d:0;this.Ks=f=void 0!==f?f:2*Math.PI;this.Eo=g=void 0!==g?g:0;this.Do=h=void 0!==h?h:Math.PI;var k,n,l=[],p=[];for(n=0;n<=c;n++){var r=[],q=[];for(k=0;k<=e;k++){var v=k/e,u=n/c,s=
new b.a;s.x=-a*Math.cos(d+v*f)*Math.sin(g+u*h);s.y=a*Math.cos(g+u*h);s.z=a*Math.sin(d+v*f)*Math.sin(g+u*h);this.e.push(s);r.push(this.e.length-1);q.push(new b.h(v,1-u))}l.push(r);p.push(q)}for(n=0;n<this.dc;n++)for(k=0;k<this.Pc;k++){e=l[n][k+1];c=l[n][k];d=l[n+1][k];f=l[n+1][k+1];g=this.e[e].b().normalize();h=this.e[c].b().normalize();var r=this.e[d].b().normalize(),q=this.e[f].b().normalize(),v=p[n][k+1].b(),u=p[n][k].b(),s=p[n+1][k].b(),x=p[n+1][k+1].b();Math.abs(this.e[e].y)===this.K?(v.x=(v.x+
u.x)/2,this.i.push(new b.N(e,d,f,[g,r,q])),this.v[0].push([v,s,x])):Math.abs(this.e[d].y)===this.K?(s.x=(s.x+x.x)/2,this.i.push(new b.N(e,c,d,[g,h,r])),this.v[0].push([v,u,s])):(this.i.push(new b.N(e,c,f,[g,h,q])),this.v[0].push([v,u,x]),this.i.push(new b.N(c,d,f,[h.b(),r,q.b()])),this.v[0].push([u.b(),s,x.b()]))}this.ub();this.vb();this.ib=new b.tc(new b.a,a)};b.ug.prototype=Object.create(b.B.prototype);b.Fp=function(a,e){e=e||{};var c=b.gb.tr(a,e);e.zm=void 0!==e.height?e.height:50;void 0===e.Vj&&
(e.Vj=10);void 0===e.Uj&&(e.Uj=8);void 0===e.Tj&&(e.Tj=!1);b.Oa.call(this,c,e)};b.Fp.prototype=Object.create(b.Oa.prototype);b.xj=function(a,e,c,d,f){b.B.call(this);this.K=a||100;this.Nd=e||40;this.qa=c||8;this.Va=d||6;this.arc=f||2*Math.PI;f=new b.a;a=[];e=[];for(c=0;c<=this.qa;c++)for(d=0;d<=this.Va;d++){var g=d/this.Va*this.arc,h=2*(c/this.qa)*Math.PI;f.x=this.K*Math.cos(g);f.y=this.K*Math.sin(g);var k=new b.a;k.x=(this.K+this.Nd*Math.cos(h))*Math.cos(g);k.y=(this.K+this.Nd*Math.cos(h))*Math.sin(g);
k.z=this.Nd*Math.sin(h);this.e.push(k);a.push(new b.h(d/this.Va,c/this.qa));e.push(k.b().sub(f).normalize())}for(c=1;c<=this.qa;c++)for(d=1;d<=this.Va;d++){f=(this.Va+1)*c+d-1;var g=(this.Va+1)*(c-1)+d-1,h=(this.Va+1)*(c-1)+d,k=(this.Va+1)*c+d,n=new b.N(f,g,k,[e[f].b(),e[g].b(),e[k].b()]);this.i.push(n);this.v[0].push([a[f].b(),a[g].b(),a[k].b()]);n=new b.N(g,h,k,[e[g].b(),e[h].b(),e[k].b()]);this.i.push(n);this.v[0].push([a[g].b(),a[h].b(),a[k].b()])}this.ub();this.vb()};b.xj.prototype=Object.create(b.B.prototype);
b.$l=function(a,e,c,d,f,g,h){function k(a,c,d,e,f){c=c/d*a;d=Math.cos(c);return new b.a(0.5*e*(2+d)*Math.cos(a),0.5*e*(2+d)*Math.sin(a),0.5*f*e*Math.sin(c))}b.B.call(this);this.K=a||100;this.Nd=e||40;this.qa=c||64;this.Va=d||8;this.Gi=f||2;this.Mk=g||3;this.vk=h||1;this.cc=Array(this.qa);c=new b.a;d=new b.a;f=new b.a;for(a=0;a<this.qa;++a)for(this.cc[a]=Array(this.Va),e=2*(a/this.qa)*this.Gi*Math.PI,g=k(e,this.Mk,this.Gi,this.K,this.vk),e=k(e+0.01,this.Mk,this.Gi,this.K,this.vk),c.ea(e,g),d.Hc(e,
g),f.Cb(c,d),d.Cb(f,c),f.normalize(),d.normalize(),e=0;e<this.Va;++e){var n=2*(e/this.Va)*Math.PI;h=-this.Nd*Math.cos(n);var n=this.Nd*Math.sin(n),l=new b.a;l.x=g.x+h*d.x+n*f.x;l.y=g.y+h*d.y+n*f.y;l.z=g.z+h*d.z+n*f.z;this.cc[a][e]=this.e.push(l)-1}for(a=0;a<this.qa;++a)for(e=0;e<this.Va;++e)d=(a+1)%this.qa,f=(e+1)%this.Va,c=this.cc[d][e],d=this.cc[d][f],f=this.cc[a][f],g=new b.h(a/this.qa,e/this.Va),h=new b.h((a+1)/this.qa,e/this.Va),n=new b.h((a+1)/this.qa,(e+1)/this.Va),l=new b.h(a/this.qa,(e+1)/
this.Va),this.i.push(new b.N(this.cc[a][e],c,f)),this.v[0].push([g,h,l]),this.i.push(new b.N(c,d,f)),this.v[0].push([h.b(),n,l.b()]);this.ub();this.vb();this.Pe()};b.$l.prototype=Object.create(b.B.prototype);b.Nh=function(a,e,c,d,f){b.B.call(this);this.path=a;this.jd=e||64;this.K=c||1;this.qa=d||8;this.closed=f||!1;this.cc=[];var g,h;d=this.jd+1;var k,n,l;f=new b.a;var p,r;e=new b.Nh.xl(this.path,this.jd,this.closed);p=e.gh;r=e.ci;this.Co=e.Co;this.gh=p;this.ci=r;for(e=0;e<d;e++)for(this.cc[e]=[],
c=e/(d-1),l=a.Xg(c),g=p[e],h=r[e],c=0;c<this.qa;c++)k=2*(c/this.qa)*Math.PI,n=-this.K*Math.cos(k),k=this.K*Math.sin(k),f.copy(l),f.x+=n*g.x+k*h.x,f.y+=n*g.y+k*h.y,f.z+=n*g.z+k*h.z,this.cc[e][c]=this.e.push(new b.a(f.x,f.y,f.z))-1;for(e=0;e<this.jd;e++)for(c=0;c<this.qa;c++)f=this.closed?(e+1)%this.jd:e+1,p=(c+1)%this.qa,a=this.cc[e][c],d=this.cc[f][c],f=this.cc[f][p],p=this.cc[e][p],r=new b.h(e/this.jd,c/this.qa),g=new b.h((e+1)/this.jd,c/this.qa),h=new b.h((e+1)/this.jd,(c+1)/this.qa),n=new b.h(e/
this.jd,(c+1)/this.qa),this.i.push(new b.N(a,d,p)),this.v[0].push([r,g,n]),this.i.push(new b.N(d,f,p)),this.v[0].push([g.b(),h,n.b()]);this.ub();this.vb();this.Pe()};b.Nh.prototype=Object.create(b.B.prototype);b.Nh.xl=function(a,e,c){var d=new b.a,f=[],g=[],h=[],k=new b.a,n=new b.$;e+=1;var l,p,r;this.Co=f;this.gh=g;this.ci=h;for(l=0;l<e;l++)p=l/(e-1),f[l]=a.Cr(p),f[l].normalize();g[0]=new b.a;h[0]=new b.a;a=Number.MAX_VALUE;l=Math.abs(f[0].x);p=Math.abs(f[0].y);r=Math.abs(f[0].z);l<=a&&(a=l,d.set(1,
0,0));p<=a&&(a=p,d.set(0,1,0));r<=a&&d.set(0,0,1);k.Cb(f[0],d).normalize();g[0].Cb(f[0],k);h[0].Cb(f[0],g[0]);for(l=1;l<e;l++)g[l]=g[l-1].b(),h[l]=h[l-1].b(),k.Cb(f[l-1],f[l]),1E-4<k.length()&&(k.normalize(),d=Math.acos(b.Jb.be(f[l-1].za(f[l]),-1,1)),g[l].O(n.Bn(k,d))),h[l].Cb(f[l],g[l]);if(c)for(d=Math.acos(b.Jb.be(g[0].za(g[e-1]),-1,1)),d/=e-1,0<f[0].za(k.Cb(g[0],g[e-1]))&&(d=-d),l=1;l<e;l++)g[l].O(n.Bn(f[l],d*l)),h[l].Cb(f[l],g[l])};b.Kh=function(a,e,c,d){function f(a){var c=a.normalize().b();
c.index=n.e.push(c)-1;c.ic=new b.h(Math.atan2(a.z,-a.x)/2/Math.PI+0.5,1-(Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5));return c}function g(a,c,d){var e=new b.N(a.index,c.index,d.index,[a.b(),c.b(),d.b()]);e.jb.add(a).add(c).add(d).de(3);n.i.push(e);e=Math.atan2(e.jb.z,-e.jb.x);n.v[0].push([k(a.ic,a,e),k(c.ic,c,e),k(d.ic,d,e)])}function h(a,b){for(var c=Math.pow(2,b),d=f(n.e[a.I]),e=f(n.e[a.g]),h=f(n.e[a.J]),k=[],l=0;l<=c;l++){k[l]=[];for(var p=f(d.b().je(h,l/c)),r=f(e.b().je(h,l/c)),q=
c-l,u=0;u<=q;u++)k[l][u]=0==u&&l==c?p:f(p.b().je(r,u/q))}for(l=0;l<c;l++)for(u=0;u<2*(c-l)-1;u++)d=Math.floor(u/2),0==u%2?g(k[l][d+1],k[l+1][d],k[l][d]):g(k[l][d+1],k[l+1][d+1],k[l+1][d])}function k(a,c,d){0>d&&1===a.x&&(a=new b.h(a.x-1,a.y));0===c.x&&0===c.z&&(a=new b.h(d/2/Math.PI+0.5,a.y));return a.b()}b.B.call(this);c=c||1;d=d||0;for(var n=this,l=0,p=a.length;l<p;l++)f(new b.a(a[l][0],a[l][1],a[l][2]));a=this.e;for(var r=[],l=0,p=e.length;l<p;l++){var q=a[e[l][0]],v=a[e[l][1]],u=a[e[l][2]];r[l]=
new b.N(q.index,v.index,u.index,[q.b(),v.b(),u.b()])}l=0;for(p=r.length;l<p;l++)h(r[l],d);l=0;for(p=this.v[0].length;l<p;l++)e=this.v[0][l],d=e[0].x,a=e[1].x,r=e[2].x,q=Math.max(d,Math.max(a,r)),v=Math.min(d,Math.min(a,r)),0.9<q&&0.1>v&&(0.2>d&&(e[0].x+=1),0.2>a&&(e[1].x+=1),0.2>r&&(e[2].x+=1));l=0;for(p=this.e.length;l<p;l++)this.e[l].q(c);this.Ci();this.ub();this.vb();this.ib=new b.tc(new b.a,c)};b.Kh.prototype=Object.create(b.B.prototype);b.hj=function(a,e){this.K=a;this.detail=e;var c=(1+Math.sqrt(5))/
2;b.Kh.call(this,[[-1,c,0],[1,c,0],[-1,-c,0],[1,-c,0],[0,-1,c],[0,1,c],[0,-1,-c],[0,1,-c],[c,0,-1],[c,0,1],[-c,0,-1],[-c,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],a,e)};b.hj.prototype=Object.create(b.B.prototype);b.op=function(a,e){b.Kh.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],
a,e)};b.op.prototype=Object.create(b.B.prototype);b.Ep=function(a,e){b.Kh.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],a,e)};b.Ep.prototype=Object.create(b.B.prototype);b.tp=function(a,e,c){b.B.call(this);var d=this.e,f=this.i,g=this.v[0],h,k,n,l,p=e+1;for(h=0;h<=c;h++)for(l=h/c,k=0;k<=e;k++)n=k/e,n=a(n,l),d.push(n);var r,q,v,u;for(h=0;h<c;h++)for(k=0;k<e;k++)a=h*p+k,d=h*p+k+1,l=(h+1)*p+k+1,n=(h+1)*p+k,r=new b.h(k/e,h/c),q=new b.h((k+1)/e,h/c),v=new b.h((k+1)/
e,(h+1)/c),u=new b.h(k/e,(h+1)/c),f.push(new b.N(a,d,n)),g.push([r,q,u]),f.push(new b.N(d,l,n)),g.push([q.b(),v,u.b()]);this.ub();this.vb();this.Pe()};b.tp.prototype=Object.create(b.B.prototype);b.So=function(a){a=a||1;var e=new b.B;e.e.push(new b.a,new b.a(a,0,0),new b.a,new b.a(0,a,0),new b.a,new b.a(0,0,a));e.va.push(new b.p(16711680),new b.p(16755200),new b.p(65280),new b.p(11206400),new b.p(255),new b.p(43775));a=new b.ab({u:b.De});b.fa.call(this,e,a,b.Tc)};b.So.prototype=Object.create(b.fa.prototype);
b.$i=function(a,e,c,d,f,g){b.C.call(this);void 0===d&&(d=16776960);void 0===c&&(c=1);void 0===f&&(f=0.2*c);void 0===g&&(g=0.2*f);this.position=e;e=new b.B;e.e.push(new b.a(0,0,0));e.e.push(new b.a(0,1,0));this.xi=new b.fa(e,new b.ab({color:d}));this.xi.sa=!1;this.add(this.xi);e=new b.mg(0,0.5,1,5,1);e.Bd((new b.$).Ck(0,-0.5,0));this.$c=new b.U(e,new b.Kb({color:d}));this.$c.sa=!1;this.add(this.$c);this.at(a);this.Mi(c,f,g)};b.$i.prototype=Object.create(b.C.prototype);b.$i.prototype.at=function(){var a=
new b.a,e;return function(b){0.99999<b.y?this.Ca.set(0,0,0,1):-0.99999>b.y?this.Ca.set(1,0,0,0):(a.set(b.z,0,-b.x).normalize(),e=Math.acos(b.y),this.Ca.oo(a,e))}}();b.$i.prototype.Mi=function(a,b,c){void 0===b&&(b=0.2*a);void 0===c&&(c=0.2*b);this.xi.scale.set(1,a,1);this.xi.Bc();this.$c.scale.set(c,b,c);this.$c.position.y=a;this.$c.Bc()};b.pl=function(a){var e=[new b.a(1,1,1),new b.a(-1,1,1),new b.a(-1,-1,1),new b.a(1,-1,1),new b.a(1,1,-1),new b.a(-1,1,-1),new b.a(-1,-1,-1),new b.a(1,-1,-1)];this.e=
e;var c=new b.B;c.e.push(e[0],e[1],e[1],e[2],e[2],e[3],e[3],e[0],e[4],e[5],e[5],e[6],e[6],e[7],e[7],e[4],e[0],e[4],e[1],e[5],e[2],e[6],e[3],e[7]);b.fa.call(this,c,new b.ab({color:16776960}),b.Tc);void 0!==a&&this.update(a)};b.pl.prototype=Object.create(b.fa.prototype);b.pl.prototype.update=function(a){var b=a.j;null===b.Qb&&b.Jg();var c=b.Qb.min,b=b.Qb.max,d=this.e;d[0].set(b.x,b.y,b.z);d[1].set(c.x,b.y,b.z);d[2].set(c.x,c.y,b.z);d[3].set(b.x,c.y,b.z);d[4].set(b.x,b.y,c.z);d[5].set(c.x,b.y,c.z);d[6].set(c.x,
c.y,c.z);d[7].set(b.x,c.y,c.z);this.j.Kg();this.j.$a=!0;this.sa=!1;this.l=a.l};b.ol=function(a,e){var c=void 0!==e?e:8947848;this.object=a;this.Xj=new b.lc;b.U.call(this,new b.Ch(1,1,1),new b.Kb({color:c,W:!0}))};b.ol.prototype=Object.create(b.U.prototype);b.ol.prototype.update=function(){this.Xj.dt(this.object);this.Xj.size(this.scale);this.Xj.ua(this.position)};b.cj=function(a){function e(a,b,d){c(a,d);c(b,d)}function c(a,c){d.e.push(new b.a);d.va.push(new b.p(c));void 0===g[a]&&(g[a]=[]);g[a].push(d.e.length-
1)}var d=new b.B,f=new b.ab({color:16777215,u:b.pf}),g={};e("n1","n2",16755200);e("n2","n4",16755200);e("n4","n3",16755200);e("n3","n1",16755200);e("f1","f2",16755200);e("f2","f4",16755200);e("f4","f3",16755200);e("f3","f1",16755200);e("n1","f1",16755200);e("n2","f2",16755200);e("n3","f3",16755200);e("n4","f4",16755200);e("p","n1",16711680);e("p","n2",16711680);e("p","n3",16711680);e("p","n4",16711680);e("u1","u2",43775);e("u2","u3",43775);e("u3","u1",43775);e("c","t",16777215);e("p","c",3355443);
e("cn1","cn2",3355443);e("cn3","cn4",3355443);e("cf1","cf2",3355443);e("cf3","cf4",3355443);b.fa.call(this,d,f,b.Tc);this.$j=a;this.l=a.l;this.sa=!1;this.Ms=g;this.update()};b.cj.prototype=Object.create(b.fa.prototype);b.cj.prototype.update=function(){var a=new b.a,e=new b.fb,c=new b.sj;return function(){function b(d,h,k,n){a.set(h,k,n);c.Ko(a,e);d=f.Ms[d];if(void 0!==d)for(h=0,k=d.length;h<k;h++)f.j.e[d[h]].copy(a)}var f=this;e.xa.copy(this.$j.xa);b("c",0,0,-1);b("t",0,0,1);b("n1",-1,-1,-1);b("n2",
1,-1,-1);b("n3",-1,1,-1);b("n4",1,1,-1);b("f1",-1,-1,1);b("f2",1,-1,1);b("f3",-1,1,1);b("f4",1,1,1);b("u1",0.7,1.1,-1);b("u2",-0.7,1.1,-1);b("u3",0,2,-1);b("cf1",-1,0,1);b("cf2",1,0,1);b("cf3",0,-1,1);b("cf4",0,1,1);b("cn1",-1,0,-1);b("cn2",1,0,-1);b("cn3",0,-1,-1);b("cn4",0,1,-1);this.j.$a=!0}}();b.ul=function(a,e){b.C.call(this);this.da=a;this.da.Fa();this.l=a.l;this.sa=!1;e=e||1;var c=new b.Jh(e,e),d=new b.Kb({W:!0,H:!1});d.color.copy(this.da.color).q(this.da.na);this.wi=new b.U(c,d);this.add(this.wi);
c=new b.B;c.e.push(new b.a);c.e.push(new b.a);d=new b.ab({H:!1});d.color.copy(this.da.color).q(this.da.na);this.Ti=new b.fa(c,d);this.add(this.Ti);this.update()};b.ul.prototype=Object.create(b.C.prototype);b.ul.prototype.update=function(){var a=new b.a,e=new b.a,c=new b.a;return function(){a.Ua(this.da.l);e.Ua(this.da.target.l);c.ea(e,a);this.wi.Fb(c);this.wi.D.color.copy(this.da.color).q(this.da.na);this.Ti.j.e[1].copy(c);this.Ti.j.$a=!0;this.Ti.D.color.copy(this.wi.D.color)}}();b.bp=function(a,
e){function c(a,b){return a-b}var d=void 0!==e?e:16777215,f=[0,0],g={},h=["a","b","c"],k=new b.qb,n=a.j.b();n.Ci();n.vb();for(var l=n.e,n=n.i,p=0,r=0,q=n.length;r<q;r++)for(var v=n[r],u=0;3>u;u++){f[0]=v[h[u]];f[1]=v[h[(u+1)%3]];f.sort(c);var s=f.toString();void 0===g[s]?(g[s]={Ut:f[0],Vt:f[1],mr:r,mk:void 0},p++):g[s].mk=r}k.Wh("position",Float32Array,2*p,3);f=k.attributes.position.c;h=0;for(s in g)if(p=g[s],void 0===p.mk||0.9999>n[p.mr].F.za(n[p.mk].F))r=l[p.Ut],f[h++]=r.x,f[h++]=r.y,f[h++]=r.z,
r=l[p.Vt],f[h++]=r.x,f[h++]=r.y,f[h++]=r.z;b.fa.call(this,k,new b.ab({color:d}),b.Tc);this.sa=!1;this.l=a.l};b.bp.prototype=Object.create(b.fa.prototype);b.wl=function(a,e,c,d){this.object=a;this.size=void 0!==e?e:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;e=new b.B;c=0;for(var f=this.object.j.i.length;c<f;c++)e.e.push(new b.a),e.e.push(new b.a);b.fa.call(this,e,new b.ab({color:a,Eb:d}),b.Tc);this.sa=!1;this.Xe=new b.pc;this.update()};b.wl.prototype=Object.create(b.fa.prototype);b.wl.prototype.update=
function(){var a=new b.a;return function(){this.object.Fa(!0);this.Xe.dd(this.object.l);for(var b=this.j.e,c=this.object.j.i,d=this.object.l,f=0,g=c.length;f<g;f++){var h=c[f];a.copy(h.F).xc(this.Xe).normalize().q(this.size);var k=2*f;b[k].copy(h.jb).O(d);b[k+1].Hc(b[k],a)}this.j.$a=!0;return this}}();b.dp=function(a,e){var c=new b.B,d=new b.ab({u:b.De});this.Oq=new b.p(4473924);this.Pq=new b.p(8947848);for(var f=-a;f<=a;f+=e){c.e.push(new b.a(-a,0,f),new b.a(a,0,f),new b.a(f,0,-a),new b.a(f,0,a));
var g=0===f?this.Oq:this.Pq;c.va.push(g,g,g,g)}b.fa.call(this,c,d,b.Tc)};b.dp.prototype=Object.create(b.fa.prototype);b.Al=function(a,e){b.C.call(this);this.da=a;this.da.Fa();this.l=a.l;this.sa=!1;this.va=[new b.p,new b.p];var c=new b.ug(e,4,2);c.Bd((new b.$).Cn(-Math.PI/2));for(var d=0;8>d;d++)c.i[d].color=this.va[4>d?0:1];d=new b.Kb({u:b.pf,W:!0});this.Bk=new b.U(c,d);this.add(this.Bk);this.update()};b.Al.prototype=Object.create(b.C.prototype);b.Al.prototype.update=function(){var a=new b.a;return function(){this.va[0].copy(this.da.color).q(this.da.na);
this.va[1].copy(this.da.Zg).q(this.da.na);this.Bk.Fb(a.Ua(this.da.l).We());this.Bk.j.ac=!0}}();b.Jl=function(a,e){this.da=a;this.da.Fa();var c=new b.ug(e,4,2),d=new b.Kb({W:!0,H:!1});d.color.copy(this.da.color).q(this.da.na);b.U.call(this,c,d);this.l=this.da.l;this.sa=!1};b.Jl.prototype=Object.create(b.U.prototype);b.Jl.prototype.update=function(){this.D.color.copy(this.da.color).q(this.da.na)};b.Wl=function(a){b.C.call(this);this.da=a;this.da.Fa();this.l=a.l;this.sa=!1;a=new b.mg(0,1,1,8,1,!0);a.Bd((new b.$).Ck(0,
-0.5,0));a.Bd((new b.$).Cn(-Math.PI/2));var e=new b.Kb({W:!0,H:!1});this.$c=new b.U(a,e);this.add(this.$c);this.update()};b.Wl.prototype=Object.create(b.C.prototype);b.Wl.prototype.update=function(){var a=new b.a,e=new b.a;return function(){var b=this.da.cb?this.da.cb:1E4,d=b*Math.tan(this.da.Je);this.$c.scale.set(d,d,b);a.Ua(this.da.l);e.Ua(this.da.target.l);this.$c.Fb(e.sub(a));this.$c.D.color.copy(this.da.color).q(this.da.na)}}();b.bm=function(a,e,c,d){this.object=a;this.size=void 0!==e?e:1;e=
void 0!==c?c:16711680;d=void 0!==d?d:1;c=new b.B;a=a.j.i;for(var f=0,g=a.length;f<g;f++)for(var h=0,k=a[f].V.length;h<k;h++)c.e.push(new b.a),c.e.push(new b.a);b.fa.call(this,c,new b.ab({color:e,Eb:d}),b.Tc);this.sa=!1;this.Xe=new b.pc;this.update()};b.bm.prototype=Object.create(b.fa.prototype);b.bm.prototype.update=function(){var a=new b.a;return function(){var b=["a","b","c","d"];this.object.Fa(!0);this.Xe.dd(this.object.l);for(var c=this.j.e,d=this.object.j.e,f=this.object.j.i,g=this.object.l,
h=0,k=0,n=f.length;k<n;k++)for(var l=f[k],p=0,r=l.V.length;p<r;p++){var q=l.V[p];c[h].copy(d[l[b[p]]]).O(g);a.copy(q).xc(this.Xe).normalize().q(this.size);a.add(c[h]);h+=1;c[h].copy(a);h+=1}this.j.$a=!0;return this}}();b.cm=function(a,e,c,d){this.object=a;this.size=void 0!==e?e:1;e=void 0!==c?c:255;d=void 0!==d?d:1;c=new b.B;a=a.j.i;for(var f=0,g=a.length;f<g;f++)for(var h=0,k=a[f].se.length;h<k;h++)c.e.push(new b.a),c.e.push(new b.a);b.fa.call(this,c,new b.ab({color:e,Eb:d}),b.Tc);this.sa=!1;this.update()};
b.cm.prototype=Object.create(b.fa.prototype);b.cm.prototype.update=function(){var a=new b.a;return function(){var b=["a","b","c","d"];this.object.Fa(!0);for(var c=this.j.e,d=this.object.j.e,f=this.object.j.i,g=this.object.l,h=0,k=0,n=f.length;k<n;k++)for(var l=f[k],p=0,r=l.se.length;p<r;p++){var q=l.se[p];c[h].copy(d[l[b[p]]]).O(g);a.copy(q).Kt(g).q(this.size);a.add(c[h]);h+=1;c[h].copy(a);h+=1}this.j.$a=!0;return this}}();b.Mp=function(a,e){function c(a,b){return a-b}var d=void 0!==e?e:16777215,
f=[0,0],g={},h=["a","b","c"],k=new b.qb;if(a.j instanceof b.B){for(var n=a.j.e,l=a.j.i,p=0,r=new Uint32Array(6*l.length),q=0,v=l.length;q<v;q++)for(var u=l[q],s=0;3>s;s++){f[0]=u[h[s]];f[1]=u[h[(s+1)%3]];f.sort(c);var x=f.toString();void 0===g[x]&&(r[2*p]=f[0],r[2*p+1]=f[1],g[x]=!0,p++)}k.Wh("position",Float32Array,2*p,3);f=k.attributes.position.c;q=0;for(v=p;q<v;q++)for(s=0;2>s;s++)p=n[r[2*q+s]],h=6*q+3*s,f[h+0]=p.x,f[h+1]=p.y,f[h+2]=p.z}else if(a.j instanceof b.qb&&void 0!==a.j.attributes.index){for(var n=
a.j.attributes.position.c,v=a.j.attributes.index.c,l=a.j.Kd,p=0,r=new Uint32Array(2*v.length),u=0,z=l.length;u<z;++u)for(var s=l[u].start,x=l[u].count,h=l[u].index,q=s,t=s+x;q<t;q+=3)for(s=0;3>s;s++)f[0]=h+v[q+s],f[1]=h+v[q+(s+1)%3],f.sort(c),x=f.toString(),void 0===g[x]&&(r[2*p]=f[0],r[2*p+1]=f[1],g[x]=!0,p++);k.Wh("position",Float32Array,2*p,3);f=k.attributes.position.c;q=0;for(v=p;q<v;q++)for(s=0;2>s;s++)h=6*q+3*s,p=3*r[2*q+s],f[h+0]=n[p],f[h+1]=n[p+1],f[h+2]=n[p+2]}else if(a.j instanceof b.qb)for(n=
a.j.attributes.position.c,p=n.length/3,r=p/3,k.Wh("position",Float32Array,2*p,3),f=k.attributes.position.c,q=0,v=r;q<v;q++)for(s=0;3>s;s++)h=18*q+6*s,r=9*q+3*s,f[h+0]=n[r],f[h+1]=n[r+1],f[h+2]=n[r+2],p=9*q+3*((s+1)%3),f[h+3]=n[p],f[h+4]=n[p+1],f[h+5]=n[p+2];b.fa.call(this,k,new b.ab({color:d}),b.Tc);this.sa=!1;this.l=a.l};b.Mp.prototype=Object.create(b.fa.prototype);b.ij=function(){b.C.call(this);this.w=la()};b.ij.prototype=Object.create(b.C.prototype);b.qg=function(a,e,c,d,f){b.C.call(this);this.bh=
[];this.k=new b.a;this.Lm=void 0;void 0!==a&&this.add(a,e,c,d,f)};b.qg.prototype=Object.create(b.C.prototype);b.qg.prototype.add=function(a,e,c,d,f,g){void 0===e&&(e=-1);void 0===c&&(c=0);void 0===g&&(g=1);void 0===f&&(f=new b.p(16777215));void 0===d&&(d=b.Ih);c=Math.min(c,Math.max(0,c));this.bh.push({Gt:a,size:e,cb:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:g,color:f,bb:d})};b.qg.prototype.Qt=function(){var a,b=this.bh.length,c,d=2*-this.k.x,f=2*-this.k.y;for(a=0;a<b;a++)c=this.bh[a],c.x=this.k.x+
d*c.cb,c.y=this.k.y+f*c.cb,c.Xt=0.25*c.x*Math.PI,c.rotation+=0.25*(c.Xt-c.rotation)};b.Gh=function(a,e){b.U.call(this,a,e);this.Cm={};this.Nj=[];var c=this.j.A.length;this.Vq(c-1,c/1);this.$s()};b.Gh.prototype=Object.create(b.U.prototype);b.Gh.prototype.Vq=function(a,b){var c={At:0,wv:a,length:a-0+1,Ug:b,duration:(a-0)/b,Ak:0,Ng:0,jq:!1,time:0,direction:1,lf:1,Nf:!1,Ve:!1};this.Cm.__default=c;this.Nj.push(c)};b.Gh.prototype.$s=function(){var a=this.Cm.__default;a&&(a.lf=1)};b.Gh.prototype.update=
function(a){for(var e=0,c=this.Nj.length;e<c;e++){var d=this.Nj[e];if(d.jq){var f=d.duration/d.length;d.time+=d.direction*a;if(d.Ve){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.Nf=!0),0>d.time&&(d.time=0,d.Nf=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var g=d.At+b.Jb.be(Math.floor(d.time/f),0,d.length-1),h=d.lf;g!==d.Ng&&(this.Kc[d.Ak]=0,this.Kc[d.Ng]=1*h,this.Kc[g]=0,d.Ak=d.Ng,d.Ng=g);f=d.time%f/f;d.Nf&&(f=1-f);this.Kc[d.Ng]=f*h;this.Kc[d.Ak]=
(1-f)*h}}};b.gp=function(){function a(a,b){var c=e.createProgram(),d=e.createShader(e.FRAGMENT_SHADER),f=e.createShader(e.VERTEX_SHADER),g="precision "+b+" float;\n";e.shaderSource(d,g+a.P);e.shaderSource(f,g+a.R);e.compileShader(d);e.compileShader(f);e.attachShader(c,d);e.attachShader(c,f);e.linkProgram(c);return c}var e,c,d,f,g,h,k,n,l,p,r,q,v;this.$g=function(u){e=u.Mg;c=u;d=u.sk();f=new Float32Array(16);g=new Uint16Array(6);u=0;f[u++]=-1;f[u++]=-1;f[u++]=0;f[u++]=0;f[u++]=1;f[u++]=-1;f[u++]=1;
f[u++]=0;f[u++]=1;f[u++]=1;f[u++]=1;f[u++]=1;f[u++]=-1;f[u++]=1;f[u++]=0;f[u++]=1;u=0;g[u++]=0;g[u++]=1;g[u++]=2;g[u++]=0;g[u++]=2;g[u++]=3;h=e.createBuffer();k=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h);e.bufferData(e.ARRAY_BUFFER,f,e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,k);e.bufferData(e.ELEMENT_ARRAY_BUFFER,g,e.STATIC_DRAW);n=e.createTexture();l=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,e.RGB,16,16,0,e.RGB,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_2D,
e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.bindTexture(e.TEXTURE_2D,l);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,16,16,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);
e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);0>=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(p=!1,r=a(b.Vl.lensFlare,d)):(p=!0,r=a(b.Vl.lensFlareVertexTexture,d));q={};v={};q.No=e.getAttribLocation(r,"position");q.ic=e.getAttribLocation(r,"uv");v.Sk=e.getUniformLocation(r,"renderType");v.map=e.getUniformLocation(r,"map");v.zs=e.getUniformLocation(r,"occlusionMap");v.opacity=e.getUniformLocation(r,"opacity");v.color=e.getUniformLocation(r,"color");v.scale=e.getUniformLocation(r,
"scale");v.rotation=e.getUniformLocation(r,"rotation");v.no=e.getUniformLocation(r,"screenPosition")};this.w=function(a,d,f,g){a=a.Ej;var t=a.length;if(t){var w=new b.a,y=g/f,H=0.5*f,N=0.5*g,Q=16/g,C=new b.h(Q*y,Q),M=new b.a(1,1,0),I=new b.h(1,1),D=v,Q=q;e.useProgram(r);e.enableVertexAttribArray(q.No);e.enableVertexAttribArray(q.ic);e.uniform1i(D.zs,0);e.uniform1i(D.map,1);e.bindBuffer(e.ARRAY_BUFFER,h);e.vertexAttribPointer(Q.No,2,e.FLOAT,!1,16,0);e.vertexAttribPointer(Q.ic,2,e.FLOAT,!1,16,8);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,
k);e.disable(e.CULL_FACE);e.depthMask(!1);var K,F,A,J,E;for(K=0;K<t;K++)if(Q=16/g,C.set(Q*y,Q),J=a[K],w.set(J.l.elements[12],J.l.elements[13],J.l.elements[14]),w.O(d.Ta),w.Ke(d.xa),M.copy(w),I.x=M.x*H+H,I.y=M.y*N+N,p||0<I.x&&I.x<f&&0<I.y&&I.y<g)for(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,n),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGB,I.x-8,I.y-8,16,16,0),e.uniform1i(D.Sk,0),e.uniform2f(D.scale,C.x,C.y),e.uniform3f(D.no,M.x,M.y,M.z),e.disable(e.BLEND),e.enable(e.DEPTH_TEST),e.drawElements(e.TRIANGLES,
6,e.UNSIGNED_SHORT,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,l),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,I.x-8,I.y-8,16,16,0),e.uniform1i(D.Sk,1),e.disable(e.DEPTH_TEST),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,n),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),J.k.copy(M),J.Lm?J.Lm(J):J.Qt(),e.uniform1i(D.Sk,2),e.enable(e.BLEND),F=0,A=J.bh.length;F<A;F++)E=J.bh[F],0.0010<E.opacity&&0.0010<E.scale&&(M.x=E.x,M.y=E.y,M.z=E.z,Q=E.size*E.scale/g,C.x=Q*y,C.y=Q,e.uniform3f(D.no,
M.x,M.y,M.z),e.uniform2f(D.scale,C.x,C.y),e.uniform1f(D.rotation,E.rotation),e.uniform1f(D.opacity,E.opacity),e.uniform3f(D.color,E.color.s,E.color.r,E.color.g),c.fg(E.bb,E.blendEquation,E.Oe,E.Ne),c.hg(E.Gt,1),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0));e.enable(e.CULL_FACE);e.enable(e.DEPTH_TEST);e.depthMask(!0)}}};b.uj=function(){var a,e,c,d,f,g,h=new b.xe,k=new b.$,n=new b.a,l=new b.a,p=new b.a;this.$g=function(h){a=h.Mg;e=h;h=b.tg.depthRGBA;var k=b.uc.b(h.Q);c=new b.Wa({P:h.P,R:h.R,Q:k});
d=new b.Wa({P:h.P,R:h.R,Q:k,A:!0});f=new b.Wa({P:h.P,R:h.R,Q:k,Ea:!0});g=new b.Wa({P:h.P,R:h.R,Q:k,A:!0,Ea:!0});c.Xd=!0;d.Xd=!0;f.Xd=!0;g.Xd=!0};this.w=function(a,b){e.ff&&e.qt&&this.update(a,b)};this.update=function(r,q){var v,u,s,x,z,t,w,y,H,N=[];x=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);e.to===b.dj?a.cullFace(a.FRONT):a.cullFace(a.BACK);e.cf(!0);v=0;for(u=r.Ub.length;v<u;v++)if(s=r.Ub[v],s.tb)if(s instanceof b.zb&&s.bl)for(z=0;z<s.mt;z++){var Q;if(s.df[z])Q=
s.df[z];else{H=s;w=z;Q=new b.zb;Q.Tr=!0;Q.me=!0;Q.tb=!0;Q.qh=H.qh;Q.ph=H.ph;Q.Zk=H.Zk;Q.$k=H.$k;Q.Yk=H.Yk;Q.al=H.al;Q.oe=H.oe;Q.ef=H.ef;Q.oh=H.qo[w];Q.th=H.pt[w];Q.rh=H.nt[w];Q.Xn=[];Q.Jk=[];y=Q.Xn;t=Q.Jk;for(var C=0;8>C;C++)y[C]=new b.a,t[C]=new b.a;y=H.so[w];H=H.ro[w];t[0].set(-1,-1,y);t[1].set(1,-1,y);t[2].set(-1,1,y);t[3].set(1,1,y);t[4].set(-1,-1,H);t[5].set(1,-1,H);t[6].set(-1,1,H);t[7].set(1,1,H);Q.Gs=q;t=new b.rd;t.position=s.ot;t.add(Q);t.add(Q.target);q.add(t);s.df[z]=Q;console.log("Created virtualLight",
Q)}w=s;y=z;H=w.df[y];H.position.copy(w.position);H.target.position.copy(w.target.position);H.Fb(H.target);H.oe=w.oe;H.ef=w.ef;H.oh=w.qo[y];t=w.so[y];w=w.ro[y];H=H.Jk;H[0].z=t;H[1].z=t;H[2].z=t;H[3].z=t;H[4].z=w;H[5].z=w;H[6].z=w;H[7].z=w;N[x]=Q;x++}else N[x]=s,x++;v=0;for(u=N.length;v<u;v++){s=N[v];s.ig||(z=b.ye,e.sh===b.Il&&(z=b.wf),s.ig=new b.Ee(s.th,s.rh,{mb:z,Gb:z,ba:b.Td}),s.Qi=new b.h(s.th,s.rh),s.jg=new b.$);if(!s.Md){if(s instanceof b.Wc)s.Md=new b.Lb(s.lt,s.th/s.rh,s.qh,s.ph);else if(s instanceof
b.zb)s.Md=new b.Rd(s.Zk,s.$k,s.al,s.Yk,s.qh,s.ph);else{console.error("Unsupported light type for shadow");continue}r.add(s.Md);!0===r.Gf&&r.Fa()}s.oe&&!s.Hg&&(s.Hg=new b.cj(s.Md),s.Md.add(s.Hg));if(s.Tr&&Q.Gs==q){z=q;x=s.Md;t=s.Jk;H=s.Xn;n.set(Infinity,Infinity,Infinity);l.set(-Infinity,-Infinity,-Infinity);for(w=0;8>w;w++)y=H[w],y.copy(t[w]),b.uj.Sp.Ko(y,z),y.O(x.Ta),y.x<n.x&&(n.x=y.x),y.x>l.x&&(l.x=y.x),y.y<n.y&&(n.y=y.y),y.y>l.y&&(l.y=y.y),y.z<n.z&&(n.z=y.z),y.z>l.z&&(l.z=y.z);x.left=n.x;x.right=
l.x;x.top=l.y;x.bottom=n.y;x.hf()}x=s.ig;t=s.jg;z=s.Md;z.position.Ua(s.l);p.Ua(s.target.l);z.Fb(p);z.Fa();z.Ta.Fd(z.l);s.Hg&&(s.Hg.visible=s.oe);s.oe&&s.Hg.update();t.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);t.multiply(z.xa);t.multiply(z.Ta);k.La(z.xa,z.Ta);h.Ki(k);e.Xk(x);e.clear();H=r.Vb;s=0;for(x=H.length;s<x;s++)w=H[s],t=w.object,w.w=!1,!t.visible||!t.tb||(t instanceof b.U||t instanceof b.Sb)&&t.Re&&!h.ti(t)||(t.wc.La(z.Ta,t.l),w.w=!0);s=0;for(x=H.length;s<x;s++)w=H[s],w.w&&(t=w.object,
w=w.buffer,C=t.D instanceof b.qc?t.D.Z[0]:t.D,y=0<t.j.A.length&&C.A,C=t instanceof b.sc&&C.Ea,y=t.fi?t.fi:C?y?g:f:y?d:c,w instanceof b.qb?e.Pk(z,r.Ub,null,y,w,t):e.Ok(z,r.Ub,null,y,w,t));H=r.Ud;s=0;for(x=H.length;s<x;s++)w=H[s],t=w.object,t.visible&&t.tb&&(t.wc.La(z.Ta,t.l),e.Qk(z,r.Ub,null,c,t))}v=e.an();a.clearColor(v.s,v.r,v.g,0);a.enable(a.BLEND);e.to===b.dj&&a.cullFace(a.BACK)}};b.uj.Sp=new b.sj;b.Ap=function(){var a,e,c,d,f,g,h,k,n,l,p,r,q,v,u,s,x;function z(a,b){return a.z!==b.z?b.z-a.z:b.id-
a.id}var t,w,y,H,N,Q,C,M;this.$g=function(z){t=z.Mg;w=z;H=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]);N=new Uint16Array([0,1,2,0,2,3]);Q=t.createBuffer();C=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,Q);t.bufferData(t.ARRAY_BUFFER,H,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,C);t.bufferData(t.ELEMENT_ARRAY_BUFFER,N,t.STATIC_DRAW);z=t.createProgram();var D=t.createShader(t.VERTEX_SHADER),K=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(D,["precision "+w.sk()+
" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
t.shaderSource(K,["precision "+w.sk()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
t.compileShader(D);t.compileShader(K);t.attachShader(z,D);t.attachShader(z,K);t.linkProgram(z);M=z;s=t.getAttribLocation(M,"position");x=t.getAttribLocation(M,"uv");a=t.getUniformLocation(M,"uvOffset");e=t.getUniformLocation(M,"uvScale");c=t.getUniformLocation(M,"rotation");d=t.getUniformLocation(M,"scale");f=t.getUniformLocation(M,"color");g=t.getUniformLocation(M,"map");h=t.getUniformLocation(M,"opacity");k=t.getUniformLocation(M,"modelViewMatrix");n=t.getUniformLocation(M,"projectionMatrix");l=
t.getUniformLocation(M,"fogType");p=t.getUniformLocation(M,"fogDensity");r=t.getUniformLocation(M,"fogNear");q=t.getUniformLocation(M,"fogFar");v=t.getUniformLocation(M,"fogColor");u=t.getUniformLocation(M,"alphaTest");z=document.createElement("canvas");z.width=8;z.height=8;D=z.getContext("2d");D.fillStyle="#ffffff";D.fillRect(0,0,z.width,z.height);y=new b.rb(z);y.ga=!0};this.w=function(H,D){var K=H.Hj,F=K.length;if(F){t.useProgram(M);t.enableVertexAttribArray(s);t.enableVertexAttribArray(x);t.disable(t.CULL_FACE);
t.enable(t.BLEND);t.bindBuffer(t.ARRAY_BUFFER,Q);t.vertexAttribPointer(s,2,t.FLOAT,!1,16,0);t.vertexAttribPointer(x,2,t.FLOAT,!1,16,8);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,C);t.uniformMatrix4fv(n,!1,D.xa.elements);t.activeTexture(t.TEXTURE0);t.uniform1i(g,0);var A=0,J=0,E=H.H;E?(t.uniform3f(v,E.color.s,E.color.r,E.color.g),E instanceof b.pg?(t.uniform1f(r,E.ta),t.uniform1f(q,E.wa),t.uniform1i(l,1),J=A=1):E instanceof b.qf&&(t.uniform1f(p,E.hi),t.uniform1i(l,2),J=A=2)):(t.uniform1i(l,0),J=A=0);for(var N,
G,S=[],E=0;E<F;E++)N=K[E],!1!==N.visible&&(N.wc.La(D.Ta,N.l),N.z=-N.wc.elements[14]);K.sort(z);for(E=0;E<F;E++)N=K[E],!1!==N.visible&&(G=N.D,t.uniform1f(u,G.Ie),t.uniformMatrix4fv(k,!1,N.wc.elements),S[0]=N.scale.x,S[1]=N.scale.y,N=H.H&&G.H?J:0,A!==N&&(t.uniform1i(l,N),A=N),null!==G.map?(t.uniform2f(a,G.map.offset.x,G.map.offset.y),t.uniform2f(e,G.map.repeat.x,G.map.repeat.y)):(t.uniform2f(a,0,0),t.uniform2f(e,1,1)),t.uniform1f(h,G.opacity),t.uniform3f(f,G.color.s,G.color.r,G.color.g),t.uniform1f(c,
G.rotation),t.uniform2fv(d,S),w.fg(G.bb,G.blendEquation,G.Oe,G.Ne),w.cf(G.Cd),w.nh(G.Dd),G.map&&G.map.M&&G.map.M.width?w.hg(G.map,0):w.hg(y,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0));t.enable(t.CULL_FACE)}}};b.lu=function(){this.enabled=!1;this.jo=null;var a,e,c,d,f,g,h=new b.xe,k=new b.$;this.$g=function(h){a=h.Mg;e=h;h=b.tg.depthRGBA;var k=b.uc.b(h.Q);c=new b.Wa({P:h.P,R:h.R,Q:k});d=new b.Wa({P:h.P,R:h.R,Q:k,A:!0});f=new b.Wa({P:h.P,R:h.R,Q:k,Ea:!0});g=new b.Wa({P:h.P,R:h.R,Q:k,A:!0,Ea:!0});
c.Xd=!0;d.Xd=!0;f.Xd=!0;g.Xd=!0};this.w=function(a,b){this.enabled&&this.update(a,b)};this.update=function(n,l){var p,r,q,v,u,s;a.clearColor(1,1,1,1);a.disable(a.BLEND);e.cf(!0);!0===n.Gf&&n.Fa();l.Ta.Fd(l.l);k.La(l.xa,l.Ta);h.Ki(k);e.Xk(this.jo);e.clear();s=n.Vb;p=0;for(r=s.length;p<r;p++)q=s[p],u=q.object,q.w=!1,!u.visible||(u instanceof b.U||u instanceof b.Sb)&&u.Re&&!h.ti(u)||(u.wc.La(l.Ta,u.l),q.w=!0);var x;p=0;for(r=s.length;p<r;p++)q=s[p],q.w&&(u=q.object,q=q.buffer,u instanceof b.Sb&&!u.fi||
((x=u.D instanceof b.qc?u.D.Z[0]:u.D)&&e.Wk(u.D),v=0<u.j.A.length&&x.A,x=u instanceof b.sc&&x.Ea,v=u.fi?u.fi:x?v?g:f:v?d:c,q instanceof b.qb?e.Pk(l,n.Ub,null,v,q,u):e.Ok(l,n.Ub,null,v,q,u)));s=n.Ud;p=0;for(r=s.length;p<r;p++)q=s[p],u=q.object,u.visible&&(u.wc.La(l.Ta,u.l),e.Qk(l,n.Ub,null,c,u));p=e.an();a.clearColor(p.s,p.r,p.g,0);a.enable(a.BLEND)}};b.Vl={lensFlareVertexTexture:{R:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
P:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},lensFlare:{R:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
P:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
S["default"]=b});
define("game","./util ./actor ./world ./world_renderer ./network/network_client ./network/network_server ./vendor/three".split(" "),function(S,b,a,e,c,d){function f(){}var g=S.fk,h=S.bf,k=b["default"],n=a["default"],l=e["default"],p=c["default"],r=d["default"],q=["getEntity","trigger","add","remove","createEntity"];g(la(),{Jc:function(a){var b=new n;this.Qj="undefined"!==typeof global?new v(b,a):new u(b,a);h.call(this,q,this.Qj);h.call(this,["onEntity","onWorld"],this.Qj)},start:function(){this.Qj.start()}});var v=
g(la(),{Jc:function(a){this.la=a;h.call(this,q,this.la);this.us=new r(this.la);this.kt()},Cs:f,Tn:f,kt:function(){var a=require("express"),b=require("http"),c=a(),b=b.iv(c),d=require("socket.io").Xr(b);c.ev(function(){c.Ly(a.ty(__dirname+"/public"))});b.Xr(7777);d.enable("browser client minification");d.enable("browser client etag");d.enable("browser client gzip");d.set("log level",2);d.jy.Hb("connection",function(a){network.nq(a);network.ao(a.id);var b=new Player({id:a.id,position:[0,0,0],Py:[0,
0,0],rotation:0});a.li("welcome",{id:a.id});a.Hb("ready",function(){network.ao(a.id);world.add(b)});a.Hb("playerInput",function(a){b.Ia("playerInput",a)});a.Hb("disconnect",function(){network.Vs(a);var b=world.qi(Player,a.id);b&&world.remove(b)})})},start:function(){this.dl()},dl:function(){var a=(new Date).getTime(),b=a,c=0,d=this;setInterval(function(){a=b;b=(new Date).getTime();c=0.0010*(b-a);d.la.Ht(c);d.us.kg(c)},32)}}),u=g(la(),{Jc:function(a,b){this.la=a;this.ne=b;h.call(this,q,this.la);this.jt()},
start:function(){window.yo=io.fv();socket.Hb("welcome",function(a){world.set("currentPlayerId",a.id);new p(world,socket,k.Gm);world.dk(Camera,{id:"singleton",position:[8192,400,8192],target:[0,0,0],xx:a.id});socket.li("ready")});this.dl()},dl:la(),jt:function(){this.Tk=new l(this.la);h.call(this,["onEntity","onWorld"],this.Tk);this.Tk.Tn(ThreeJSCoreRenderer);var a=this;window.addEventListener("resize",function(){a.Tk.Uk()},!1)}})});
define("behavior",["./util","exports"],function(S,b){function a(a){this.bc=a;this.Sg=!0;c.call(this,"on off trigger getWorld get set getRawState createEntity".split(" "),this.bc)}var e=S.gk,c=S.bf;a.prototype.enable=function(){this.Sg=!0;this.Jc()};a.prototype.disable=function(){this.Sg=!1;this.Mf()};a.prototype.Mf=la();a.Mm=function(b){var c=b.Jc||la(),g=b.lk||{};delete b.lk;b=e(a,c,b);b.Bv=g;return b};b["default"]=a});
define("renderer",["./util","exports"],function(S,b){function a(a){this.bc=a;c.call(this,["get","getWorld"],this.bc)}var e=S.gk,c=S.bf;a.prototype.w=la();a.prototype.Uk=la();a.prototype.Mf=la();a.Mm=function(b){return e(a,b.Jc||la(),b)};b["default"]=a});
define("index","./game ./entity ./behavior ./renderer ./util ./vendor/three exports".split(" "),function(S,b,a,e,c,d,f){b=b["default"];a=a["default"];e=e["default"];var g=c.rn,h=c.qn,k=c.Am,n=c.Un,l=c.co;c=c.$n;d=d["default"];f.qu=S["default"];f.mu=b;f.du=a;f.zu=e;f.rn=g;f.qn=h;f.Am=k;f.Un=n;f.co=l;f.$n=c;f.Fu=d});
